define("ctrl_enter","init",function(){function i(e){e.parents("form").find('#cfms:visible, #mainSubmitForm:visible, [name*="cfms"]:visible, .js-form_submit').each(function(){var e=$(this);if(!e.attr("disabled"))return e.click(),!1})}$(document).on("keypress","input",function(e){"text"!=this.type||13!=e.keyCode&&10!=e.keyCode||e.isDefaultPrevented()||(e.preventDefault(),i($(this)))}).on("keypress",".form_submit",function(e){var t,s;13!=e.keyCode&&10!=e.keyCode||!(!e.ctrlKey&&"ENTER"==Spaces.params.form_submit_key||e.ctrlKey&&"CTRL_ENTER"==Spaces.params.form_submit_key)||(e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation(),(t=$(this)).trigger("hotkey_form_submit"),i(t)),!e.ctrlKey||"ENTER"!=Spaces.params.form_submit_key||13!=e.keyCode&&10!=e.keyCode||(s=get_caret_pos(this),document.selection?(this.focus(),document.selection.createRange().text="\r\n"):this.selectionStart!==undefined?this.value=this.value.substr(0,this.selectionStart)+"\r\n"+this.value.substr(this.selectionStart+(this.selectionEnd-this.selectionStart)):this.value+="\r\n",set_caret_pos(this,s+1,s+1))})});
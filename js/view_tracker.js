define("view_tracker","init",function(){function e(){clearTimeout(r),clearTimeout(t),a=0,i=!1,t=r=c=null,window.removeEventListener?window.removeEventListener("scroll",n,!1):d.off(".view_tracker")}function n(){if(c.length){var e=window.pageYOffset||(document.documentElement||document.body||{}).scrollTop,n=Math.max(window.innerHeight,(document.documentElement||{}).clientHeight||0);a=Math.max(a,e+n),r||(r=setTimeout(o,1500))}}function o(){var e,n,o,t=[],i=$(document).height();for(r=!1,e=[],n=0;n<c.length;++n)(o=c[n]).scroll<=a/i?(o.tracked=!0,e.push(o.id)):t.push(o);e.length&&Spaces.api("neoapi/diary.addTopicView",{CK:null,Visit:o.lenta?1:0,IdS:e},function(e){0!=e.code&&console.error("addTopicView: "+Spaces.apiError(e))},{onError:function(e){console.error("addTopicView: "+e)}}),c=t}var t,r,c,a=0,i=!1,d=$(window);define("view_tracker","onRequire",function(){t||(t=tick(function(){t=!1,c=[],$(".js-view_tracker").each(function(){var e=$(this),n=e.data();n.tracked||(n.scroll=(e.offset().top+e.height()+10)/$(document).height(),c.push(n))}),i||(window.addEventListener?window.addEventListener("scroll",n,!1):d.on("scroll.view_tracker",n),page_loader.on("shutdown","view_tracker",e),n(),i=!0)}))})});
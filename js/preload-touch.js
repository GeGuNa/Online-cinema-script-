!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(C,e){function s(e){var t=!!e&&"length"in e&&e.length,n=dn.type(e);return"function"!==n&&!dn.isWindow(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}function t(e,n,r){if(dn.isFunction(n))return dn.grep(e,function(e,t){return!!n.call(e,t,e)!==r});if(n.nodeType)return dn.grep(e,function(e){return e===n!==r});if("string"==typeof n){if(ee.test(n))return dn.filter(n,e,r);n=dn.filter(n,e)}return dn.grep(e,function(e){return-1<dn.inArray(e,n)!==r})}function n(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function i(){tn.addEventListener?(tn.removeEventListener("DOMContentLoaded",o),C.removeEventListener("load",o)):(tn.detachEvent("onreadystatechange",o),C.detachEvent("onload",o))}function o(){(tn.addEventListener||"load"===C.event.type||"complete"===tn.readyState)&&(i(),dn.ready())}function u(e,t,n){if(n===undefined&&1===e.nodeType){var r="data-"+t.replace(ce,"-$1").toLowerCase();if("string"==typeof(n=e.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:le.test(n)?dn.parseJSON(n):n)}catch(i){}dn.data(e,t,n)}else n=undefined}return n}function l(e){var t;for(t in e)if(("data"!==t||!dn.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function r(e,t,n,r){if(ue(e)){var i,o,a=dn.expando,s=e.nodeType,u=s?dn.cache:e,l=s?e[a]:e[a]&&a;if(l&&u[l]&&(r||u[l].data)||n!==undefined||"string"!=typeof t)return l||(l=s?e[a]=en.pop()||dn.guid++:a),u[l]||(u[l]=s?{}:{toJSON:dn.noop}),"object"!=typeof t&&"function"!=typeof t||(r?u[l]=dn.extend(u[l],t):u[l].data=dn.extend(u[l].data,t)),o=u[l],r||(o.data||(o.data={}),o=o.data),n!==undefined&&(o[dn.camelCase(t)]=n),"string"==typeof t?null==(i=o[t])&&(i=o[dn.camelCase(t)]):i=o,i}}function a(e,t,n){if(ue(e)){var r,i,o=e.nodeType,a=o?dn.cache:e,s=o?e[dn.expando]:dn.expando;if(a[s]){if(t&&(r=n?a[s]:a[s].data)){i=(t=dn.isArray(t)?t.concat(dn.map(t,dn.camelCase)):t in r?[t]:(t=dn.camelCase(t))in r?[t]:t.split(" ")).length;for(;i--;)delete r[t[i]];if(n?!l(r):!dn.isEmptyObject(r))return}(n||(delete a[s].data,l(a[s])))&&(o?dn.cleanData([e],!0):cn.deleteExpando||a!=a.window?delete a[s]:a[s]=undefined)}}}function c(e,t,n,r){var i,o=1,a=20,s=r?function(){return r.cur()}:function(){return dn.css(e,t,"")},u=s(),l=n&&n[3]||(dn.cssNumber[t]?"":"px"),c=(dn.cssNumber[t]||"px"!==l&&+u)&&de.exec(dn.css(e,t));if(c&&c[3]!==l)for(l=l||c[3],n=n||[],c=+u||1;c/=o=o||".5",dn.style(e,t,c+l),o!==(o=s()/u)&&1!==o&&--a;);return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}function m(e){var t=be.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function y(e,t){var n,r,i=0,o="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):undefined;if(!o)for(o=[],n=e.childNodes||e;null!=(r=n[i]);i++)!t||dn.nodeName(r,t)?o.push(r):dn.merge(o,y(r,t));return t===undefined||t&&dn.nodeName(e,t)?dn.merge([e],o):o}function v(e,t){for(var n,r=0;null!=(n=e[r]);r++)dn._data(n,"globalEval",!t||dn._data(t[r],"globalEval"))}function x(e){me.test(e.type)&&(e.defaultChecked=e.checked)}function g(e,t,n,r,i){for(var o,a,s,u,l,c,f,d=e.length,p=m(t),h=[],g=0;g<d;g++)if((a=e[g])||0===a)if("object"===dn.type(a))dn.merge(h,a.nodeType?[a]:a);else if(Te.test(a)){for(u=u||p.appendChild(t.createElement("div")),l=(ye.exec(a)||["",""])[1].toLowerCase(),f=we[l]||we._default,u.innerHTML=f[1]+dn.htmlPrefilter(a)+f[2],o=f[0];o--;)u=u.lastChild;if(!cn.leadingWhitespace&&xe.test(a)&&h.push(t.createTextNode(xe.exec(a)[0])),!cn.tbody)for(o=(a="table"!==l||Ce.test(a)?"<table>"!==f[1]||Ce.test(a)?0:u:u.firstChild)&&a.childNodes.length;o--;)dn.nodeName(c=a.childNodes[o],"tbody")&&!c.childNodes.length&&a.removeChild(c);for(dn.merge(h,u.childNodes),u.textContent="";u.firstChild;)u.removeChild(u.firstChild);u=p.lastChild}else h.push(t.createTextNode(a));for(u&&p.removeChild(u),cn.appendChecked||dn.grep(y(h,"input"),x),g=0;a=h[g++];)if(r&&-1<dn.inArray(a,r))i&&i.push(a);else if(s=dn.contains(a.ownerDocument,a),u=y(p.appendChild(a),"script"),s&&v(u),n)for(o=0;a=u[o++];)ve.test(a.type||"")&&n.push(a);return u=null,p}function f(){return!0}function d(){return!1}function p(){try{return tn.activeElement}catch(e){}}function h(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=undefined),t)h(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=undefined):null==i&&("string"==typeof n?(i=r,r=undefined):(i=r,r=n,n=undefined)),!1===i)i=d;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return dn().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=dn.guid++)),e.each(function(){dn.event.add(this,t,i,r,n)})}function b(e,t){return dn.nodeName(e,"table")&&dn.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function w(e){return e.type=(null!==dn.find.attr(e,"type"))+"/"+e.type,e}function T(e){var t=_e.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function E(e,t){if(1===t.nodeType&&dn.hasData(e)){var n,r,i,o=dn._data(e),a=dn._data(t,o),s=o.events;if(s)for(n in delete a.handle,a.events={},s)for(r=0,i=s[n].length;r<i;r++)dn.event.add(t,n,s[n][r]);a.data&&(a.data=dn.extend({},a.data))}}function N(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!cn.noCloneEvent&&t[dn.expando]){for(r in(i=dn._data(t)).events)dn.removeEvent(t,r,i.handle);t.removeAttribute(dn.expando)}"script"===n&&t.text!==e.text?(w(t).text=e.text,T(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),cn.html5Clone&&e.innerHTML&&!dn.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&me.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}}function k(n,r,i,o){r=rn.apply([],r);var e,t,a,s,u,l,c=0,f=n.length,d=f-1,p=r[0],h=dn.isFunction(p);if(h||1<f&&"string"==typeof p&&!cn.checkClone&&qe.test(p))return n.each(function(e){var t=n.eq(e);h&&(r[0]=p.call(this,e,t.html())),k(t,r,i,o)});if(f&&(e=(l=g(r,n[0].ownerDocument,!1,n,o)).firstChild,1===l.childNodes.length&&(l=e),e||o)){for(a=(s=dn.map(y(l,"script"),w)).length;c<f;c++)t=l,c!==d&&(t=dn.clone(t,!0,!0),a&&dn.merge(s,y(t,"script"))),i.call(n[c],t,c);if(a)for(u=s[s.length-1].ownerDocument,dn.map(s,T),c=0;c<a;c++)t=s[c],ve.test(t.type||"")&&!dn._data(t,"globalEval")&&dn.contains(u,t)&&(t.src?dn._evalUrl&&dn._evalUrl(t.src):dn.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Fe,"")));l=e=null}return n}function S(e,t,n){for(var r,i=t?dn.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||dn.cleanData(y(r)),r.parentNode&&(n&&dn.contains(r.ownerDocument,r)&&v(y(r,"script")),r.parentNode.removeChild(r));return e}function A(e,t){var n=dn(t.createElement(e)).appendTo(t.body),r=dn.css(n[0],"display");return n.detach(),r}function D(e){var t=tn,n=Pe[e];return n||("none"!==(n=A(e,t))&&n||((t=((Re=(Re||dn("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentWindow||Re[0].contentDocument).document).write(),t.close(),n=A(e,t),Re.detach()),Pe[e]=n),n}function j(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}function L(e){if(e in et)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),n=Ze.length;n--;)if((e=Ze[n]+t)in et)return e}function H(e,t){for(var n,r,i,o=[],a=0,s=e.length;a<s;a++)(r=e[a]).style&&(o[a]=dn._data(r,"olddisplay"),n=r.style.display,t?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&he(r)&&(o[a]=dn._data(r,"olddisplay",D(r.nodeName)))):(i=he(r),(n&&"none"!==n||!i)&&dn._data(r,"olddisplay",i?n:dn.css(r,"display"))));for(a=0;a<s;a++)(r=e[a]).style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"));return e}function q(e,t,n){var r=Ge.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function _(e,t,n,r,i){for(var o=n===(r?"border":"content")?4:"width"===t?1:0,a=0;o<4;o+=2)"margin"===n&&(a+=dn.css(e,n+pe[o],!0,i)),r?("content"===n&&(a-=dn.css(e,"padding"+pe[o],!0,i)),"margin"!==n&&(a-=dn.css(e,"border"+pe[o]+"Width",!0,i))):(a+=dn.css(e,"padding"+pe[o],!0,i),"padding"!==n&&(a+=dn.css(e,"border"+pe[o]+"Width",!0,i)));return a}function F(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=ze(e),a=cn.boxSizing&&"border-box"===dn.css(e,"boxSizing",!1,o);if(i<=0||null==i){if(((i=Xe(e,t,o))<0||null==i)&&(i=e.style[t]),We.test(i))return i;r=a&&(cn.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+_(e,t,n||(a?"border":"content"),r,o)+"px"}function M(e,t,n,r,i){return new M.prototype.init(e,t,n,r,i)}function O(){return C.setTimeout(function(){tt=undefined}),tt=dn.now()}function R(e,t){var n,r={height:e},i=0;for(t=t?1:0;i<4;i+=2-t)r["margin"+(n=pe[i])]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function P(e,t,n){for(var r,i=(B.tweeners[t]||[]).concat(B.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function B(o,e,t){var n,a,r=0,i=B.prefilters.length,s=dn.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=tt||O(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:dn.extend({},e),opts:dn.extend(!0,{specialEasing:{},easing:dn.easing._default},t),originalProperties:e,originalOptions:t,startTime:tt||O(),duration:t.duration,tweens:[],createTween:function(e,t){var n=dn.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=dn.camelCase(n)],o=e[n],dn.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=dn.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=B.prefilters[r].call(l,o,c,l.opts))return dn.isFunction(n.stop)&&(dn._queueHooks(l.elem,l.opts.queue).stop=dn.proxy(n.stop,n)),n;return dn.map(c,P,l),dn.isFunction(l.opts.start)&&l.opts.start.call(o,l),dn.fx.timer(dn.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function W(e){return dn.attr(e,"class")||""}function I(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(oe)||[];if(dn.isFunction(t))for(;n=i[r++];)"+"===n.charAt(0)?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function $(t,i,o,a){function s(e){var r;return u[e]=!0,dn.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||l||u[n]?l?!(r=n):void 0:(i.dataTypes.unshift(n),s(n),!1)}),r}var u={},l=t===At;return s(i.dataTypes[0])||!u["*"]&&s("*")}function z(e,t){var n,r,i=dn.ajaxSettings.flatOptions||{};for(r in t)t[r]!==undefined&&((i[r]?e:n||(n={}))[r]=t[r]);return n&&dn.extend(!0,e,n),e}function X(n,e,r,i){var t;if(dn.isArray(e))dn.each(e,function(e,t){r||qt.test(n)?i(n,t):X(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==dn.type(e))i(n,e);else for(t in e)X(n+"["+t+"]",e[t],r,i)}function U(){try{return new C.XMLHttpRequest}catch(e){}}function V(){try{return new C.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function Y(e){return dn.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}var J,G,Q,K,Z,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,fe,de,pe,he,ge,me,ye,ve,xe,be,we,Te,Ce,Ee,Ne,ke,Se,Ae,De,je,Le,He,qe,_e,Fe,Me,Oe,Re,Pe,Be,We,Ie,$e,ze,Xe,Ue,Ve,Ye,Je,Ge,Qe,Ke,Ze,et,tt,nt,rt,it,ot,at,st,ut,lt,ct,ft,dt,pt,ht,gt,mt,yt,vt,xt,bt,wt,Tt,Ct,Et,Nt,kt,St,At,Dt,jt,Lt,Ht,qt,_t,Ft,Mt,Ot,Rt,Pt,Bt,Wt,It,$t,zt,Xt,Ut,Vt,Yt,Jt,Gt,Qt,Kt,Zt,en=[],tn=C.document,nn=en.slice,rn=en.concat,on=en.push,an=en.indexOf,sn={},un=sn.toString,ln=sn.hasOwnProperty,cn={},fn="5.0.0",dn=function(e,t){return new dn.fn.init(e,t)},pn=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,hn=/^-ms-/,gn=/-([\da-z])/gi,mn=function(e,t){return t.toUpperCase()};for(se in dn.fn=dn.prototype={jquery:fn,constructor:dn,selector:"",length:0,toArray:function(){return nn.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:nn.call(this)},pushStack:function(e){var t=dn.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return dn.each(this,e)},map:function(n){return this.pushStack(dn.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(nn.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:on,sort:en.sort,splice:en.splice},dn.extend=dn.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||dn.isFunction(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(i=arguments[s]))for(r in i)e=a[r],a!==(n=i[r])&&(l&&n&&(dn.isPlainObject(n)||(t=dn.isArray(n)))?(t?(t=!1,o=e&&dn.isArray(e)?e:[]):o=e&&dn.isPlainObject(e)?e:{},a[r]=dn.extend(l,o,n)):n!==undefined&&(a[r]=n));return a},dn.extend({expando:"jQuery"+(fn+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw Error(e)},noop:function(){},isFunction:function(e){return"function"===dn.type(e)},isArray:Array.isArray||function(e){return"array"===dn.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){var t=e&&e.toString();return!dn.isArray(e)&&0<=t-parseFloat(t)+1},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==dn.type(e)||e.nodeType||dn.isWindow(e))return!1;try{if(e.constructor&&!ln.call(e,"constructor")&&!ln.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(!cn.ownFirst)for(t in e)return ln.call(e,t);for(t in e);return t===undefined||ln.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?sn[un.call(e)]||"object":typeof e},globalEval:function(e){e&&dn.trim(e)&&(C.execScript||function(e){C.eval.call(C,e)})(e)},camelCase:function(e){return e.replace(hn,"ms-").replace(gn,mn)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var n,r=0;if(s(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":(e+"").replace(pn,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(s(Object(e))?dn.merge(n,"string"==typeof e?[e]:e):on.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(an)return an.call(t,e,n);for(r=t.length,n=n?n<0?Math.max(0,r+n):n:0;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;)e[i++]=t[r++];if(n!=n)for(;t[r]!==undefined;)e[i++]=t[r++];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(s(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return rn.apply([],a)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(i=e[t],t=e,e=i),dn.isFunction(e)?(n=nn.call(arguments,2),(r=function(){return e.apply(t||this,n.concat(nn.call(arguments)))}).guid=e.guid=e.guid||dn.guid++,r):undefined},now:function(){return+new Date},support:cn}),"function"==typeof Symbol&&(dn.fn[Symbol.iterator]=en[Symbol.iterator]),dn.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){sn["[object "+t+"]"]=t.toLowerCase()}),J=function(n){function b(e,t,n,r){var i,o,a,s,u,l,c,f,d=t&&t.ownerDocument,p=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==p&&9!==p&&11!==p)return n;if(!r&&((t?t.ownerDocument||t:R)!==j&&D(t),t=t||j,H)){if(11!==p&&(l=he.exec(e)))if(i=l[1]){if(9===p){if(!(a=t.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(d&&(a=d.getElementById(i))&&M(t,a)&&a.id===i)return n.push(a),n}else{if(l[2])return J.apply(n,t.getElementsByTagName(e)),n;if((i=l[3])&&y.getElementsByClassName&&t.getElementsByClassName)return J.apply(n,t.getElementsByClassName(i)),n}if(y.qsa&&!$[e+" "]&&(!q||!q.test(e))){if(1!==p)d=t,f=e;else if("object"!==t.nodeName.toLowerCase()){for((s=t.getAttribute("id"))?s=s.replace(me,"\\$&"):t.setAttribute("id",s=O),o=(c=C(e)).length,u=le.test(s)?"#"+s:"[id='"+s+"']";o--;)c[o]=u+" "+m(c[o]);f=c.join(","),d=ge.test(e)&&g(t.parentNode)||t}if(f)try{return J.apply(n,d.querySelectorAll(f)),n}catch(h){}finally{s===O&&t.removeAttribute("id")}}}return N(e.replace(ie,"$1"),t,n,r)}function e(){var r=[];return function e(t,n){return r.push(t+" ")>T.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function u(e){return e[O]=!0,e}function i(e){var t=j.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function t(e,t){for(var n=e.split("|"),r=n.length;r--;)T.attrHandle[n[r]]=t}function l(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function r(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function o(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function a(a){return u(function(o){return o=+o,u(function(e,t){for(var n,r=a([],e.length,o),i=r.length;i--;)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function g(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function s(){}function m(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function f(s,e,t){var u=e.dir,l=t&&"parentNode"===u,c=B++;return e.first?function(e,t,n){for(;e=e[u];)if(1===e.nodeType||l)return s(e,t,n)}:function(e,t,n){var r,i,o,a=[P,c];if(n){for(;e=e[u];)if((1===e.nodeType||l)&&s(e,t,n))return!0}else for(;e=e[u];)if(1===e.nodeType||l){if((r=(i=(o=e[O]||(e[O]={}))[e.uniqueID]||(o[e.uniqueID]={}))[u])&&r[0]===P&&r[1]===c)return a[2]=r[2];if((i[u]=a)[2]=s(e,t,n))return!0}}}function d(i){return 1<i.length?function(e,t,n){for(var r=i.length;r--;)if(!i[r](e,t,n))return!1;return!0}:i[0]}function w(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function v(p,h,g,m,y,e){return m&&!m[O]&&(m=v(m)),y&&!y[O]&&(y=v(y,e)),u(function(e,t,n,r){var i,o,a,s=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)b(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!p||!e&&h?c:w(c,s,p,n,r),d=g?y||(e?p:l||m)?[]:t:f;if(g&&g(f,d,n,r),m)for(i=w(d,u),m(i,[],n,r),o=i.length;o--;)(a=i[o])&&(d[u[o]]=!(f[u[o]]=a));if(e){if(y||p){if(y){for(i=[],o=d.length;o--;)(a=d[o])&&i.push(f[o]=a);y(null,d=[],i,r)}for(o=d.length;o--;)(a=d[o])&&-1<(i=y?Q(e,a):s[o])&&(e[i]=!(t[i]=a))}}else d=w(d===t?d.splice(l,d.length):d),y?y(null,t,d,r):J.apply(t,d)})}function p(e){for(var i,t,n,r=e.length,o=T.relative[e[0].type],a=o||T.relative[" "],s=o?1:0,u=f(function(e){return e===i},a,!0),l=f(function(e){return-1<Q(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!==k)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=T.relative[e[s].type])c=[f(d(c),t)];else{if((t=T.filter[e[s].type].apply(null,e[s].matches))[O]){for(n=++s;n<r&&!T.relative[e[n].type];n++);return v(1<s&&d(c),1<s&&m(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ie,"$1"),t,s<n&&p(e.slice(s,n)),n<r&&p(e=e.slice(n)),n<r&&m(e))}c.push(t)}return d(c)}var c,y,T,h,x,C,E,N,k,S,A,D,j,L,H,q,_,F,M,O="sizzle"+1*new Date,R=n.document,P=0,B=0,W=e(),I=e(),$=e(),z=function(e,t){return e===t&&(A=!0),0},X={}.hasOwnProperty,U=[],V=U.pop,Y=U.push,J=U.push,G=U.slice,Q=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Z="[\\x20\\t\\r\\n\\f]",ee="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",te="\\["+Z+"*("+ee+")(?:"+Z+"*([*^$|!~]?=)"+Z+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ee+"))|)"+Z+"*\\]",ne=":("+ee+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+te+")*)|.*)\\)|)",re=RegExp(Z+"+","g"),ie=RegExp("^"+Z+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Z+"+$","g"),oe=RegExp("^"+Z+"*,"+Z+"*"),ae=RegExp("^"+Z+"*([>+~]|"+Z+")"+Z+"*"),se=RegExp("="+Z+"*([^\\]'\"]*?)"+Z+"*\\]","g"),ue=RegExp(ne),le=RegExp("^"+ee+"$"),ce={ID:RegExp("^#("+ee+")"),CLASS:RegExp("^\\.("+ee+")"),TAG:RegExp("^("+ee+"|[*])"),ATTR:RegExp("^"+te),PSEUDO:RegExp("^"+ne),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Z+"*(even|odd|(([+-]|)(\\d*)n|)"+Z+"*(?:([+-]|)"+Z+"*(\\d+)|))"+Z+"*\\)|)","i"),bool:RegExp("^(?:"+K+")$","i"),needsContext:RegExp("^"+Z+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Z+"*((?:-\\d)?\\d*)"+Z+"*\\)|)(?=[^-]|$)","i")},fe=/^(?:input|select|textarea|button)$/i,de=/^h\d$/i,pe=/^[^{]+\{\s*\[native \w/,he=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ge=/[+~]/,me=/'|\\/g,ye=RegExp("\\\\([\\da-f]{1,6}"+Z+"?|("+Z+")|.)","ig"),ve=function(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},xe=function(){D()};try{J.apply(U=G.call(R.childNodes),R.childNodes),U[R.childNodes.length].nodeType}catch(be){J={apply:U.length?function(e,t){Y.apply(e,G.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}for(c in y=b.support={},x=b.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},D=b.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:R;return r!==j&&9===r.nodeType&&r.documentElement&&(L=(j=r).documentElement,H=!x(j),(n=j.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",xe,!1):n.attachEvent&&n.attachEvent("onunload",xe)),y.attributes=i(function(e){return e.className="i",!e.getAttribute("className")}),y.getElementsByTagName=i(function(e){return e.appendChild(j.createComment("")),!e.getElementsByTagName("*").length}),y.getElementsByClassName=pe.test(j.getElementsByClassName),y.getById=i(function(e){return L.appendChild(e).id=O,!j.getElementsByName||!j.getElementsByName(O).length}),y.getById?(T.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&H){var n=t.getElementById(e);return n?[n]:[]}},T.filter.ID=function(e){var t=e.replace(ye,ve);return function(e){return e.getAttribute("id")===t}}):(delete T.find.ID,T.filter.ID=function(e){var n=e.replace(ye,ve);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}}),T.find.TAG=y.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):y.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},T.find.CLASS=y.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&H)return t.getElementsByClassName(e)},_=[],q=[],(y.qsa=pe.test(j.querySelectorAll))&&(i(function(e){L.appendChild(e).innerHTML="<a id='"+O+"'></a><select id='"+O+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+Z+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||q.push("\\["+Z+"*(?:value|"+K+")"),e.querySelectorAll("[id~="+O+"-]").length||q.push("~="),e.querySelectorAll(":checked").length||q.push(":checked"),e.querySelectorAll("a#"+O+"+*").length||q.push(".#.+[+~]")}),i(function(e){var t=j.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&q.push("name"+Z+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),q.push(",.*:")})),(y.matchesSelector=pe.test(F=L.matches||L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&i(function(e){y.disconnectedMatch=F.call(e,"div"),F.call(e,"[s!='']:x"),_.push("!=",ne)}),q=q.length&&RegExp(q.join("|")),_=_.length&&RegExp(_.join("|")),t=pe.test(L.compareDocumentPosition),M=t||pe.test(L.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},z=t?function(e,t){if(e===t)return A=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!y.sortDetached&&t.compareDocumentPosition(e)===n?e===j||e.ownerDocument===R&&M(R,e)?-1:t===j||t.ownerDocument===R&&M(R,t)?1:S?Q(S,e)-Q(S,t):0:4&n?-1:1)}:function(e,t){if(e===t)return A=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e===j?-1:t===j?1:i?-1:o?1:S?Q(S,e)-Q(S,t):0;if(i===o)return l(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;a[r]===s[r];)r++;return r?l(a[r],s[r]):a[r]===R?-1:s[r]===R?1:0}),j},b.matches=function(e,t){return b(e,null,null,t)},b.matchesSelector=function(e,t){if((e.ownerDocument||e)!==j&&D(e),t=t.replace(se,"='$1']"),y.matchesSelector&&H&&!$[t+" "]&&(!_||!_.test(t))&&(!q||!q.test(t)))try{var n=F.call(e,t);if(n||y.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(be){}return 0<b(t,j,null,[e]).length},b.contains=function(e,t){return(e.ownerDocument||e)!==j&&D(e),M(e,t)},b.attr=function(e,t){(e.ownerDocument||e)!==j&&D(e);var n=T.attrHandle[t.toLowerCase()],r=n&&X.call(T.attrHandle,t.toLowerCase())?n(e,t,!H):undefined;return r!==undefined?r:y.attributes||!H?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},b.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},b.uniqueSort=function(e){var t,n=[],r=0,i=0;if(A=!y.detectDuplicates,S=!y.sortStable&&e.slice(0),e.sort(z),A){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return S=null,e},h=b.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=h(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=h(t);return n},(T=b.selectors={cacheLength:50,createPseudo:u,match:ce,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ye,ve),e[3]=(e[3]||e[4]||e[5]||"").replace(ye,ve),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||b.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&b.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return ce.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&ue.test(n)&&(t=C(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ye,ve).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=W[e+" "];return t||(t=RegExp("(^|"+Z+")"+e+"("+Z+"|$)"))&&W(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=b.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(re," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(h,e,t,g,m){var y="nth"!==h.slice(0,3),v="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===m?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u,l=y!==v?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),d=!n&&!x,p=!1;if(c){if(y){for(;l;){for(a=e;a=a[l];)if(x?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[v?c.firstChild:c.lastChild],v&&d){for(p=(s=(r=(i=(o=(a=c)[O]||(a[O]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===P&&r[1])&&r[2],a=s&&c.childNodes[s];a=++s&&a&&a[l]||(p=s=0)||u.pop();)if(1===a.nodeType&&++p&&a===e){i[h]=[P,s,p];break}}else if(d&&(p=s=(r=(i=(o=(a=e)[O]||(a[O]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===P&&r[1]),!1===p)for(;(a=++s&&a&&a[l]||(p=s=0)||u.pop())&&((x?a.nodeName.toLowerCase()!==f:1!==a.nodeType)||!++p||(d&&((i=(o=a[O]||(a[O]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]=[P,p]),a!==e)););return(p-=m)===g||p%g==0&&0<=p/g}}},PSEUDO:function(e,o){var t,a=T.pseudos[e]||T.setFilters[e.toLowerCase()]||b.error("unsupported pseudo: "+e);return a[O]?a(o):1<a.length?(t=[e,e,"",o],T.setFilters.hasOwnProperty(e.toLowerCase())?u(function(e,t){for(var n,r=a(e,o),i=r.length;i--;)e[n=Q(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:u(function(e){var r=[],i=[],s=E(e.replace(ie,"$1"));return s[O]?u(function(e,t,n,r){for(var i,o=s(e,null,r,[]),a=e.length;a--;)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:u(function(t){return function(e){return 0<b(t,e).length}}),contains:u(function(t){return t=t.replace(ye,ve),function(e){return-1<(e.textContent||e.innerText||h(e)).indexOf(t)}}),lang:u(function(n){return le.test(n||"")||b.error("unsupported lang: "+n),n=n.replace(ye,ve).toLowerCase(),function(e){var t;do{if(t=H?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===L},focus:function(e){return e===j.activeElement&&(!j.hasFocus||j.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!T.pseudos.empty(e)},header:function(e){return de.test(e.nodeName)},input:function(e){return fe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:a(function(){return[0]}),last:a(function(e,t){return[t-1]}),eq:a(function(e,t,n){return[n<0?n+t:n]}),even:a(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:a(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:a(function(e,t,n){for(var r=n<0?n+t:n;0<=--r;)e.push(r);return e}),gt:a(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=T.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})T.pseudos[c]=r(c);for(c in{submit:!0,reset:!0})T.pseudos[c]=o(c);return s.prototype=T.filters=T.pseudos,T.setFilters=new s,C=b.tokenize=function(e,t){var n,r,i,o,a,s,u,l=I[e+" "];if(l)return t?0:l.slice(0);for(a=e,s=[],u=T.preFilter;a;){for(o in n&&!(r=oe.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=ae.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace(ie," ")}),a=a.slice(n.length)),T.filter)!(r=ce[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?b.error(e):I(e,s).slice(0)},E=b.compile=function(e,t){var n,m,y,v,x,r,i=[],o=[],a=$[e+" "];if(!a){for(t||(t=C(e)),n=t.length;n--;)(a=p(t[n]))[O]?i.push(a):o.push(a);(a=$(e,(m=o,v=0<(y=i).length,x=0<m.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],d=k,p=e||x&&T.find.TAG("*",i),h=P+=null==d?1:Math.random()||.1,g=p.length;for(i&&(k=t===j||t||i);l!==g&&null!=(o=p[l]);l++){if(x&&o){for(a=0,t||o.ownerDocument===j||(D(o),n=!H);s=m[a++];)if(s(o,t||j,n)){r.push(o);break}i&&(P=h)}v&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,v&&l!==u){for(a=0;s=y[a++];)s(c,f,t,n);if(e){if(0<u)for(;l--;)c[l]||f[l]||(f[l]=V.call(r));f=w(f)}J.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&b.uniqueSort(r)}return i&&(P=h,k=d),c},v?u(r):r))).selector=e}return a},N=b.select=function(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&C(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&y.getById&&9===t.nodeType&&H&&T.relative[o[1].type]){if(!(t=(T.find.ID(a.matches[0].replace(ye,ve),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=ce.needsContext.test(e)?0:o.length;i--&&(a=o[i],!T.relative[s=a.type]);)if((u=T.find[s])&&(r=u(a.matches[0].replace(ye,ve),ge.test(o[0].type)&&g(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&m(o)))return J.apply(n,r),n;break}}return(l||E(e,c))(r,t,!H,n,!t||ge.test(e)&&g(t.parentNode)||t),n},y.sortStable=O.split("").sort(z).join("")===O,y.detectDuplicates=!!A,D(),y.sortDetached=i(function(e){return 1&e.compareDocumentPosition(j.createElement("div"))}),i(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||t("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),y.attributes&&i(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||t("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),i(function(e){return null==e.getAttribute("disabled")})||t(K,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),b}(C),dn.find=J,dn.expr=J.selectors,dn.expr[":"]=dn.expr.pseudos,dn.uniqueSort=dn.unique=J.uniqueSort,dn.text=J.getText,dn.isXMLDoc=J.isXML,dn.contains=J.contains,G=function(e,t,n){for(var r=[],i=n!==undefined;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&dn(e).is(n))break;r.push(e)}return r},Q=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},K=dn.expr.match.needsContext,Z=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,ee=/^.[^:#\[\.,]*$/,dn.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?dn.find.matchesSelector(r,e)?[r]:[]:dn.find.matches(e,dn.grep(t,function(e){return 1===e.nodeType}))},dn.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(dn(e).filter(function(){for(t=0;t<i;t++)if(dn.contains(r[t],this))return!0}));for(t=0;t<i;t++)dn.find(e,r[t],n);return(n=this.pushStack(1<i?dn.unique(n):n)).selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(t(this,e||[],!1))},not:function(e){return this.pushStack(t(this,e||[],!0))},is:function(e){return!!t(this,"string"==typeof e&&K.test(e)?dn(e):e||[],!1).length}}),ne=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,(dn.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||te,"string"==typeof e){if(!(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:ne.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof dn?t[0]:t,dn.merge(this,dn.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:tn,!0)),Z.test(r[1])&&dn.isPlainObject(t))for(r in t)dn.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}if((i=tn.getElementById(r[2]))&&i.parentNode){if(i.id!==r[2])return te.find(e);this.length=1,this[0]=i}return this.context=tn,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):dn.isFunction(e)?"undefined"!=typeof n.ready?n.ready(e):e(dn):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),dn.makeArray(e,this))}).prototype=dn.fn,te=dn(tn),re=/^(?:parents|prev(?:Until|All))/,ie={children:!0,contents:!0,next:!0,prev:!0},dn.fn.extend({has:function(e){var t,n=dn(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(dn.contains(this,n[t]))return!0})},closest:function(e,t){for(var n,r=0,i=this.length,o=[],a=K.test(e)||"string"!=typeof e?dn(e,t||this.context):0;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&dn.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?dn.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?dn.inArray(this[0],dn(e)):dn.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(dn.uniqueSort(dn.merge(this.get(),dn(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),dn.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return G(e,"parentNode")},parentsUntil:function(e,t,n){return G(e,"parentNode",n)},next:function(e){return n(e,"nextSibling")},prev:function(e){return n(e,"previousSibling")},nextAll:function(e){return G(e,"nextSibling")},prevAll:function(e){return G(e,"previousSibling")},nextUntil:function(e,t,n){return G(e,"nextSibling",n)},prevUntil:function(e,t,n){return G(e,"previousSibling",n)},siblings:function(e){return Q((e.parentNode||{}).firstChild,e)},children:function(e){return Q(e.firstChild)},contents:function(e){return dn.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:dn.merge([],e.childNodes)}},function(r,i){dn.fn[r]=function(e,t){var n=dn.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=dn.filter(t,n)),1<this.length&&(ie[r]||(n=dn.uniqueSort(n)),re.test(r)&&(n=n.reverse())),this.pushStack(n)}}),oe=/\S+/g,dn.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},dn.each(e.match(oe)||[],function(e,t){n[t]=!0}),n):dn.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=r.once,o=i=!0;u.length;l=-1)for(t=u.shift();++l<s.length;)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1);r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){dn.each(e,function(e,t){dn.isFunction(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==dn.type(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return dn.each(arguments,function(e,t){for(var n;-1<(n=dn.inArray(t,s,n));)s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<dn.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=!0,t||f.disable(),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},dn.extend({Deferred:function(e){var o=[["resolve","done",dn.Callbacks("once memory"),"resolved"],["reject","fail",dn.Callbacks("once memory"),"rejected"],["notify","progress",dn.Callbacks("memory")]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var i=arguments;return dn.Deferred(function(r){dn.each(o,function(e,t){var n=dn.isFunction(i[e])&&i[e];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&dn.isFunction(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this===a?r.promise():this,n?[e]:arguments)})}),i=null}).promise()},promise:function(e){return null!=e?dn.extend(e,a):a}},s={};return a.pipe=a.then,dn.each(o,function(e,t){var n=t[2],r=t[3];a[t[1]]=n.add,r&&n.add(function(){i=r},o[1^e][2].disable,o[2][2].lock),s[t[0]]=function(){return s[t[0]+"With"](this===s?a:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var i,t,n,r=0,o=nn.call(arguments),a=o.length,s=1!==a||e&&dn.isFunction(e.promise)?a:0,u=1===s?e:dn.Deferred(),l=function(t,n,r){return function(e){n[t]=this,r[t]=1<arguments.length?nn.call(arguments):e,r===i?u.notifyWith(n,r):--s||u.resolveWith(n,r)}};if(1<a)for(i=Array(a),t=Array(a),n=Array(a);r<a;r++)o[r]&&dn.isFunction(o[r].promise)?o[r].promise().progress(l(r,t,i)).done(l(r,n,o)).fail(u.reject):--s;return s||u.resolveWith(n,o),u.promise()}}),dn.fn.ready=function(e){return dn.ready.promise().done(e),this},dn.extend({isReady:!1,readyWait:1,holdReady:function(e){e?dn.readyWait++:dn.ready(!0)},ready:function(e){(!0===e?--dn.readyWait:dn.isReady)||(dn.isReady=!0)!==e&&0<--dn.readyWait||(ae.resolveWith(tn,[dn]),dn.fn.triggerHandler&&(dn(tn).triggerHandler("ready"),dn(tn).off("ready")))}}),dn.ready.promise=function(t){if(!ae)if(ae=dn.Deferred(),"complete"===tn.readyState||"loading"!==tn.readyState&&!tn.documentElement.doScroll)C.setTimeout(dn.ready);else if(tn.addEventListener)tn.addEventListener("DOMContentLoaded",o),C.addEventListener("load",o);else{tn.attachEvent("onreadystatechange",o),C.attachEvent("onload",o);var n=!1;try{n=null==C.frameElement&&tn.documentElement}catch(r){}n&&n.doScroll&&function e(){if(!dn.isReady){try{n.doScroll("left")}catch(r){return C.setTimeout(e,50)}i(),dn.ready()}}()}return ae.promise(t)},dn.ready.promise(),dn(cn))break;return cn.ownFirst="0"===se,cn.inlineBlockNeedsLayout=!1,dn(function(){var e,t,n,r;(n=tn.getElementsByTagName("body")[0])&&n.style&&(t=tn.createElement("div"),(r=tn.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(r).appendChild(t),"undefined"!=typeof t.style.zoom&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",cn.inlineBlockNeedsLayout=e=3===t.offsetWidth,e&&(n.style.zoom=1)),n.removeChild(r))}),function(){var e=tn.createElement("div");cn.deleteExpando=!0;try{delete e.test}catch(t){cn.deleteExpando=!1}e=null}(),ue=function(e){var t=dn.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return(1===n||9===n)&&(!t||!0!==t&&e.getAttribute("classid")===t)},le=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ce=/([A-Z])/g,dn.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return!!(e=e.nodeType?dn.cache[e[dn.expando]]:e[dn.expando])&&!l(e)},data:function(e,t,n){return r(e,t,n)},removeData:function(e,t){return a(e,t)},_data:function(e,t,n){return r(e,t,n,!0)},_removeData:function(e,t){return a(e,t,!0)}}),dn.fn.extend({data:function(e,t){var n,r,i,o=this[0],a=o&&o.attributes;if(e===undefined){if(this.length&&(i=dn.data(o),1===o.nodeType&&!dn._data(o,"parsedAttrs"))){for(n=a.length;n--;)a[n]&&0===(r=a[n].name).indexOf("data-")&&u(o,r=dn.camelCase(r.slice(5)),i[r]);dn._data(o,"parsedAttrs",!0)}return i}return"object"==typeof e?this.each(function(){dn.data(this,e)}):1<arguments.length?this.each(function(){dn.data(this,e,t)}):o?u(o,e,dn.data(o,e)):undefined},removeData:function(e){return this.each(function(){dn.removeData(this,e)})}}),dn.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=dn._data(e,t),n&&(!r||dn.isArray(n)?r=dn._data(e,t,dn.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=dn.queue(e,t),r=n.length,i=n.shift(),o=dn._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){dn.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return dn._data(e,n)||dn._data(e,n,{empty:dn.Callbacks("once memory").add(function(){dn._removeData(e,t+"queue"),dn._removeData(e,n)})})}}),dn.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?dn.queue(this[0],t):n===undefined?this:this.each(function(){var e=dn.queue(this,t,n);dn._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&dn.dequeue(this,t)})},dequeue:function(e){return this.each(function(){dn.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=dn.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=undefined),e=e||"fx";a--;)(n=dn._data(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}}),cn.shrinkWrapBlocks=function(){return null!=Xt?Xt:(Xt=!1,(t=tn.getElementsByTagName("body")[0])&&t.style?(e=tn.createElement("div"),(n=tn.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",t.appendChild(n).appendChild(e),"undefined"!=typeof e.style.zoom&&(e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",e.appendChild(tn.createElement("div")).style.width="5px",Xt=3!==e.offsetWidth),t.removeChild(n),Xt):void 0);var e,t,n},de=RegExp("^(?:([+-])=|)("+(fe="[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)")+")([a-z%]*)$","i"),pe=["Top","Right","Bottom","Left"],he=function(e,t){return e=t||e,"none"===dn.css(e,"display")||!dn.contains(e.ownerDocument,e)},ge=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===dn.type(n))for(s in i=!0,n)ge(e,t,s,n[s],!0,o,a);else if(r!==undefined&&(i=!0,dn.isFunction(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(dn(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},me=/^(?:checkbox|radio)$/i,ye=/<([\w:-]+)/,ve=/^$|\/(?:java|ecma)script/i,xe=/^\s+/,be="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video",Ut=tn.createElement("div"),Vt=tn.createDocumentFragment(),Yt=tn.createElement("input"),Ut.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",cn.leadingWhitespace=3===Ut.firstChild.nodeType,cn.tbody=!Ut.getElementsByTagName("tbody").length,cn.htmlSerialize=!!Ut.getElementsByTagName("link").length,cn.html5Clone="<:nav></:nav>"!==tn.createElement("nav").cloneNode(!0).outerHTML,Yt.type="checkbox",Yt.checked=!0,Vt.appendChild(Yt),cn.appendChecked=Yt.checked,Ut.innerHTML="<textarea>x</textarea>",cn.noCloneChecked=!!Ut.cloneNode(!0).lastChild.defaultValue,Vt.appendChild(Ut),(Yt=tn.createElement("input")).setAttribute("type","radio"),Yt.setAttribute("checked","checked"),Yt.setAttribute("name","t"),Ut.appendChild(Yt),cn.checkClone=Ut.cloneNode(!0).cloneNode(!0).lastChild.checked,cn.noCloneEvent=!!Ut.addEventListener,Ut[dn.expando]=1,cn.attributes=!Ut.getAttribute(dn.expando),(we={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:cn.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]}).optgroup=we.option,we.tbody=we.tfoot=we.colgroup=we.caption=we.thead,we.th=we.td,Te=/<|&#?\w+;/,Ce=/<tbody/i,function(){var e,t,n=tn.createElement("div");for(e in{submit:!0,change:!0,focusin:!0})t="on"+e,(cn[e]=t in C)||(n.setAttribute(t,"t"),cn[e]=!1===n.attributes[t].expando);n=null}(),Ee=/^(?:input|select|textarea)$/i,Ne=/^key/,ke=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Se=/^(?:focusinfocus|focusoutblur)$/,Ae=/^([^.]*)(?:\.(.+)|)/,dn.event={global:{},add:function(e,t,n,r,i){var o,a,s,u,l,c,f,d,p,h,g,m=dn._data(e);if(m){for(n.handler&&(n=(u=n).handler,i=u.selector),n.guid||(n.guid=dn.guid++),(a=m.events)||(a=m.events={}),(c=m.handle)||((c=m.handle=function(e){var t;try{t=e.type}catch(e){}return"undefined"==typeof dn||e&&dn.event.triggered===t?undefined:dn.event.dispatch.apply(c.elem,arguments)}).elem=e),s=(t=(t||"").match(oe)||[""]).length;s--;)p=g=(o=Ae.exec(t[s])||[])[1],h=(o[2]||"").split(".").sort(),p&&(l=dn.event.special[p]||{},p=(i?l.delegateType:l.bindType)||p,l=dn.event.special[p]||{},f=dn.extend({type:p,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&dn.expr.match.needsContext.test(i),namespace:h.join(".")},u),(d=a[p])||((d=a[p]=[]).delegateCount=0,l.setup&&!1!==l.setup.call(e,r,h,c)||(e.addEventListener?e.addEventListener(p,c,!1):e.attachEvent&&e.attachEvent("on"+p,c))),l.add&&(l.add.call(e,f),f.handler.guid||(f.handler.guid=n.guid)),i?d.splice(d.delegateCount++,0,f):d.push(f),dn.event.global[p]=!0);e=null}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,d,p,h,g,m=dn.hasData(e)&&dn._data(e);if(m&&(c=m.events)){for(l=(t=(t||"").match(oe)||[""]).length;l--;)if(p=g=(s=Ae.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),p){for(f=dn.event.special[p]||{},d=c[p=(r?f.delegateType:f.bindType)||p]||[],s=s[2]&&RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),u=o=d.length;o--;)a=d[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&("**"!==r||!a.selector)||(d.splice(o,1),a.selector&&d.delegateCount--,f.remove&&f.remove.call(e,a));u&&!d.length&&(f.teardown&&!1!==f.teardown.call(e,h,m.handle)||dn.removeEvent(e,p,m.handle),delete c[p])}else for(p in c)dn.event.remove(e,p+t[l],n,r,!0);dn.isEmptyObject(c)&&(delete m.handle,dn._removeData(e,"events"))}},trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f=[n||tn],d=ln.call(e,"type")?e.type:e,p=ln.call(e,"namespace")?e.namespace.split("."):[];if(a=l=n=n||tn,3!==n.nodeType&&8!==n.nodeType&&!Se.test(d+dn.event.triggered)&&(-1<d.indexOf(".")&&(d=(p=d.split(".")).shift(),p.sort()),o=d.indexOf(":")<0&&"on"+d,(e=e[dn.expando]?e:new dn.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=p.join("."),e.rnamespace=e.namespace?RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=undefined,e.target||(e.target=n),t=null==t?[e]:dn.makeArray(t,[e]),u=dn.event.special[d]||{},r||!u.trigger||!1!==u.trigger.apply(n,t))){if(!r&&!u.noBubble&&!dn.isWindow(n)){for(s=u.delegateType||d,Se.test(s+d)||(a=a.parentNode);a;a=a.parentNode)f.push(a),l=a;l===(n.ownerDocument||tn)&&f.push(l.defaultView||l.parentWindow||C)}for(c=0;(a=f[c++])&&!e.isPropagationStopped();)e.type=1<c?s:u.bindType||d,(i=(dn._data(a,"events")||{})[e.type]&&dn._data(a,"handle"))&&i.apply(a,t),(i=o&&a[o])&&i.apply&&ue(a)&&(e.result=i.apply(a,t),!1===e.result&&e.preventDefault());if(e.type=d,!r&&!e.isDefaultPrevented()&&(!u._default||!1===u._default.apply(f.pop(),t))&&ue(n)&&o&&n[d]&&!dn.isWindow(n)){(l=n[o])&&(n[o]=null),dn.event.triggered=d;try{n[d]()}catch(h){}dn.event.triggered=undefined,l&&(n[o]=l)}return e.result}},dispatch:function(e){e=dn.event.fix(e);var t,n,r,i,o,a,s=nn.call(arguments),u=(dn._data(this,"events")||{})[e.type]||[],l=dn.event.special[e.type]||{};if((s[0]=e).delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,e)){for(a=dn.event.handlers.call(this,e,u),t=0;(i=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(o.namespace)||(e.handleObj=o,e.data=o.data,(r=((dn.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))!==undefined&&!1===(e.result=r)&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,o,a=[],s=t.delegateCount,u=e.target;if(s&&u.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;u!=this;u=u.parentNode||this)if(1===u.nodeType&&(!0!==u.disabled||"click"!==e.type)){for(r=[],n=0;n<s;n++)r[i=(o=t[n]).selector+" "]===undefined&&(r[i]=o.needsContext?-1<dn(i,this).index(u):dn.find(i,this,null,[u]).length),r[i]&&r.push(o);r.length&&a.push({elem:u,handlers:r})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},fix:function(e){if(e[dn.expando])return e;var t,n,r,i=e.type,o=e,a=this.fixHooks[i];for(a||(this.fixHooks[i]=a=ke.test(i)?this.mouseHooks:Ne.test(i)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,e=new dn.Event(o),t=r.length;t--;)e[n=r[t]]=o[n];return e.target||(e.target=o.srcElement||tn),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,o=t.button,a=t.fromElement;return null==e.pageX&&null!=t.clientX&&(i=(r=e.target.ownerDocument||tn).documentElement,n=r.body,e.pageX=t.clientX+(i&&i.scrollLeft||n&&n.scrollLeft||0)-(i&&i.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||n&&n.scrollTop||0)-(i&&i.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?t.toElement:a),e.which||o===undefined||(e.which=1&o?1:2&o?3:4&o?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==p()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===p()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(dn.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return dn.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n){var r=dn.extend(new dn.Event,n,{type:e,isSimulated:!0});dn.event.trigger(r,null,t),r.isDefaultPrevented()&&n.preventDefault()}},dn.removeEvent=tn.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)}:function(e,t,n){var r="on"+t;e.detachEvent&&("undefined"==typeof e[r]&&(e[r]=null),e.detachEvent(r,n))},dn.Event=function(e,t){if(!(this instanceof dn.Event))return new dn.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&!1===e.returnValue?f:d):this.type=e,t&&dn.extend(this,t),this.timeStamp=e&&e.timeStamp||dn.now(),this[dn.expando]=!0},dn.Event.prototype={constructor:dn.Event,isDefaultPrevented:d,isPropagationStopped:d,isImmediatePropagationStopped:d,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=f,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=f,e&&!this.isSimulated&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=f,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},dn.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){dn.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||dn.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),cn.submit||(dn.event.special.submit={setup:function(){if(dn.nodeName(this,"form"))return!1;dn.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=dn.nodeName(t,"input")||dn.nodeName(t,"button")?dn.prop(t,"form"):undefined;n&&!dn._data(n,"submit")&&(dn.event.add(n,"submit._submit",function(e){e._submitBubble=!0}),dn._data(n,"submit",!0))})},postDispatch:function(e){e._submitBubble&&(delete e._submitBubble,this.parentNode&&!e.isTrigger&&dn.event.simulate("submit",this.parentNode,e))},teardown:function(){if(dn.nodeName(this,"form"))return!1;dn.event.remove(this,"._submit")}}),cn.change||(dn.event.special.change={setup:function(){if(Ee.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(dn.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._justChanged=!0)}),dn.event.add(this,"click._change",function(e){this._justChanged&&!e.isTrigger&&(this._justChanged=!1),dn.event.simulate("change",this,e)})),!1;dn.event.add(this,"beforeactivate._change",function(e){var t=e.target;Ee.test(t.nodeName)&&!dn._data(t,"change")&&(dn.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||dn.event.simulate("change",this.parentNode,e)}),dn._data(t,"change",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return dn.event.remove(this,"._change"),!Ee.test(this.nodeName)}}),cn.focusin||dn.each({focus:"focusin",blur:"focusout"},function(n,r){var i=function(e){dn.event.simulate(r,e.target,dn.event.fix(e))};dn.event.special[r]={setup:function(){var e=this.ownerDocument||this,t=dn._data(e,r);t||e.addEventListener(n,i,!0),dn._data(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=dn._data(e,r)-1;t?dn._data(e,r,t):(e.removeEventListener(n,i,!0),dn._removeData(e,r))}}}),dn.fn.extend({on:function(e,t,n,r){return h(this,e,t,n,r)},one:function(e,t,n,r){return h(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,dn(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=undefined),!1===n&&(n=d),this.each(function(){dn.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){dn.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return dn.event.trigger(e,t,n,!0)}}),De=/ jQuery\d+="(?:null|\d+)"/g,je=RegExp("<(?:"+be+")[\\s/>]","i"),Le=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,He=/<script|<style|<link/i,qe=/checked\s*(?:[^=]|=\s*.checked.)/i,_e=/^true\/(.*)/,Fe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Me=m(tn),Oe=Me.appendChild(tn.createElement("div")),dn.extend({htmlPrefilter:function(e){return e.replace(Le,"<$1></$2>")},clone:function(e,t,n){var r,i,o,a,s,u=dn.contains(e.ownerDocument,e);if(cn.html5Clone||dn.isXMLDoc(e)||!je.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Oe.innerHTML=e.outerHTML,Oe.removeChild(o=Oe.firstChild)),!(cn.noCloneEvent&&cn.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||dn.isXMLDoc(e)))for(r=y(o),s=y(e),a=0;null!=(i=s[a]);++a)r[a]&&N(i,r[a]);if(t)if(n)for(s=s||y(e),r=r||y(o),a=0;null!=(i=s[a]);a++)E(i,r[a]);else E(e,o);return 0<(r=y(o,"script")).length&&v(r,!u&&y(e,"script")),r=s=i=null,o},cleanData:function(e,t){for(var n,r,i,o,a=0,s=dn.expando,u=dn.cache,l=cn.attributes,c=dn.event.special;null!=(n=e[a]);a++)if((t||ue(n))&&(o=(i=n[s])&&u[i])){if(o.events)for(r in o.events)c[r]?dn.event.remove(n,r):dn.removeEvent(n,r,o.handle);u[i]&&(delete u[i],l||"undefined"==typeof n.removeAttribute?n[s]=undefined:n.removeAttribute(s),en.push(i))}}}),dn.fn.extend({domManip:k,detach:function(e){return S(this,e,!0)},remove:function(e){return S(this,e)},text:function(e){return ge(this,function(e){return e===undefined?dn.text(this):this.empty().append((this[0]&&this[0].ownerDocument||tn).createTextNode(e))},null,e,arguments.length)},append:function(){return k(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||b(this,e).appendChild(e)})},prepend:function(){return k(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=b(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return k(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return k(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&dn.cleanData(y(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&dn.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return dn.clone(this,e,t)})},html:function(e){return ge(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined)return 1===t.nodeType?t.innerHTML.replace(De,""):undefined;if("string"==typeof e&&!He.test(e)&&(cn.htmlSerialize||!je.test(e))&&(cn.leadingWhitespace||!xe.test(e))&&!we[(ye.exec(e)||["",""])[1].toLowerCase()]){e=dn.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(dn.cleanData(y(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return k(this,arguments,function(e){var t=this.parentNode;dn.inArray(this,n)<0&&(dn.cleanData(y(this)),t&&t.replaceChild(e,this))},n)}}),dn.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){dn.fn[e]=function(e){for(var t,n=0,r=[],i=dn(e),o=i.length-1;n<=o;n++)t=n===o?this:this.clone(!0),dn(i[n])[a](t),on.apply(r,t.get());return this.pushStack(r)}}),Pe={HTML:"block",BODY:"block"},Be=/^margin/,We=RegExp("^("+fe+")(?!px)[a-z%]+$","i"),Ie=function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];for(o in i=n.apply(e,r||[]),t)e.style[o]=a[o];return i},$e=tn.documentElement,function(){function e(){var e,t,n=tn.documentElement;n.appendChild(l),c.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",r=o=u=!1,i=s=!0,C.getComputedStyle&&(t=C.getComputedStyle(c),r="1%"!==(t||{}).top,u="2px"===(t||{}).marginLeft,o="4px"===(t||{width:"4px"}).width,c.style.marginRight="50%",i="4px"===(t||{marginRight:"4px"}).marginRight,(e=c.appendChild(tn.createElement("div"))).style.cssText=c.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",c.style.width="1px",s=!parseFloat((C.getComputedStyle(e)||{}).marginRight),c.removeChild(e)),c.style.display="none",(a=0===c.getClientRects().length)&&(c.style.display="",c.innerHTML="<table><tr><td></td><td>t</td></tr></table>",c.childNodes[0].style.borderCollapse="separate",(e=c.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",(a=0===e[0].offsetHeight)&&(e[0].style.display="",e[1].style.display="none",a=0===e[0].offsetHeight)),n.removeChild(l)}var r,i,o,a,s,u,l=tn.createElement("div"),c=tn.createElement("div");c.style&&(c.style.cssText="float:left;opacity:.5",cn.opacity="0.5"===c.style.opacity,cn.cssFloat=!!c.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",cn.clearCloneStyle="content-box"===c.style.backgroundClip,(l=tn.createElement("div")).style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",c.innerHTML="",l.appendChild(c),cn.boxSizing=""===c.style.boxSizing||""===c.style.MozBoxSizing||""===c.style.WebkitBoxSizing,dn.extend(cn,{reliableHiddenOffsets:function(){return null==r&&e(),a},boxSizingReliable:function(){return null==r&&e(),o},pixelMarginRight:function(){return null==r&&e(),i},pixelPosition:function(){return null==r&&e(),r},reliableMarginRight:function(){return null==r&&e(),s},reliableMarginLeft:function(){return null==r&&e(),u}}))}(),Ue=/^(top|right|bottom|left)$/,C.getComputedStyle?(ze=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=C),t.getComputedStyle(e)},Xe=function(e,t,n){var r,i,o,a,s=e.style;return""!==(a=(n=n||ze(e))?n.getPropertyValue(t)||n[t]:undefined)&&a!==undefined||dn.contains(e.ownerDocument,e)||(a=dn.style(e,t)),n&&!cn.pixelMarginRight()&&We.test(a)&&Be.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o),a===undefined?a:a+""}):$e.currentStyle&&(ze=function(e){return e.currentStyle},Xe=function(e,t,n){var r,i,o,a,s=e.style;return null==(a=(n=n||ze(e))?n[t]:undefined)&&s&&s[t]&&(a=s[t]),We.test(a)&&!Ue.test(t)&&(r=s.left,(o=(i=e.runtimeStyle)&&i.left)&&(i.left=e.currentStyle.left),s.left="fontSize"===t?"1em":a,a=s.pixelLeft+"px",s.left=r,o&&(i.left=o)),a===undefined?a:a+""||"auto"}),Ve=/alpha\([^)]*\)/i,Ye=/opacity\s*=\s*([^)]*)/i,Je=/^(none|table(?!-c[ea]).+)/,Ge=RegExp("^("+fe+")(.*)$","i"),Qe={position:"absolute",visibility:"hidden",display:"block"},Ke={letterSpacing:"0",fontWeight:"400"},Ze=["Webkit","O","Moz","ms"],et=tn.createElement("div").style,dn.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Xe(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":cn.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=dn.camelCase(t),u=e.style;if(t=dn.cssProps[s]||(dn.cssProps[s]=L(s)||s),a=dn.cssHooks[t]||dn.cssHooks[s],n===undefined)return a&&"get"in a&&(i=a.get(e,!1,r))!==undefined?i:u[t];if("string"===(o=typeof n)&&(i=de.exec(n))&&i[1]&&(n=c(e,t,i),o="number"),null!=n&&n==n&&("number"===o&&(n+=i&&i[3]||(dn.cssNumber[s]?"":"px")),cn.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),!(a&&"set"in a&&(n=a.set(e,n,r))===undefined)))try{u[t]=n}catch(l){}}},css:function(e,t,n,r){var i,o,a,s=dn.camelCase(t);return t=dn.cssProps[s]||(dn.cssProps[s]=L(s)||s),(a=dn.cssHooks[t]||dn.cssHooks[s])&&"get"in a&&(o=a.get(e,!0,n)),o===undefined&&(o=Xe(e,t,r)),"normal"===o&&t in Ke&&(o=Ke[t]),""===n||n?(i=parseFloat(o),!0===n||isFinite(i)?i||0:o):o}}),dn.each(["height","width"],function(e,i){dn.cssHooks[i]={get:function(e,t,n){if(t)return Je.test(dn.css(e,"display"))&&0===e.offsetWidth?Ie(e,Qe,function(){return F(e,i,n)}):F(e,i,n)},set:function(e,t,n){var r=n&&ze(e);return q(0,t,n?_(e,i,n,cn.boxSizing&&"border-box"===dn.css(e,"boxSizing",!1,r),r):0)}}}),cn.opacity||(dn.cssHooks.opacity={get:function(e,t){return Ye.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=dn.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";((n.zoom=1)<=t||""===t)&&""===dn.trim(o.replace(Ve,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=Ve.test(o)?o.replace(Ve,i):o+" "+i)}}),dn.cssHooks.marginRight=j(cn.reliableMarginRight,function(e,t){if(t)return Ie(e,{display:"inline-block"},Xe,[e,"marginRight"])}),dn.cssHooks.marginLeft=j(cn.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Xe(e,"marginLeft"))||(dn.contains(e.ownerDocument,e)?e.getBoundingClientRect().left-Ie(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}):0))+"px"}),dn.each({margin:"",padding:"",border:"Width"},function(i,o){dn.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+pe[t]+o]=r[t]||r[t-2]||r[0];return n}},Be.test(i)||(dn.cssHooks[i+o].set=q)}),dn.fn.extend({css:function(e,t){return ge(this,function(e,t,n){var r,i,o={},a=0;if(dn.isArray(t)){for(r=ze(e),i=t.length;a<i;a++)o[t[a]]=dn.css(e,t[a],!1,r);return o}return n!==undefined?dn.style(e,t,n):dn.css(e,t)},e,t,1<arguments.length)},show:function(){return H(this,!0)},hide:function(){return H(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){he(this)?dn(this).show():dn(this).hide()})}}),((dn.Tween=M).prototype={constructor:M,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||dn.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(dn.cssNumber[n]?"":"px")},cur:function(){var e=M.propHooks[this.prop];return e&&e.get?e.get(this):M.propHooks._default.get(this)},run:function(e){var t,n=M.propHooks[this.prop];return this.options.duration?this.pos=t=dn.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):M.propHooks._default.set(this),this}}).init.prototype=M.prototype,(M.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=dn.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){dn.fx.step[e.prop]?dn.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[dn.cssProps[e.prop]]&&!dn.cssHooks[e.prop]?e.elem[e.prop]=e.now:dn.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=M.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},dn.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},dn.fx=M.prototype.init,dn.fx.step={},rt=/^(?:toggle|show|hide)$/,it=/queueHooks$/,dn.Animation=dn.extend(B,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return c(n.elem,e,de.exec(t),n),n}]},tweener:function(e,t){dn.isFunction(e)?(t=e,e=["*"]):e=e.match(oe);for(var n,r=0,i=e.length;r<i;r++)n=e[r],B.tweeners[n]=B.tweeners[n]||[],B.tweeners[n].unshift(t)},prefilters:[function(t,e,n){var r,i,o,a,s,u,l,c=this,f={},d=t.style,p=t.nodeType&&he(t),h=dn._data(t,"fxshow");for(r in n.queue||(null==(s=dn._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,u=s.empty.fire,s.empty.fire=function(){s.unqueued||u()}),s.unqueued++,c.always(function(){c.always(function(){s.unqueued--,dn.queue(t,"fx").length||s.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===("none"===(l=dn.css(t,"display"))?dn._data(t,"olddisplay")||D(t.nodeName):l)&&"none"===dn.css(t,"float")&&(cn.inlineBlockNeedsLayout&&"inline"!==D(t.nodeName)?d.zoom=1:d.display="inline-block")),n.overflow&&(d.overflow="hidden",cn.shrinkWrapBlocks()||c.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]})),e)if(i=e[r],rt.exec(i)){if(delete e[r],o=o||"toggle"===i,i===(p?"hide":"show")){if("show"!==i||!h||h[r]===undefined)continue;p=!0}f[r]=h&&h[r]||dn.style(t,r)}else l=undefined;if(dn.isEmptyObject(f))"inline"===("none"===l?D(t.nodeName):l)&&(d.display=l);else for(r in h?"hidden"in h&&(p=h.hidden):h=dn._data(t,"fxshow",{}),o&&(h.hidden=!p),p?dn(t).show():c.done(function(){dn(t).hide()}),c.done(function(){var e;for(e in dn._removeData(t,"fxshow"),f)dn.style(t,e,f[e])}),f)a=P(p?h[r]:0,r,c),r in h||(h[r]=a.start,p&&(a.end=a.start,a.start="width"===r||"height"===r?1:0))}],prefilter:function(e,t){t?B.prefilters.unshift(e):B.prefilters.push(e)}}),dn.speed=function(e,t,n){var r=e&&"object"==typeof e?dn.extend({},e):{complete:n||!n&&t||dn.isFunction(e)&&e,duration:e,easing:n&&t||t&&!dn.isFunction(t)&&t};return r.duration=dn.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in dn.fx.speeds?dn.fx.speeds[r.duration]:dn.fx.speeds._default,null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){dn.isFunction(r.old)&&r.old.call(this),r.queue&&dn.dequeue(this,r.queue)},r},dn.fn.extend({fadeTo:function(e,t,n,r){return this.filter(he).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=dn.isEmptyObject(t),o=dn.speed(e,n,r),a=function(){var e=B(this,dn.extend({},t),o);(i||dn._data(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=undefined),e&&!1!==i&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=dn.timers,r=dn._data(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&it.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||dn.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=dn._data(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=dn.timers,o=n?n.length:0;for(t.finish=!0,dn.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),dn.each(["toggle","show","hide"],function(e,r){var i=dn.fn[r];dn.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(R(r,!0),e,t,n)}}),dn.each({slideDown:R("show"),slideUp:R("hide"),slideToggle:R("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){dn.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),dn.timers=[],dn.fx.tick=function(){var e,t=dn.timers,n=0;for(tt=dn.now();n<t.length;n++)(e=t[n])()||t[n]!==e||t.splice(n--,1);t.length||dn.fx.stop(),tt=undefined},dn.fx.timer=function(e){dn.timers.push(e),e()?dn.fx.start():dn.timers.pop()},dn.fx.interval=13,dn.fx.start=function(){nt||(nt=C.setInterval(dn.fx.tick,dn.fx.interval))},dn.fx.stop=function(){C.clearInterval(nt),nt=null},dn.fx.speeds={slow:600,fast:200,_default:400},dn.fn.delay=function(r,e){return r=dn.fx&&dn.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=C.setTimeout(e,r);t.stop=function(){C.clearTimeout(n)}})},Gt=tn.createElement("input"),Qt=tn.createElement("div"),Kt=tn.createElement("select"),Zt=Kt.appendChild(tn.createElement("option")),(Qt=tn.createElement("div")).setAttribute("className","t"),Qt.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",Jt=Qt.getElementsByTagName("a")[0],Gt.setAttribute("type","checkbox"),Qt.appendChild(Gt),(Jt=Qt.getElementsByTagName("a")[0]).style.cssText="top:1px",cn.getSetAttribute="t"!==Qt.className,cn.style=/top/.test(Jt.getAttribute("style")),cn.hrefNormalized="/a"===Jt.getAttribute("href"),cn.checkOn=!!Gt.value,cn.optSelected=Zt.selected,cn.enctype=!!tn.createElement("form").enctype,Kt.disabled=!0,cn.optDisabled=!Zt.disabled,(Gt=tn.createElement("input")).setAttribute("value",""),cn.input=""===Gt.getAttribute("value"),Gt.value="t",Gt.setAttribute("type","radio"),cn.radioValue="t"===Gt.value,ot=/\r/g,at=/[\x20\t\r\n\f]+/g,dn.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=dn.isFunction(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,dn(this).val()):n)?t="":"number"==typeof t?t+="":dn.isArray(t)&&(t=dn.map(t,function(e){return null==e?"":e+""})),(r=dn.valHooks[this.type]||dn.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&r.set(this,t,"value")!==undefined||(this.value=t))})):t?(r=dn.valHooks[t.type]||dn.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&(e=r.get(t,"value"))!==undefined?e:"string"==typeof(e=t.value)?e.replace(ot,""):null==e?"":e:void 0}}),dn.extend({valHooks:{option:{get:function(e){var t=dn.find.attr(e,"value");return null!=t?t:dn.trim(dn.text(e)).replace(at," ")}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||i<0,a=o?null:[],s=o?i+1:r.length,u=i<0?s:o?i:0;u<s;u++)if(((n=r[u]).selected||u===i)&&(cn.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!dn.nodeName(n.parentNode,"optgroup"))){if(t=dn(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,r,i=e.options,o=dn.makeArray(t),a=i.length;a--;)if(r=i[a],-1<dn.inArray(dn.valHooks.option.get(r),o))try{r.selected=n=!0}catch(s){r.scrollHeight}else r.selected=!1;return n||(e.selectedIndex=-1),i}}}}),dn.each(["radio","checkbox"],function(){dn.valHooks[this]={set:function(e,t){if(dn.isArray(t))return e.checked=-1<dn.inArray(dn(e).val(),t)}},cn.checkOn||(dn.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),lt=dn.expr.attrHandle,ct=/^(?:checked|selected)$/i,ft=cn.getSetAttribute,dt=cn.input,dn.fn.extend({attr:function(e,t){return ge(this,dn.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){dn.removeAttr(this,e)})}}),dn.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?dn.prop(e,t,n):(1===o&&dn.isXMLDoc(e)||(t=t.toLowerCase(),i=dn.attrHooks[t]||(dn.expr.match.bool.test(t)?ut:st)),n!==undefined?null===n?void dn.removeAttr(e,t):i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=dn.find.attr(e,t))?undefined:r)},attrHooks:{type:{set:function(e,t){if(!cn.radioValue&&"radio"===t&&dn.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(oe);if(o&&1===e.nodeType)for(;n=o[i++];)r=dn.propFix[n]||n,dn.expr.match.bool.test(n)?dt&&ft||!ct.test(n)?e[r]=!1:e[dn.camelCase("default-"+n)]=e[r]=!1:dn.attr(e,n,""),e.removeAttribute(ft?n:r)}}),ut={set:function(e,t,n){return!1===t?dn.removeAttr(e,n):dt&&ft||!ct.test(n)?e.setAttribute(!ft&&dn.propFix[n]||n,n):e[dn.camelCase("default-"+n)]=e[n]=!0,n}},dn.each(dn.expr.match.bool.source.match(/\w+/g),function(e,t){var o=lt[t]||dn.find.attr;dt&&ft||!ct.test(t)?lt[t]=function(e,t,n){var r,i;return n||(i=lt[t],lt[t]=r,r=null!=o(e,t,n)?t.toLowerCase():null,lt[t]=i),r}:lt[t]=function(e,t,n){if(!n)return e[dn.camelCase("default-"+t)]?t.toLowerCase():null}}),dt&&ft||(dn.attrHooks.value={set:function(e,t,n){if(!dn.nodeName(e,"input"))return st&&st.set(e,t,n);e.defaultValue=t}}),ft||(st={set:function(e,t,n){var r=e.getAttributeNode(n);if(r||e.setAttributeNode(r=e.ownerDocument.createAttribute(n)),r.value=t+="","value"===n||t===e.getAttribute(n))return t}},lt.id=lt.name=lt.coords=function(e,t,n){var r;if(!n)return(r=e.getAttributeNode(t))&&""!==r.value?r.value:null},dn.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);if(n&&n.specified)return n.value},set:st.set},dn.attrHooks.contenteditable={set:function(e,t,n){st.set(e,""!==t&&t,n)}},dn.each(["width","height"],function(e,n){dn.attrHooks[n]={set:function(e,t){if(""===t)return e.setAttribute(n,"auto"),t}}})),cn.style||(dn.attrHooks.style={get:function(e){return e.style.cssText||undefined},set:function(e,t){return e.style.cssText=t+""}}),pt=/^(?:input|select|textarea|button|object)$/i,ht=/^(?:a|area)$/i,dn.fn.extend({prop:function(e,t){return ge(this,dn.prop,e,t,1<arguments.length)},removeProp:function(t){return t=dn.propFix[t]||t,this.each(function(){try{this[t]=undefined,delete this[t]}catch(e){}})}}),dn.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&dn.isXMLDoc(e)||(t=dn.propFix[t]||t,i=dn.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=dn.find.attr(e,"tabindex");return t?parseInt(t,10):pt.test(e.nodeName)||ht.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),cn.hrefNormalized||dn.each(["href","src"],function(e,t){dn.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),cn.optSelected||(dn.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),dn.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){dn.propFix[this.toLowerCase()]=this}),cn.enctype||(dn.propFix.enctype="encoding"),gt=/[\t\r\n\f]/g,dn.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,u=0;if(dn.isFunction(t))return this.each(function(e){dn(this).addClass(t.call(this,e,W(this)))});if("string"==typeof t&&t)for(e=t.match(oe)||[];n=this[u++];)if(i=W(n),r=1===n.nodeType&&(" "+i+" ").replace(gt," ")){for(a=0;o=e[a++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=dn.trim(r))&&dn.attr(n,"class",s)}return this},removeClass:function(t){var e,n,r,i,o,a,s,u=0;if(dn.isFunction(t))return this.each(function(e){dn(this).removeClass(t.call(this,e,W(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(oe)||[];n=this[u++];)if(i=W(n),r=1===n.nodeType&&(" "+i+" ").replace(gt," ")){for(a=0;o=e[a++];)for(;-1<r.indexOf(" "+o+" ");)r=r.replace(" "+o+" "," ");i!==(s=dn.trim(r))&&dn.attr(n,"class",s)}return this},toggleClass:function(i,t){var o=typeof i;return"boolean"==typeof t&&"string"===o?t?this.addClass(i):this.removeClass(i):dn.isFunction(i)?this.each(function(e){dn(this).toggleClass(i.call(this,e,W(this),t),t)}):this.each(function(){var e,t,n,r;if("string"===o)for(t=0,n=dn(this),r=i.match(oe)||[];e=r[t++];)n.hasClass(e)?n.removeClass(e):n.addClass(e);else i!==undefined&&"boolean"!==o||((e=W(this))&&dn._data(this,"__className__",e),dn.attr(this,"class",e||!1===i?"":dn._data(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&-1<(" "+W(n)+" ").replace(gt," ").indexOf(t))return!0;return!1}}),dn.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,n){dn.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}}),dn.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),mt=C.location,yt=dn.now(),vt=/\?/,xt=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g,dn.parseJSON=function(e){if(C.JSON&&C.JSON.parse)return C.JSON.parse(e+"");var i,o=null,t=dn.trim(e+"");return t&&!dn.trim(t.replace(xt,function(e,t,n,r){return i&&t&&(o=0),0===o?e:(i=n||t,o+=!r-!n,"")}))?Function("return "+t)():dn.error("Invalid JSON: "+e)},dn.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{C.DOMParser?t=(new C.DOMParser).parseFromString(e,"text/xml"):((t=new C.ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e))}catch(n){t=undefined}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||dn.error("Invalid XML: "+e),t},bt=/#.*$/,wt=/([?&])_=[^&]*/,Tt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ct=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Et=/^(?:GET|HEAD)$/,Nt=/^\/\//,kt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,St={},At={},Dt="*/*",jt=mt.href,Lt=kt.exec(jt.toLowerCase())||[],dn.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:jt,type:"GET",isLocal:Ct.test(Lt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Dt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":dn.parseJSON,"text xml":dn.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?z(z(e,dn.ajaxSettings),t):z(dn.ajaxSettings,e)},ajaxPrefilter:I(St),ajaxTransport:I(At),ajax:function(e,t){function n(e,t,n,r){var i,o,a,s,u,l=t;2!==w&&(w=2,d&&C.clearTimeout(d),h=undefined,f=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){for(var r,i,o,a,s=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),i===undefined&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(a in s)if(s[a]&&s[a].test(i)){u.unshift(a);break}if(u[0]in n)o=u[0];else{for(a in n){if(!u[0]||e.converters[a+" "+u[0]]){o=a;break}r||(r=a)}o=o||r}if(o)return o!==u[0]&&u.unshift(o),n[o]}(g,T,n)),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(f){return{state:"parsererror",error:a?f:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(g,s,T,i),i?(g.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(dn.lastModified[c]=u),(u=T.getResponseHeader("etag"))&&(dn.etag[c]=u)),204===e||"HEAD"===g.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?v.resolveWith(m,[o,l,T]):v.rejectWith(m,[T,l,a]),T.statusCode(b),b=undefined,p&&y.trigger(i?"ajaxSuccess":"ajaxError",[T,g,i?o:a]),x.fireWith(m,[T,l]),p&&(y.trigger("ajaxComplete",[T,g]),--dn.active||dn.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=undefined),t=t||{};var r,i,c,f,d,p,h,o,g=dn.ajaxSetup({},t),m=g.context||g,y=g.context&&(m.nodeType||m.jquery)?dn(m):dn.event,v=dn.Deferred(),x=dn.Callbacks("once memory"),b=g.statusCode||{},a={},s={},w=0,u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!o)for(o={};t=Tt.exec(f);)o[t[1].toLowerCase()]=t[2];t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?f:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return w||(e=s[n]=s[n]||e,a[e]=t),this},overrideMimeType:function(e){return w||(g.mimeType=e),this},statusCode:function(e){var t;if(e)if(w<2)for(t in e)b[t]=[b[t],e[t]];else T.always(e[T.status]);return this},abort:function(e){var t=e||u;return h&&h.abort(t),n(0,t),this}};if(v.promise(T).complete=x.add,T.success=T.done,T.error=T.fail,g.url=((e||g.url||jt)+"").replace(bt,"").replace(Nt,Lt[1]+"//"),g.type=t.method||t.type||g.method||g.type,g.dataTypes=dn.trim(g.dataType||"*").toLowerCase().match(oe)||[""],null==g.crossDomain&&(r=kt.exec(g.url.toLowerCase()),g.crossDomain=!(!r||r[1]===Lt[1]&&r[2]===Lt[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(Lt[3]||("http:"===Lt[1]?"80":"443")))),g.data&&g.processData&&"string"!=typeof g.data&&(g.data=dn.param(g.data,g.traditional)),$(St,g,t,T),2===w)return T;for(i in(p=dn.event&&g.global)&&0==dn.active++&&dn.event.trigger("ajaxStart"),g.type=g.type.toUpperCase(),g.hasContent=!Et.test(g.type),c=g.url,g.hasContent||(g.data&&(c=g.url+=(vt.test(c)?"&":"?")+g.data,delete g.data),!1===g.cache&&(g.url=wt.test(c)?c.replace(wt,"$1_="+yt++):c+(vt.test(c)?"&":"?")+"_="+yt++)),g.ifModified&&(dn.lastModified[c]&&T.setRequestHeader("If-Modified-Since",dn.lastModified[c]),dn.etag[c]&&T.setRequestHeader("If-None-Match",dn.etag[c])),(g.data&&g.hasContent&&!1!==g.contentType||t.contentType)&&T.setRequestHeader("Content-Type",g.contentType),T.setRequestHeader("Accept",g.dataTypes[0]&&g.accepts[g.dataTypes[0]]?g.accepts[g.dataTypes[0]]+("*"!==g.dataTypes[0]?", "+Dt+"; q=0.01":""):g.accepts["*"]),g.headers)T.setRequestHeader(i,g.headers[i]);if(g.beforeSend&&(!1===g.beforeSend.call(m,T,g)||2===w))return T.abort();for(i in u="abort",{success:1,error:1,complete:1})T[i](g[i]);if(h=$(At,g,t,T)){if(T.readyState=1,p&&y.trigger("ajaxSend",[T,g]),2===w)return T;g.async&&0<g.timeout&&(d=C.setTimeout(function(){T.abort("timeout")},g.timeout));try{w=1,h.send(a,n)}catch(l){if(!(w<2))throw l;n(-1,l)}}else n(-1,"No Transport");return T},getJSON:function(e,t,n){return dn.get(e,t,n,"json")},getScript:function(e,t){return dn.get(e,undefined,t,"script")}}),dn.each(["get","post"],function(e,i){dn[i]=function(e,t,n,r){return dn.isFunction(t)&&(r=r||n,n=t,t=undefined),dn.ajax(dn.extend({url:e,type:i,dataType:r,data:t,success:n},dn.isPlainObject(e)&&e))}}),dn._evalUrl=function(e){return dn.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},dn.fn.extend({wrapAll:function(t){if(dn.isFunction(t))return this.each(function(e){dn(this).wrapAll(t.call(this,e))});if(this[0]){var e=dn(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(n){return dn.isFunction(n)?this.each(function(e){dn(this).wrapInner(n.call(this,e))}):this.each(function(){var e=dn(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=dn.isFunction(t);return this.each(function(e){dn(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){dn.nodeName(this,"body")||dn(this).replaceWith(this.childNodes)}).end()}}),dn.expr.filters.hidden=function(e){return cn.reliableHiddenOffsets()?e.offsetWidth<=0&&e.offsetHeight<=0&&!e.getClientRects().length:function(e){if(!dn.contains(e.ownerDocument||tn,e))return!0;for(;e&&1===e.nodeType;){if("none"===((t=e).style&&t.style.display||dn.css(t,"display"))||"hidden"===e.type)return!0;e=e.parentNode}var t;return!1}(e)},dn.expr.filters.visible=function(e){return!dn.expr.filters.hidden(e)},Ht=/%20/g,qt=/\[\]$/,_t=/\r?\n/g,Ft=/^(?:submit|button|image|reset|file)$/i,Mt=/^(?:input|select|textarea|keygen)/i,dn.param=function(e,t){var n,r=[],i=function(e,t){t=dn.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=dn.ajaxSettings&&dn.ajaxSettings.traditional),dn.isArray(e)||e.jquery&&!dn.isPlainObject(e))dn.each(e,function(){i(this.name,this.value)});else for(n in e)X(n,e[n],t,i);return r.join("&").replace(Ht,"+")},dn.fn.extend({serialize:function(){return dn.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=dn.prop(this,"elements");return e?dn.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!dn(this).is(":disabled")&&Mt.test(this.nodeName)&&!Ft.test(e)&&(this.checked||!me.test(e))}).map(function(e,t){var n=dn(this).val();return null==n?null:dn.isArray(n)?dn.map(n,function(e){return{name:t.name,value:e.replace(_t,"\r\n")}}):{name:t.name,value:n.replace(_t,"\r\n")}}).get()}}),dn.ajaxSettings.xhr=C.ActiveXObject!==undefined?function(){return this.isLocal?V():8<tn.documentMode?U():/^(get|post|head|put|delete|options)$/i.test(this.type)&&U()||V()}:U,Ot=0,Rt={},Pt=dn.ajaxSettings.xhr(),C.attachEvent&&C.attachEvent("onunload",function(){for(var e in Rt)Rt[e](undefined,!0)}),cn.cors=!!Pt&&"withCredentials"in Pt,(Pt=cn.ajax=!!Pt)&&dn.ajaxTransport(function(l){var c;if(!l.crossDomain||cn.cors)return{send:function(e,a){var t,s=l.xhr(),u=++Ot;if(s.open(l.type,l.url,l.async,l.username,l.password),l.xhrFields)for(t in l.xhrFields)s[t]=l.xhrFields[t];for(t in l.mimeType&&s.overrideMimeType&&s.overrideMimeType(l.mimeType),l.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)e[t]!==undefined&&s.setRequestHeader(t,e[t]+"");s.send(l.hasContent&&l.data||null),c=function(e,t){var n,r,i;if(c&&(t||4===s.readyState))if(delete Rt[u],c=undefined,s.onreadystatechange=dn.noop,t)4!==s.readyState&&s.abort();else{i={},n=s.status,"string"==typeof s.responseText&&(i.text=s.responseText);try{r=s.statusText}catch(o){r=""}n||!l.isLocal||l.crossDomain?1223===n&&(n=204):n=i.text?200:404}i&&a(n,r,i,s.getAllResponseHeaders())},l.async?4===s.readyState?C.setTimeout(c):s.onreadystatechange=Rt[u]=c:c()},abort:function(){c&&c(undefined,!0)}}}),dn.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return dn.globalEval(e),e}}}),dn.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),dn.ajaxTransport("script",function(t){if(t.crossDomain){var r,i=tn.head||dn("head")[0]||tn.documentElement;return{send:function(e,n){(r=tn.createElement("script")).async=!0,t.scriptCharset&&(r.charset=t.scriptCharset),r.src=t.url,r.onload=r.onreadystatechange=function(e,t){(t||!r.readyState||/loaded|complete/.test(r.readyState))&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),r=null,t||n(200,"success"))},i.insertBefore(r,i.firstChild)},abort:function(){r&&r.onload(undefined,!0)}}}}),Bt=[],Wt=/(=)\?(?=&|$)|\?\?/,dn.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Bt.pop()||dn.expando+"_"+yt++;return this[e]=!0,e}}),dn.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Wt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Wt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=dn.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Wt,"$1"+r):!1!==e.jsonp&&(e.url+=(vt.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||dn.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=C[r],C[r]=function(){o=arguments},n.always(function(){i===undefined?dn(C).removeProp(r):C[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Bt.push(r)),o&&dn.isFunction(i)&&i(o[0]),o=i=undefined}),"script"}),dn.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||tn;var r=Z.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=g([e],t,i),i&&i.length&&dn(i).remove(),dn.merge([],r.childNodes))},It=dn.fn.load,dn.fn.load=function(e,t,n){if("string"!=typeof e&&It)return It.apply(this,arguments);var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=dn.trim(e.slice(s,e.length)),e=e.slice(0,s)),dn.isFunction(t)?(n=t,t=undefined):t&&"object"==typeof t&&(i="POST"),0<a.length&&dn.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?dn("<div>").append(dn.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},dn.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){dn.fn[t]=function(e){return this.on(t,e)}}),dn.expr.filters.animated=function(t){return dn.grep(dn.timers,function(e){return t===e.elem}).length},dn.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=dn.css(e,"position"),c=dn(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=dn.css(e,"top"),u=dn.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<dn.inArray("auto",[o,u])?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),dn.isFunction(t)&&(t=t.call(e,n,dn.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},dn.fn.extend({offset:function(t){if(arguments.length)return t===undefined?this:this.each(function(e){dn.offset.setOffset(this,t,e)});var e,n,r={top:0,left:0},i=this[0],o=i&&i.ownerDocument;return o?(e=o.documentElement,dn.contains(e,i)?("undefined"!=typeof i.getBoundingClientRect&&(r=i.getBoundingClientRect()),n=Y(o),{top:r.top+(n.pageYOffset||e.scrollTop)-(e.clientTop||0),left:r.left+(n.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):r):void 0},position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===dn.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),dn.nodeName(e[0],"html")||(n=e.offset()),n.top+=dn.css(e[0],"borderTopWidth",!0),n.left+=dn.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-dn.css(r,"marginTop",!0),left:t.left-n.left-dn.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&!dn.nodeName(e,"html")&&"static"===dn.css(e,"position");)e=e.offsetParent;return e||$e})}}),dn.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o=/Y/.test(i);dn.fn[t]=function(e){return ge(this,function(e,t,n){var r=Y(e);if(n===undefined)return r?i in r?r[i]:r.document.documentElement[t]:e[t];r?r.scrollTo(o?dn(r).scrollLeft():n,o?n:dn(r).scrollTop()):e[t]=n},t,e,arguments.length,null)}}),dn.each(["top","left"],function(e,n){dn.cssHooks[n]=j(cn.pixelPosition,function(e,t){if(t)return t=Xe(e,n),We.test(t)?dn(e).position()[n]+"px":t})}),dn.each({Height:"height",Width:"width"},function(o,a){dn.each({padding:"inner"+o,content:a,"":"outer"+o},function(r,e){dn.fn[e]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return ge(this,function(e,t,n){var r;return dn.isWindow(e)?e.document.documentElement["client"+o]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+o],r["scroll"+o],e.body["offset"+o],r["offset"+o],r["client"+o])):n===undefined?dn.css(e,t,i):dn.style(e,t,n,i)},a,n?e:undefined,n,null)}})}),dn.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),dn.fn.size=function(){return this.length},dn.fn.andSelf=dn.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return dn}),$t=C.jQuery,zt=C.$,dn.noConflict=function(e){return C.$===dn&&(C.$=zt),e&&C.jQuery===dn&&(C.jQuery=$t),dn},e||(C.jQuery=C.$=dn),dn});define("jq","init",function(){$.each2=function(r,i){var o,t,l=!0;if(r instanceof Array)o=r.length-1;else if(r)for(t in r)Object.prototype.hasOwnProperty.call(r,t)&&(o=t);return $.each(r,function(t,e){var n={first:l,last:t===o,middle:!l&&t!==o};return l&&(l=!1),i.call(r,t,e,n)})},$.fn.fastHtml=function(t){for(var e,n,r=0;e=this[r++];)1===e.nodeType&&(jQuery.cleanData(e.getElementsByTagName("*")),e.innerHTML=t,(n=$(e).find("script").toArray())&&Loader.loadScripts(n));return this},$.fn.scrollTo=function(t,e){var n,r,i,o,l,a,s,c,f;if(e=$.extend({position:"top"},e),t=$(t),i=(r=(n=this)[0]==window||n[0]==document.body||n[0]==document.documentElement)?$(window):n,o=n.offset(),l=t.offset(),o&&l){if(a=r?l.top:l.top+i.scrollTop()-o.top,"visible"==(s=e.position))if(c=r?i.scrollTop():l.top,f=r?c+$(window).innerHeight():o.top+n.innerHeight(),l.top<c)s="top";else{if(!(l.top+t.outerHeight()>f))return;s="bottom"}r?"center"==s?a-=$(window).innerHeight()/2-t.outerHeight()/2:"bottom"==s&&(a-=$(window).innerHeight()-t.outerHeight()):"center"==s?a-=n.innerHeight()/2-t.outerHeight()/2:"bottom"==s&&(a-=n.innerHeight()-t.outerHeight()),n.scrollTop(a)}return n},$.remap=function(n,t,r){var i={};return $.each(t,function(t,e){(!r||t in n)&&(i[t in n?n[t]:t]=e)}),i},$.fn.findClass=function(t){var e,n=this;return n.hasClass(t)?n:((e=n.find("."+t)).length||(e=n.parents("."+t).first()),e)},$.fn.visible=function(t){if(t===undefined)return 0<this.length&&"none"!==this[0].style.display;for(var e=0;e<this.length;++e)this[e].style.display=t?"block":"none";return this},$.fn.fontMetrics=function(t){var e,n,r=this;return t=t||"W",e=$("<span>").css({fontFamily:r.css("font-family"),fontSize:r.css("font-size"),padding:0,margin:0,opacity:0,visiblity:"hidden",wordWrap:"normal",whiteSpace:"pre",letterSpacing:"0"}).text(t),$(document.body).append(e),n={w:e.innerWidth(),h:e.innerHeight()},e.empty().remove(),n},$.fn.action=function(r,i){return r=$.trim(r).split(/\s+/),this.on("click",".js-action_link",function(t){var e=arguments,n=$(this).data("action");if(0<=$.inArray(n,r))return t.linkAction=n,i.apply(this,e)}),this},$.fn.findByPos=function(t,e){var n,r,i,o,l,a,s,c,f=this,u="x"==e,p="y"==e,h=function(t,e,n){return!!n&&(e<=t&&t<=e+n)};for(n=0,r=f.length;n<r;++n)if(o=(i=$(f[n])).offset(),l=i.outerWidth(!0),a=i.outerHeight(!0),s=p||h(t.x,o.left,l)||h(o.left,t.x,t.w),c=u||h(t.y,o.top,a)||h(o.top,t.y,t.h),s&&c&&(!t.target||i[0]!=t.target[0]))return i;return null},$.fn.scrollMonitor=function(s){!1!==s&&(s=$.extend({up:0,down:0,eventStart:"scrollStart",eventEnd:"scrollEnd",mainScroll:!1},s));var c=$(window);return this.each(function(){var o=$(this),l=s.mainScroll?c:o,a=l.scrollTop();!1===s?l.off(".scrollMonitor"):l.on("scroll.scrollMonitor",function(t){var e=l.scrollTop(),n=0<a-e,r=s.mainScroll?o.offset().top:0,i=s.mainScroll?r+o.outerHeight()-c.innerHeight():o[0].scrollHeight-o.outerHeight();!n&&e/i>=s.down?o.trigger(s.eventEnd,{maxScroll:i,curScroll:e}):n&&1-(e-r)/(i-r)>=s.up&&o.trigger(s.eventStart,{maxScroll:i,curScroll:e}),a=e})})},$.fn.typingDetect=function(t){var i=this.first(),o=".typing_detector",e=i.prop(o),l="operamobile"==Device.browser&&Device.v<=12;return t?e||(i.on("focus"+o,function(){var t,e=i.prop(o),n=i[0].value.length,r=l?i[0].value:null;e&&e.timer&&clearInterval(e.timer),t=function(){if(i[0].parentNode)if(l)r===i[0].value?i.trigger("typing"):i.trigger("blur");else{var t=i[0].value.length;n!=t&&(n=t,i.trigger("typing"))}else i.typingDetect(!1)},e.timer=setInterval(t,l?2e3:300),l&&t()}),i.on("blur"+o,function(){var t=i.prop(o);t.timer&&(clearInterval(t.timer),t.timer=null)}),i.prop(o,{}),i.is(":focus")&&i.trigger("focus")):e&&(e.timer&&clearInterval(e.timer),i.removeProp(o),i.off(o)),this},$.fn.mousewheel=function(s){function c(t){t.preventDefault(),t.stopPropagation()}var f,t,e,n,r;for(r in s=$.extend({allowTextarea:!1},s),f=/(trident|msie)/i.test(navigator.userAgent),t=document.documentElement,n={onmousewheel:"mousewheel",onwheel:"wheel",DOMMouseScroll:"DOMMouseScroll"})if(r in t){e=n[r];break}return e?this.each(function(){var a=$(this).on(e,function(t){var e,n,r=t.originalEvent,i=a[0].scrollTop,o=a[0].scrollHeight-a.outerHeight(),l=-r.wheelDelta;s.allowTextarea&&(e=document.activeElement)&&"TEXTAREA"==e.tagName.toUpperCase()||(isNaN(l)&&(l=r.deltaY),(n=l<0)&&i<=0||!n&&o<=i?c(t):f&&(n&&i<-l?(a[0].scrollTop=0,c(t)):!n&&o-i<l&&(a[0].scrollTop=o,c(t))))})}):this}});!function(a,c,t){"use strict";var r,n,s,i,u,o,h,l,p,d,m,f,g,_,y,S,v,C,b,T,w,P,O,I,x,E,A,k,M,N,j,L,R,D,U;a.PushStream||(n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=function(t){return(t<10?"0":"")+t},(r={}).dateToUTCString=function(t){var e=i(t.getUTCHours())+":"+i(t.getUTCMinutes())+":"+i(t.getUTCSeconds());return n[t.getUTCDay()]+", "+i(t.getUTCDate())+" "+s[t.getUTCMonth()]+" "+t.getUTCFullYear()+" "+e+" GMT"},u=function(){var t,e,n,s=arguments[0]||{};for(t=0;t<arguments.length;t++)for(n in e=arguments[t])e.hasOwnProperty&&!e.hasOwnProperty(n)||(s[n]=e[n]);return s},o=/^[\],:{}\s]*$/,h=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,l=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,p=/(?:^|:|,)(?:\s*\[)+/g,d=function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")},r.parseJSON=function(t){if(!t||!v(t))return null;if(t=d(t),a.JSON&&a.JSON.parse)try{return a.JSON.parse(t)}catch(e){throw"Invalid JSON: "+t}if(o.test(t.replace(h,"@").replace(l,"]").replace(p,"")))return Function("return "+t)();throw"Invalid JSON: "+t},m=function(t){var e={};return e[t.tagArgument]="",e[t.timeArgument]="",e[t.eventIdArgument]="",t.messagesControlByArgument&&(e[t.tagArgument]=+t._etag,t._lastModified?e[t.timeArgument]=t._lastModified:t._lastEventId&&(e[t.eventIdArgument]=t._lastEventId)),e},f=function(){return(new Date).getTime()},g=function(){return{_:f()}},_=function(t){var e,n=t;if("object"==typeof t){for(e in n="",t)t.hasOwnProperty&&!t.hasOwnProperty(e)||(n+="&"+e+"="+a.escape(t[e]));n=n.substring(1)}return n||""},y=function(t,e){return t+(t.indexOf("?")<0?"?":"&")+_(e)},S=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},v=function(t){return"[object String]"===Object.prototype.toString.call(t)},C=function(t){return"[object Date]"===Object.prototype.toString.call(t)},b={_getXHRObject:function(t){var e=!1;if(t){try{e=new a.XDomainRequest}catch(n){}if(e)return e}try{e=new a.XMLHttpRequest}catch(s){try{e=new a.ActiveXObject("Msxml2.XMLHTTP")}catch(i){try{e=new a.ActiveXObject("Microsoft.XMLHTTP")}catch(r){e=!1}}}return e},_send:function(e,t){var n,s,i,r,o;if((e=e||{}).timeout=e.timeout||3e4,(n=b._getXHRObject(e.crossDomain))&&e.url)return b.clear(e),e.xhr=n,a.XDomainRequest&&n instanceof a.XDomainRequest?(n.onload=function(){e.afterReceive&&e.afterReceive(n),e.success&&e.success(n.responseText)},n.onerror=n.ontimeout=function(){e.afterReceive&&e.afterReceive(n),e.error&&e.error(n.status)}):n.onreadystatechange=function(){4===n.readyState&&(b.clear(e),e.afterReceive&&e.afterReceive(n),200===n.status?e.success&&e.success(n.responseText):e.error&&e.error(n.status))},e.beforeOpen&&e.beforeOpen(n),s={},i=null,r="GET",t?(i=_(e.data),r="POST"):s=e.data||{},n.open(r,y(e.url,u({},s,g())),!0),e.beforeSend&&e.beforeSend(n),o=function(){b.clear(e);try{n.abort()}catch(t){}e.error(304)},t?n.setRequestHeader&&(n.setRequestHeader("Accept","application/json"),n.setRequestHeader("Content-type","application/x-www-form-urlencoded")):e.timeoutId=a.setTimeout(o,e.timeout+2e3),n.send(i),n},_clear_xhr:function(t){t&&(t.onreadystatechange=null)},_clear_script:function(t){t&&(t.onerror=t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t))},_clear_timeout:function(t){t.timeoutId=k(t.timeoutId)},_clear_jsonp:function(t){var e=t.data.callback;e&&(a[e]=function(){a[e]=null})},clear:function(t){b._clear_timeout(t),b._clear_jsonp(t),b._clear_script(c.getElementById(t.scriptId)),b._clear_xhr(t.xhr)},jsonp:function(e){var t,n,s,i,r,o;return e.timeout=e.timeout||3e4,b.clear(e),t=c.head||c.getElementsByTagName("head")[0],n=c.createElement("script"),s=f(),i=function(){b.clear(e);var t=f();e.error(t-s>e.timeout/2?304:403)},r=function(){b.clear(e),e.load()},o=function(){e.afterSuccess=!0,e.success.apply(null,arguments)},n.onerror=i,n.onload=n.onreadystatechange=function(t){n.readyState&&!/loaded|complete/.test(n.readyState)||(e.afterSuccess?r():i())},e.beforeOpen&&e.beforeOpen({}),e.beforeSend&&e.beforeSend({}),e.timeoutId=a.setTimeout(i,e.timeout+2e3),e.scriptId=e.scriptId||f(),e.afterSuccess=null,e.data.callback=e.scriptId+"_onmessage_"+f(),a[e.data.callback]=o,n.setAttribute("src",y(e.url,u({},e.data,g()))),n.setAttribute("async","async"),n.setAttribute("id",e.scriptId),t.insertBefore(n,t.firstChild),e},load:function(t){return b._send(t,!1)},post:function(t){return b._send(t,!0)}},T=function(t){return t?a.escape(t):""},w=function(t){return t?a.unescape(t):""},r.parseMessage=function(t,e){var n=t;return v(t)&&(n=r.parseJSON(t)),{id:n[e.jsonIdKey],channel:n[e.jsonChannelKey],text:v(n[e.jsonTextKey])?w(n[e.jsonTextKey]):n[e.jsonTextKey],tag:n[e.jsonTagKey],time:n[e.jsonTimeKey],eventid:n[e.jsonEventIdKey]||""}},P=function(t){return t.backtrack?".b"+ +t.backtrack:""},O=function(t,e){var n,s="";for(n in t)t.hasOwnProperty&&!t.hasOwnProperty(n)||(s+="/"+n+(e?P(t[n]):""));return s},I=function(t,e,n,s){var i,r,o=t.wrapper.type===L.TYPE,a=t.useSSL,c=E(a,t.port),h=o?a?"wss://":"ws://":a?"https://":"http://";return h+=t.host,h+=c?":"+c:"",h+=e,i=O(t.channels,s),t.channelsByArgument?((r={})[t.channelsArgument]=i.substring(1),n=u({},n,r)):h+=i,y(h,n)},x=function(t){var e=E(t.useSSL,t.port),n=t.useSSL?"https://":"http://";return n+=t.host,n+=e?":"+e:"",n+=t.urlPrefixPublisher,n+="?id="+O(t.channels,!1)},r.extract_xss_domain=function(t){var e,n;return t.match(/^(\d{1,3}\.){3}\d{1,3}$/)?t:(e=t.split("."),n=Math.max(e.length-1,t.match(/(\w{4,}\.\w{2}|\.\w{3,})$/)?2:3),e.slice(-1*n).join("."))},E=function(t,e){return e=+(e||(t?443:80)),!t&&80===e||t&&443===e?"":e},r.isCrossDomainUrl=function(t){var e,n,s;return!!t&&((e=c.createElement("a")).href=t,n=E("https:"===a.location.protocol,a.location.port),s=E("https:"===e.protocol,e.port),a.location.protocol!==e.protocol||a.location.hostname!==e.hostname||n!==s)},A=function(t,e){return function(){return t.apply(e,arguments)}},k=function(t){return t&&a.clearTimeout(t),null},M=function(t){var e=r.parseMessage(t.data,this.pushstream);e.tag&&(this.pushstream._etag=e.tag),e.time&&(this.pushstream._lastModified=e.time),e.eventid&&(this.pushstream._lastEventId=e.eventid),this.pushstream._onmessage(e.text,e.id,e.channel,e.eventid,!0,e.time)},N=function(){this.pushstream._onopen()},j=function(t){this._closeCurrentConnection(),this.pushstream._onerror({type:t&&("load"===t.type||"close"===t.type&&1006===t.code)||this.pushstream.readyState===U.CONNECTING?"load":"timeout"})},(L=function(t){if(!a.WebSocket&&!a.MozWebSocket)throw"WebSocket not supported";this.type=L.TYPE,this.pushstream=t,this.connection=null}).TYPE="WebSocket",L.prototype={connect:function(){var t,e;this._closeCurrentConnection(),t=u({},this.pushstream.extraParams(),g(),m(this.pushstream)),e=I(this.pushstream,this.pushstream.urlPrefixWebsocket,t,!this.pushstream._useControlArguments());try{this.connection=a.WebSocket?new a.WebSocket(e):new a.MozWebSocket(e)}catch(n){return void A(j,this)()}this.connection.onerror=A(j,this),this.connection.onclose=A(j,this),this.connection.onopen=A(N,this),this.connection.onmessage=A(M,this)},disconnect:function(){this.connection&&(this.connection.onclose=null,this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.connection){try{this.connection.close()}catch(t){}this.connection=null}},sendMessage:function(t){this.connection&&this.connection.send(t)}},(R=function(t){this.type=R.TYPE,this.pushstream=t,this.connection=null,this.opentimer=null,this.messagesQueue=[],this._linkedInternalListen=A(this._internalListen,this),this.xhrSettings={timeout:this.pushstream.timeout,data:{},url:null,success:A(this.onmessage,this),error:A(this.onerror,this),load:A(this.onload,this),beforeSend:A(this.beforeSend,this),afterReceive:A(this.afterReceive,this)}}).TYPE="LongPolling",R.prototype={connect:function(){this.messagesQueue=[],this._closeCurrentConnection(),this.urlWithBacktrack=I(this.pushstream,this.pushstream.urlPrefixLongpolling,{},!0),this.urlWithoutBacktrack=I(this.pushstream,this.pushstream.urlPrefixLongpolling,{},!1),this.xhrSettings.url=this.urlWithBacktrack,this.useJSONP=this.pushstream._crossDomain||this.pushstream.useJSONP,this.xhrSettings.scriptId="PushStreamManager_"+this.pushstream.id,this.useJSONP&&(this.pushstream.messagesControlByArgument=!0),this._listen(),this.opentimer=a.setTimeout(A(N,this),150)},_listen:function(){this._internalListenTimeout&&k(this._internalListenTimeout),this._internalListenTimeout=a.setTimeout(this._linkedInternalListen,100)},_internalListen:function(){this.pushstream._keepConnected&&(this.xhrSettings.url=this.pushstream._useControlArguments()?this.urlWithoutBacktrack:this.urlWithBacktrack,this.xhrSettings.data=u({},this.pushstream.extraParams(),this.xhrSettings.data,m(this.pushstream)),this.useJSONP?this.connection=b.jsonp(this.xhrSettings):this.connection||(this.connection=b.load(this.xhrSettings)))},disconnect:function(){this.connection&&(this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.opentimer=k(this.opentimer),this.connection){try{this.connection.abort()}catch(t){try{b.clear(this.connection)}catch(e){}}this.connection=null,this.xhrSettings.url=null}},beforeSend:function(t){this.pushstream.messagesControlByArgument||(t.setRequestHeader("If-None-Match",this.pushstream._etag),t.setRequestHeader("If-Modified-Since",this.pushstream._lastModified))},afterReceive:function(t){this.pushstream.messagesControlByArgument||(this.pushstream._etag=t.getResponseHeader("Etag"),this.pushstream._lastModified=t.getResponseHeader("Last-Modified")),this.connection=null},onerror:function(t){this._closeCurrentConnection(),this.pushstream._keepConnected&&(304===t?this._listen():this.pushstream._onerror({type:403===t||this.pushstream.readyState===U.CONNECTING?"load":"timeout"}))},onload:function(){this._listen()},onmessage:function(t){var e,n,s,i;for(this._internalListenTimeout&&k(this._internalListenTimeout),e=null,n=S(t)?t:t.replace(/\}\{/g,"}\r\n{").split("\r\n"),s=0;s<n.length;s++)n[s]&&(e=r.parseMessage(n[s],this.pushstream),this.messagesQueue.push(e),this.pushstream.messagesControlByArgument&&e.time&&(this.pushstream._etag=e.tag,this.pushstream._lastModified=e.time));for(this._listen();0<this.messagesQueue.length;)i=this.messagesQueue.shift(),this.pushstream._onmessage(i.text,i.id,i.channel,i.eventid,0===this.messagesQueue.length,i.time)}},D=[],(U=function(t){var e,n;for(t=t||{},this.id=D.push(this)-1,this.useSSL=t.useSSL||!1,this.host=t.host||a.location.hostname,this.port=+(t.port||(this.useSSL?443:80)),this.timeout=t.timeout||3e4,this.pingtimeout=t.pingtimeout||3e4,this.reconnectOnTimeoutInterval=t.reconnectOnTimeoutInterval||3e3,this.reconnectOnChannelUnavailableInterval=t.reconnectOnChannelUnavailableInterval||6e4,this.autoReconnect=!1!==t.autoReconnect,this.lastEventId=t.lastEventId||null,this.messagesPublishedAfter=t.messagesPublishedAfter,this.messagesControlByArgument=t.messagesControlByArgument||!1,this.tagArgument=t.tagArgument||"tag",this.timeArgument=t.timeArgument||"time",this.eventIdArgument=t.eventIdArgument||"eventid",this.useJSONP=t.useJSONP||!1,this._reconnecttimer=null,this._etag=0,this._lastModified=null,this._lastEventId=null,this.urlPrefixPublisher=t.urlPrefixPublisher||"/pub",this.urlPrefixStream=t.urlPrefixStream||"/sub",this.urlPrefixEventsource=t.urlPrefixEventsource||"/ev",this.urlPrefixLongpolling=t.urlPrefixLongpolling||"/lp",this.urlPrefixWebsocket=t.urlPrefixWebsocket||"/ws",this.jsonIdKey=t.jsonIdKey||"id",this.jsonChannelKey=t.jsonChannelKey||"channel",this.jsonTextKey=t.jsonTextKey||"text",this.jsonTagKey=t.jsonTagKey||"tag",this.jsonTimeKey=t.jsonTimeKey||"time",this.jsonEventIdKey=t.jsonEventIdKey||"eventid",this.modes=(t.modes||"eventsource|websocket|stream|longpolling").split("|"),this.wrappers=[],this.wrapper=null,this.onchanneldeleted=t.onchanneldeleted||null,this.onmessage=t.onmessage||null,this.onerror=t.onerror||null,this.onstatuschange=t.onstatuschange||null,this.extraParams=t.extraParams||function(){return{}},this.channels={},this.channelsCount=0,this.channelsByArgument=t.channelsByArgument||!1,this.channelsArgument=t.channelsArgument||"channels",this._crossDomain=r.isCrossDomainUrl(x(this)),e=0;e<this.modes.length;e++)try{switch(n=null,this.modes[e]){case"websocket":n=new L(this);break;case"longpolling":n=new R(this)}this.wrappers[this.wrappers.length]=n}catch(s){}this.readyState=0}).LOG_LEVEL="error",U.LOG_OUTPUT_ELEMENT_ID="Log4jsLogOutput",U.CLOSED=0,U.CONNECTING=1,U.OPEN=2,U.prototype={addChannel:function(t,e){if(T(t)!==t)throw"Invalid channel name! Channel has to be a set of [a-zA-Z0-9]";if("undefined"!=typeof this.channels[t])throw"Cannot add channel "+t+": already subscribed";e=e||{},this.channels[t]=e,this.channelsCount++,this.readyState!==U.CLOSED&&this.connect()},removeChannel:function(t){this.channels[t]&&(delete this.channels[t],this.channelsCount--)},removeAllChannels:function(){this.channels={},this.channelsCount=0},_setState:function(t){this.readyState!==t&&(this.readyState=t,this.onstatuschange&&this.onstatuschange(this.readyState))},connect:function(){var t,e,n;if(!this.host)throw"PushStream host not specified";if(isNaN(this.port))throw"PushStream port not specified";if(!this.channelsCount)throw"No channels specified";if(0===this.wrappers.length)throw"No available support for this browser";if(this._keepConnected=!0,this._lastUsedMode=0,t=c.cookie.match(/lpm=([^\s;]+)/))for(n in e=decodeURIComponent(t[1]),this.wrappers)if(this.wrappers[n].type==e){this._lastUsedMode=n;break}this._connect()},disconnect:function(){this._keepConnected=!1,this._disconnect(),this._setState(U.CLOSED)},_useControlArguments:function(){return this.messagesControlByArgument&&(null!==this._lastModified||null!==this._lastEventId)},_connect:function(){var t,e;null===this._lastEventId&&(this._lastEventId=this.lastEventId),null===this._lastModified&&(t=this.messagesPublishedAfter,C(t)||(0<(e=+this.messagesPublishedAfter)?(t=new Date).setTime(t.getTime()-1e3*e):e<0&&(t=new Date(0))),C(t)&&(this._lastModified=r.dateToUTCString(t))),this._disconnect(),this._setState(U.CONNECTING),this.wrapper=this.wrappers[this._lastUsedMode++%this.wrappers.length];try{this.wrapper.connect()}catch(n){this.wrapper&&this.wrapper.disconnect()}},_disconnect:function(){this._reconnecttimer=k(this._reconnecttimer),this.wrapper&&this.wrapper.disconnect()},_onopen:function(){this._reconnecttimer=k(this._reconnecttimer),this._setState(U.OPEN),0<this._lastUsedMode&&(this._lastUsedMode--,-1==c.cookie.indexOf("hws=1")&&this.wrapper.type!=L.TYPE&&(c.cookie="lpm="+encodeURIComponent(this.wrapper.type)+"; path=/; domain=."+base_domain()+"; expires="+new Date(2038,1,1).toUTCString())),this.wrapper.type==L.TYPE&&(c.cookie="hws=1; path=/; domain=."+base_domain()+"; expires="+new Date(2038,1,1).toUTCString())},_onclose:function(){this._reconnecttimer=k(this._reconnecttimer),this._setState(U.CLOSED),this._reconnect(this.reconnectOnTimeoutInterval)},_onmessage:function(t,e,n,s,i,r){-2===e?this.onchanneldeleted&&this.onchanneldeleted(n):0<e&&this.onmessage&&this.onmessage(t,e,n,s,i,r)},_onerror:function(t){this._setState(U.CLOSED),this._reconnect("timeout"===t.type?this.reconnectOnTimeoutInterval:this.reconnectOnChannelUnavailableInterval),this.onerror&&this.onerror(t)},_reconnect:function(t){this.autoReconnect&&this._keepConnected&&!this._reconnecttimer&&this.readyState!==U.CONNECTING&&(this._reconnecttimer=a.setTimeout(A(this._connect,this),t))},sendMessage:function(t,e,n){t=T(t),this.wrapper.type===L.TYPE?(this.wrapper.sendMessage(t),e&&e()):b.post({url:x(this),data:t,success:e,error:n,crossDomain:this._crossDomain})}},U.sendMessage=function(t,e,n,s){b.post({url:t,data:T(e),success:n,error:s})},U.register=function(t){var e=t.window.location.href.match(/streamid=([0-9]*)&?/);e[1]&&D[e[1]]&&D[e[1]].wrapper.register(t)},U.unload=function(){for(var t=0;t<D.length;t++)try{D[t].disconnect()}catch(e){}},a.PushStream=U,a.PushStreamManager=D,a.attachEvent&&a.attachEvent("onunload",U.unload),a.addEventListener&&a.addEventListener.call(a,"unload",U.unload,!1))}(window,document);define("sound","init",function(){function i(e){if(e){var n=e.match(/[\d]+/g);return+(n[0]+"."+n[1])}return 0}function A(){var e,n=0;if(navigator.plugins&&navigator.plugins.length)n=i((e=navigator.plugins["Shockwave Flash"])&&e.description);else if(navigator.mimeTypes&&navigator.mimeTypes.length)n=i((e=navigator.mimeTypes["application/x-shockwave-flash"])&&e.enabledPlugin&&e.enabledPlugin.description);else try{n=i(new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version"))}catch(t){}return 9<=n}function P(t,e,i){if(t.addEventListener)return each(e,function(e,n){i?t.addEventListener(n,e,!1):t.removeEventListener(n,e)}),i?function(){P(t,e,!1)}:void 0}var _,D,E={},x=0,F=0,O=0,e=navigator.userAgent,I=/(ipad|iphone|ipod)/i.test(e),R=/android\s2\.3/i.test(e),n=e.match(/safari/i)&&!e.match(/chrome/i),U=!n&&!e.match(/silk/i)&&e.match(/OS X 10_6_([3-7])/i),t=function(t){function i(){return!y||D==p}function e(){var t,i,e;if(d(),++O,p||m||(y=h),c){if(!p&&y&&(_=c,D=p),i=function(e){w?(x=0,s.duration!=c.duration&&(e||.3<c.duration)&&(s.duration=c.duration,u("durationChange")),s.currentTime!=c.currentTime&&(s.currentTime=c.currentTime,u("timeUpdate"))):c.duration&&"firefox"==Device.browser&&"desktop"!=Device.type&&t()},P(c,l={play:function(){w&&(s.playing=!0,u("play"))},pause:function(){w&&(s.playing=!1,u("pause"))},canplay:t=function(e){if(!w){n(!1);try{c.currentTime=s.currentTime||(m?0:.01)}catch(e){}c.volume=k/100,c.muted=!1,m&&c.flashSync(),a(s.playing)}},canplaythrough:t,loadeddata:i,loadedmetadata:i,durationchange:i,timeupdate:i,progress:function(e){if(i(),e.loaded&&e.total&&e.loaded==e.total&&t(),0<c.buffered.length){var n=c.buffered.end(c.buffered.length-1);s.duration=c.duration,s.buffered=n/c.duration,u("buffer",{pct:s.buffered})}},ended:function(){i(!0),w&&(s.ended=!0,u("ended"))},error:function(e){var n,t,i;if(w&&Math.abs(s.duration-s.currentTime)<1&&0<s.duration)return s.ended=!0,void u("ended");t=["",n=L(" "),n,L(" "),"Invalid source"],i=e&&e.target&&c.error?"#"+c.error.code+":"+(t[c.error.code]||n):m&&e||n,T||(T=!0,console.error("AUDIO ERROR ["+x+"]: "+i+" "+c.src),x<=4?(w=!1,setTimeout(function(){var e=s.playing;s.load(f),a(e)},500*x),++x):u("error",i))}},!0),m?P(c,{flashInit:function(){u("ready")}},!0):u("ready"),b=!0,g.length)for(e=0;e<g.length;++e)s.ready(g[e])}else u("unsupported")}function a(e){if(e&&function(){if(y&&D!=p){var e=s.currentTime,n=E[D];n&&n._unbind(),D=p,P(c,l,!0),r(f),s.setPosition(e)}}(),w){if(c.paused==e)try{e?c.play():c.pause()}catch(n){console.error(n)}}else S||o(),s.playing!=!!e&&u(e?"play":"pause");s.playing=!!e}function r(e){return f=e,n(!(S=T=!1)),c.src=e,c.autobuffer="auto",c.preload="auto",t.autoLoad&&o(),s}function o(){c.load(),S=!0,u("loadStart")}function u(e,n){e="on"+e.substr(0,1).toUpperCase()+e.substr(1);try{t[e]&&t[e].call(s,n)}catch(n){console.error(n)}}function n(e){e||w||u("loadEnd"),(w=!e)||d()}function d(){s.ended=s.playing=!1,s.buffered=s.duration=s.currentTime=0}var c,f,l,s=this,p=F++,h=!("desktop"==Device.type||I||R),y=!1,m=!1,g=[],v=!1,b=!1,T=!1,w=!1,S=!1,k=100;E[p]=s,extend(s,{load:function(e){return i()?r(e):f=e,s},isSingle:function(){return y},play:function(){return a(!0),s},pause:function(){return a(!1),s},stop:function(){return s.setPosition(0),a(!1),m&&c.flashSync(),s},destroy:function(){v||(i()&&P(c,l,!1),y&&1!=O||(m?c.flashDestory():(c.muted=!0,c.pause(),c.src="about:blank"),delete E[p],_=D=undefined),c=t=l=null,--O,v=!0)},setVolume:function(e){k=e,i()&&(c.volume=k/100,m&&c.flashSync())},setPosition:function(e){try{i()&&(c.currentTime=e,m&&c.flashSync()),s.currentTime=e}catch(n){}},_unbind:function(){P(c,l,!1),s.playing&&u("pause"),a(!1),u("buffer",{pct:s.buffered=0}),w=!1},ready:function(e){b?e&&e.call(s,s):g.push(e)}}),t=extend({autoLoad:!1},t),!(c=_||function(){var e;if(U&&!A()||!document.cookie.match(/audio_force_flash=1/)||!A()){try{e=window.Audio?new Audio:ce("audio")}catch(n){e=window.Audio?new Audio(null):ce("audio")}e&&e.canPlayType&&e.canPlayType("audio/mpeg").replace(/no/,"")||(e=!1)}return e}())&&A()?require("sound_flash",function(){c=new FlashAudio({autoLoad:t.autoLoad}),m=!0,e()}):e()};window.SpacesSound=t});define("lp","init",function(){var n=0,r=0,s=!1,o=!1;window.Spaces=window.Spaces||{},Spaces.PushStream=Class({Extends:PushStream,Static:{create:function(e){return new Spaces.PushStream(extend({timeout:3e4,useSSL:"https:"==location.protocol,modes:navigator.userAgent.match(/firefox/i)?"longpolling":"websocket|longpolling",useJSONP:!0,messagesControlByArgument:!1,urlPrefixLongpolling:"/lpex",autoReconnect:!1},e))}},Constructor:function(){var t=this;t.callbacks={message:{},connect:{},disconnect:{},error:{}},PushStream.apply(t,arguments),t.onmessage=t._onMessage,t.onerror=function(e){this._trigger("error",arguments)},t.onstatuschange=function(e){switch(e){case PushStream.CLOSED:console.error("[LP] disconnected ("+t.wrapper.type+"), time: ",(new Date).toUTCString()),t._trigger("disconnect",[]),++n,t.doReconnect(),s=!1;break;case PushStream.OPEN:console.info("[LP] connected ("+t.wrapper.type+"), time: ",(new Date).toUTCString()),t._trigger("connect",[{first:Date.now()-SPACES_LOAD_START<=15e3}]),r=Date.now(),s=!0;break;case PushStream.CONNECTING:console.debug("[LP] start connecting, time: ",(new Date).toUTCString()),t._trigger("connecting",[])}}},doReconnect:function(){var e,t=this;t.avail()||o||(e=1e3,s&&2e4<=Date.now()-r&&(n=1),50<n?e=6e4:20<n?e=3e4:15<n?e=15e3:10<n?e=5e3:5<n&&(e=3e3),setTimeout(function(){t.avail()||t._connect()},e))},avail:function(){return this.readyState==PushStream.OPEN},addMessageHandler:function(e,t){return this.on("message",e,t)},deleteMessageHandler:function(e){return this.off("message",e)},_onMessage:function(){n=0,this._trigger("message",arguments)},disable:function(){return o=!0,this.disconnect(),this},disabled:function(){return o},on:function(e,t,n){return this.callbacks[e][t]=n,this},off:function(n,e){var t=this;return e===undefined?each(t.callbacks,function(e,t){delete e[n]}):delete t.callbacks[n][e],t},_trigger:function(e,t){var n,r,s=this;for(n in s.callbacks[e])if(r=s.callbacks[e][n])try{r.apply(s,t)}catch(o){console.error("PushStream handler ("+e+", "+n+") error:",o.message,o.stack?"\n"+o.stack:o)}else s.off(e,n)},start:function(){this.readyState==PushStream.CLOSED&&this.connect()}})});var cookie={get:function(e,o){var n=cookie.all()[e];return n===undefined?o:n},set:function(e,o,n){!(n=extend({path:"/",expires:0,secure:!1,domain:"."+base_domain(location.host)},n)).expires||n.expires instanceof Date||(n.expires=new Date(+new Date+864e5*n.expires));var t=encodeURIComponent(e)+"="+encodeURIComponent(o);return n.expires&&(t+="; expires="+n.expires.toUTCString()),n.domain&&(t+="; domain="+n.domain),n.path&&(t+="; path="+n.path),n.secure&&(t+="; secure"),document.cookie=t,this},all:function(){var e,o,n,t;if(""==document.cookie)return{};for(e=document.cookie.split(";"),o={},n=0;n<e.length;++n)" "==(t=e[n].split("="))[0].charAt(0)&&(t[0]=t[0].substr(1)),o[decodeURIComponent(t[0])]=t[1]!==undefined?decodeURIComponent(t[1]):"";return o},enabled:function(){var e="ololo_"+Date.now();return!!cookie.set(e,1).get(e)&&(cookie.remove(e),!0)},remove:function(e){return cookie.set(e,"",{expires:-1})}};define("config","init",function(){window.Spaces=window.Spaces||{},Spaces.config={support:{name:L("Support"),what:L(""),addr:"/soo/support"}}});define("android/api","init",function(){Device.android_app&&(cookie.get("android_api_test")&&(window.prompt=console.log,window.SpacesApp.params.nativeMusicPlayer=!0),$.extend(window.SpacesApp,{toggleSidebar:function(e){Loader.loaded("sidebar")&&Sidebar.toggle(e)},on:function(e,o){return this["on"+e.substr(0,1).toUpperCase()+e.substr(1)]=o,this},loadPage:function(e){return!(!window.page_loader||!window.page_loader.ok())&&window.page_loader.loadPage({url:e})},exec:function(e,o){return window.prompt(e,JSON.stringify(o||{}))}}))});function find_var(e,t){var r,_=t.split("."),R=e;if(R)for(r=0;r<_.length;++r)if(!(R=R[_[r]]))return null;return R}define("spaces","init",function(){window.Spaces=window.Spaces||{},function(_,N){var l,E,t,a,e,p=6e4,R=/(\w+)\.(\d+)\.(\d+)/,r=Device.can("sessionStorage"),c=["#nid","#type","gid","content","preview","shareCnt","commentsCnt","download","share","gif","image","commentsLink","#adult","like","reposted","resolution","parent","#extType","#showMotivator"];if(0<=document.cookie.indexOf("scope_leak_test=1"))for(e in _._keys_={},_)_._keys_[e]=1;N.referer=document.referer,N.DEBUG=0<=document.cookie.indexOf("spaces_debug=1"),E={COMMON:{code:0,SUCCESS:0,ERR_NEED_CAPTCHA:1,ERR_UNKNOWN_METHOD:2,ERR_USER_NOT_FOUND:3,ERR_WRONG_CAPTCHA_CODE:4,ERR_EMPTY_MESSAGE:5,ERR_UNKNOWN_ERROR:6,ERR_OFTEN_OPERATION:7,ERR_WRONG_CK:8,ERR_SMS_NOT_SEND:9,ERR_UNKNOWN_ERROR_PLEASE_RETRY:10,ERR_FORBIDDEN:11,ERR_BAD_REQUEST:12,ERR_NEED_CONFIRM_ACTION:13,ERR_USER_IN_YOUR_BLACKLIST:14,ERR_YOU_IN_USER_BLACKLIST:15,ERR_MESSAGE_TOO_LONG:16,ERR_MESSAGE_WITH_UNPAID_STICKERS:17,ERR_GCM:18,ERR_USER_ACT_PHONE_NOT_FOUND:19,ERR_OBJECT_NOT_FOUND:20,ERR_USER_IS_OWNER:21,ERR_COMM_NOT_FOUND:22,ERR_WRONG_EMAIL:23,ERR_WRONG_PHONE:24,ERR_USER_IS_BLOCKED:25,ERR_USER_IS_FROZEN:26,ERR_APP_NOT_FOUND:27,ERR_WML:28,ERR_ADULT_CONTENT:29,ERR_SPAM_CONTROL:30,ERR_WRONG_OWNER:31,ERR_NOT_ENOUGH_KARMA:32,ERR_SMALL_RATE:33,ERR_URL_NOT_FOUND:34,ERR_YOU_ARE_BANNED:35,ERR_CANCEL_CAPTCHA:9999},AUTH:{code:1,ERR_AUTH_REQUIRED:1001,ERR_EMPTY_LOGIN_OR_PASSWORD:1002,ERR_WRONG_LOGIN_OR_PASSWORD:1003,ERR_SESSION_NOT_FOUND:1004,ERR_USER_MODEL_NOT_CONSTRUCTED:1005,ERR_AUTH_ERROR:1006,ERR_ALREADY_LOGGED_IN:1007,ERR_ACTIVATION_REQUIRED:1008},MAIL:{code:2,ERR_CONTACT_NOT_FOUND:2001,ERR_MESSAGE_ERROR:2002,ERR_SPAM_CONTROL:2003,ERR_ADMIN_SEND_DENIED:2004,ERR_GARBAGE_IS_CLEARING:2005,ERR_CONTACT_IS_SWAPPING:2006,ERR_MESSAGE_NOT_FOUND:2007,ERR_WRONG_EMAIL_FORMAT:2008,ERR_MESSAGE_SEND_DENIED:2009,ERR_DUP_MESSAGE:2010,ERR_WRONG_PHONE_FORMAT:2011,ERR_TOO_LARGE_ATTACHES_WEIGHT:2012,ERR_SPAMING_INNER_CONTACT:2013,ERR_TALK_NOT_FOUND:2014},REG:{code:3,ERR_WRONG_CONTACT:3001,ERR_CONTACT_ALREADY_USED:3002,ERR_CONTACT_ALREADY_REGISTERED:3003,ERR_IP_LIMIT_EXCEEDED:3004},FRIENDS:{code:4,ERR_HIS_LIMIT_EXCEEDED:4001,ERR_YOUR_LIMIT_EXCEEDED:4002,ERR_OFFER_EXISTS:4003,ERR_ALREADY_FRIENDS:4004,ERR_OFFER_BLOCKED:4005,ERR_FRIEND_NOT_FOUND:4006,ERR_PENDING_NOT_FOUND:4007,ERR_FROM:4008,ERR_EMAIL_USED:4009,ERR_INVITE_EXISTS:4010},CHAT:{code:5,ERR_ATTACH_SEND_DENIED:5001,ERR_ROOM_NOT_FOUND:5002,ERR_CONTACT_DENIED:5003,ERR_BANNED:5004,ERR_NEWBIE:5005,ERR_FORBIDDEN:5006,ERR_SHUTUP:5007,ERR_MESSAGE_PARAMS:5008,ERR_SPAM:5009,ERR_DUP_MESSAGE:5010,ERR_COMPLAIN:5011,ERR_MESSAGE_NOT_FOUND:5012,ERR_USER_ISNT_FRIEND:5013},FORUM:{code:6,ERR_COMMENT_NOT_FOUND:6001,ERR_TOPIC_NOT_FOUND:6002,ERR_FORUM_NOT_FOUND:6003,ERR_FORUM_IN_GARBAGE:6004},TRASH:{code:7,ERR_OBJ_DELETED:7001,ERR_OBJ_RESTORED:7002},VOTING:{code:8,ERR_VOTE_NOT_FOUND:8001},FILES:{code:9,ERR_DIR_ACCESS_DENIED:9001,ERR_FILE_NOT_FOUND:9002,ERR_RESOLUTION_NOT_AVAILABLE:9003,ERR_WRONG_SIZE:9004,ERR_BAD_VIDEO_CONVERTER_KEY:9005,ERR_UPLOAD_ERROR:9006,ERR_WRONG_TYPE:9008,ERR_DIR_NOT_FOUND:9009,ERR_WRONG_TEMP_ID:9010,ERR_STRANGER_FILE:9011,ERR_EDIT:9012,ERR_CANT_LOAD_PIC:9013,ERR_COLLECTION_NOT_FOUND:9015,ERR_YOUR_FILE:9016,ERR_YOUR_COLLECTION:9017},SEARCH:{code:10,ERR_BAD_QUERY:10001},LENTA:{code:11,ERR_SUBSCR_NOT_FOUND:11001,ERR_AUTHOR_IS_PRIVATE_GROUP:11002,ERR_SUBSCR_ALREADY_EXISTS:11003},GIFTS:{code:12,ERR_GIFT_NOT_FOUND:12001},SERVICES:{code:13,ERR_COUNTRY_NOT_FOUND:13001,ERR_REGION_NOT_FOUND:13002,ERR_CITY_NOT_FOUND:13003,ERR_UNIVERSITY_NOT_FOUND:13004,ERR_FACULTY_NOT_FOUND:13005,ERR_MOBILE_BRAND_NOT_FOUND:13006,ERR_GHOST_NOT_FOUND:13007,ERR_GHOST_UNCHANGED:13008},COMPLAINTS:{code:14,ERR_WRONG_TYPE:14001,ERR_WRONG_REASON:14002,ERR_COMPLAIN_DENIED:14003,ERR_COMPLAINTS_EXIST:14004,ERR_TIME_EXCEED:14005,ERR_CNT_EXCEED:14006},BLACKLIST:{code:15,ERR_WRONG_TYPE:15001,ERR_OBJECT_NOT_FOUND:15002,ERR_SPAM_CONTROL:15003},POLLS:{code:16,ERR_POLL_EXIST:16001,ERR_ACCESS_DENIED:16002,ERR_WRONG_OWNER:16003,ERR_WRONG_END_TIME:16004,ERR_WRONG_VARIANT:16005,ERR_VARIANTS_CNT:16006,ERR_POLL_ISNT_VALIDATE:16007,ERR_POLL_NOT_FOUND:16008,ERR_SMALL_RATE:16009,ALREADY_VOTED:16010,ERR_VOTING:16011},ATTACHES:{code:17,ERR_ATTACH_NOT_FOUND:17001,ERR_TYPE_ISNT_SUPPORTED:17002,ERR_PARENT_NOT_FOUND:17003,ERR_ATTACH_ALREADY_EXIST:17004,ERR_WRONG_OWNER:17005,ERR_MAX_COUNT:17006,ERR_CHECK_ATTACH:17007},COMM:{code:18,ERR_BLOCKED:18001,ERR_ACCESS_DENIED:18002},COMMENTS:{code:19,ERR_INVALID:19001,ERR_NOT_FOUND:19002,ERR_EDIT_TIME:19003}},_.Codes=E,a=mkhash([[E.COMMON.ERR_USER_NOT_FOUND,L("  ")],[E.COMMON.ERR_WRONG_CAPTCHA_CODE,L("   ")],[E.COMMON.ERR_NEED_CAPTCHA,L("   ")],[E.COMMON.ERR_CANCEL_CAPTCHA,L("    ,  .")],[E.COMMON.ERR_EMPTY_MESSAGE,L(" ")],[E.COMMON.ERR_OFTEN_OPERATION,L("  ")],[E.COMMON.ERR_WRONG_CK,L("  !  CK!      {0}",'<a href="'+N.config.support.addr+'">'+N.config.support.name+"</a>")],[E.COMMON.ERR_SMS_NOT_SEND,L("SMS   ")],[E.COMMON.ERR_UNKNOWN_ERROR_PLEASE_RETRY,L(" , ")],[E.COMMON.ERR_FORBIDDEN,L(" ")],[E.COMMON.ERR_BAD_REQUEST,L(" ")],[E.COMMON.ERR_NEED_CONFIRM_ACTION,L("  ")],[E.COMMON.ERR_USER_IN_YOUR_BLACKLIST,L("     ")],[E.COMMON.ERR_YOU_IN_USER_BLACKLIST,L("     ")],[E.COMMON.ERR_MESSAGE_TOO_LONG,L("  ")],[E.COMMON.ERR_MESSAGE_WITH_UNPAID_STICKERS,L("    ")],[E.COMMON.ERR_USER_ACT_PHONE_NOT_FOUND,L("   ")],[E.COMMON.ERR_OBJECT_NOT_FOUND,L("  ")],[E.COMMON.ERR_USER_IS_OWNER,L(" -  ")],[E.COMMON.ERR_COMM_NOT_FOUND,L("  ")],[E.COMMON.ERR_WRONG_EMAIL,L(" e-mail")],[E.COMMON.ERR_FREQ_LIMITER,L("  .     .")],[E.COMMON.ERR_WRONG_PHONE,L("  ")],[E.COMMON.ERR_USER_IS_BLOCKED,L(" ")],[E.COMMON.ERR_APP_NOT_FOUND,L("  ")],[E.COMMON.ERR_USER_IS_FROZEN,L(" ")],[E.COMMON.ERR_YOU_ARE_BANNED,L("     ")],[E.AUTH.ERR_EMPTY_LOGIN_OR_PASSWORD,L("   ")],[E.AUTH.ERR_WRONG_LOGIN_OR_PASSWORD,L("   ")],[E.MAIL.ERR_CONTACT_NOT_FOUND,L("  ")],[E.MAIL.ERR_SPAM_CONTROL,L("   ")],[E.MAIL.ERR_ADMIN_SEND_DENIED,L(",         .      .")],[E.MAIL.ERR_GARBAGE_IS_CLEARING,L("  ")],[E.MAIL.ERR_CONTACT_IS_SWAPPING,L("  ")],[E.MAIL.ERR_MESSAGE_NOT_FOUND,L("  ")],[E.MAIL.ERR_WRONG_EMAIL_FORMAT,L("  E-mail")],[E.MAIL.ERR_DUP_MESSAGE,L("      ")],[E.MAIL.ERR_WRONG_PHONE_FORMAT,L("  ")],[E.MAIL.ERR_TOO_LARGE_ATTACHES_WEIGHT,L("      10")],[E.MAIL.ERR_SPAMING_INNER_CONTACT,L("     E-mail .")],[E.FRIENDS.ERR_HIS_LIMIT_EXCEEDED,L("      .")],[E.FRIENDS.ERR_YOUR_LIMIT_EXCEEDED,L("      .")],[E.FRIENDS.ERR_OFFER_EXISTS,L("   ")],[E.FRIENDS.ERR_ALREADY_FRIENDS,L("  ")],[E.FRIENDS.ERR_OFFER_BLOCKED,L("     .")],[E.FRIENDS.ERR_FRIEND_NOT_FOUND,L("   ")],[E.FRIENDS.ERR_PENDING_NOT_FOUND,L("     ")],[E.FRIENDS.ERR_INVITE_EXISTS,L("  ")],[E.CHAT.ERR_ATTACH_SEND_DENIED,L("   ")],[E.CHAT.ERR_ROOM_NOT_FOUND,L("  ")],[E.CHAT.ERR_CONTACT_DENIED,L(" ")],[E.CHAT.ERR_BANNED,L(" ")],[E.CHAT.ERR_NEWBIE,L("      ")],[E.CHAT.ERR_FORBIDDEN,L("      ")],[E.CHAT.ERR_SHUTUP,L("        ")],[E.CHAT.ERR_MESSAGE_PARAMS,L("   ")],[E.CHAT.ERR_SPAM,L("  !     !")],[E.CHAT.ERR_DUP_MESSAGE,L("       ")],[E.CHAT.ERR_MESSAGE_NOT_FOUND,L("  ")],[E.CHAT.ERR_USER_ISNT_FRIEND,L("       !")],[E.FORUM.ERR_COMMENT_NOT_FOUND,L("  ")],[E.FORUM.ERR_TOPIC_NOT_FOUND,L("  .")],[E.FORUM.ERR_FORUM_IN_GARBAGE,L("   .")],[E.FRIENDS.ERR_FROM,L("  ")],[E.FRIENDS.ERR_EMAIL_USED,L(",    ,  ")],[E.TRASH.ERR_OBJ_DELETED,L("  ")],[E.TRASH.ERR_OBJ_RESTORED,L("  ")],[E.VOTING.ERR_VOTE_NOT_FOUND,L("  ")],[E.FILES.ERR_DIR_ACCESS_DENIED,L("   ")],[E.FILES.ERR_FILE_NOT_FOUND,L("  ")],[E.FILES.ERR_WRONG_SIZE,L("  ")],[E.FILES.ERR_COLLECTION_NOT_FOUND,L("  ")],[E.FILES.ERR_CANT_LOAD_PIC,L("    .")],[E.LENTA.ERR_SUBSCR_NOT_FOUND,L("  ")],[E.LENTA.ERR_AUTHOR_IS_PRIVATE_GROUP,L(" -  ")],[E.LENTA.ERR_SUBSCR_ALREADY_EXISTS,L("  ")],[E.GIFTS.ERR_GIFT_NOT_FOUND,L("  ")],[E.COMPLAINTS.ERR_WRONG_TYPE,L(" ")],[E.COMPLAINTS.ERR_WRONG_REASON,L(" ")],[E.COMPLAINTS.ERR_COMPLAIN_DENIED,L("       ,    ,     ")],[E.COMPLAINTS.ERR_COMPLAINTS_EXIST,L("      -    ")],[E.BLACKLIST.ERR_WRONG_TYPE,L("  , -     ")],[E.BLACKLIST.ERR_OBJECT_NOT_FOUND,L("  ")],[E.SERVICES.ERR_COUNTRY_NOT_FOUND,L("  ")],[E.SERVICES.ERR_REGION_NOT_FOUND,L("  ")],[E.SERVICES.ERR_CITY_NOT_FOUND,L("  ")],[E.SERVICES.ERR_UNIVERSITY_NOT_FOUND,L("  ")],[E.SERVICES.ERR_FACULTY_NOT_FOUND,L("  ")],[E.SERVICES.ERR_MOBILE_BRAND_NOT_FOUND,L("  ")],[E.ATTACHES.ERR_ATTACH_NOT_FOUND,L(",   ,  . ")],[E.ATTACHES.ERR_PARENT_NOT_FOUND,L(",      ,  .")],[E.ATTACHES.ERR_WRONG_OWNER,L(",     ,  .")],[E.ATTACHES.ERR_MAX_COUNT,L("  .")],[E.ATTACHES.ERR_CHECK_ATTACH,L("   .")],[E.COMMENTS.ERR_NOT_FOUND,L(",    ,  .")]]),$.extend(N,{api_cache:{},cache:{},global:{},setTimeout:setTimeout,setInterval:setInterval,lastActivity:Date.now(),windowActive:!0,SIDEBAR:{MIN_WIDTH:900},AUTH_ERRORS:{1:L(" "),2:L("  "),3:L("  "),4:L("  "),5:L(" XSRF"),6:L(" . "),7:L("   "),8:L(" ")},KEYS:{ESC:27,PGDOWN:34,PGUP:33,HOME:36,END:35,UP:38,DOWN:40,RIGHT:39,LEFT:37,ENTER:10,MAC_ENTER:13,ALT:18},PREVIEW:{SIZE_81_80:14},SHOW_PREVIEW_RE:/^(gif|jpg|jpeg|png|bmp|avi|mpg|mp4|m4v|mpeg|asf|wmv|3gp|3gpp|flv|mov|wevm)$/i,LongPollingTypes:{NOTIFICATION_SEND:20,TOP_COUNTER_UPDATE:21,VIDEO_CONVERT:25,REFRESH_WIDGETS:26,COMM_COUNTER_UPDATE:27,SETTINGS:28,BIND_EMAIL_RESULT:29,CHAT_SEND_MESSAGE:32,CHAT_DELETE_MESSAGE:33,MAIL_MESSAGE_RECEIVE:1,MAIL_CONTACT_READ:2,MAIL_CONTACT_SWAP:4,MAIL_CONTACT_ERASE:5,MAIL_CONTACT_ARCHIVE:6,MAIL_CONTACT_SPAM:7,MAIL_CLEAR_GARBAGE:8,MAIL_MESSAGE_FAV:9,MAIL_MESSAGE_SWAP:10,MAIL_MESSAGE_ERASE:11,MAIL_TYPING:24,MAIL_MESSAGE_SEND:18,MAIL_TALK_MEMBER_ADD:36,MAIL_TALK_MEMBER_DELETE:37,MAIL_TALK_MEMBER_LEAVE:38,MAIL_TALK_MEMBER_RETURN:39,LOADED_FILE:34,STATUS_CHANGE:35,COMMENT_ADD:40,COMMENT_DELETE:41,KARMA_CHANGED:42,DEVICE_TYPE_CHANGE:44,LOGOUT:30,UOBJ_RECOMMENDATIONS_UPDATE:45},TYPES:{FILE:5,MUSIC:6,PICTURE:7,FORUM_TOPIC:8,DIARY_TOPIC:9,COMM:10,USER:11,VIDEO:25,COMM_DIARY_TOPIC:49,MAIL_TALK:79,EXTERNAL_VIDEO:82},FILES_LIST:{DIRS:1,FILES:2,NEW_FILES:4,POPULAR_ALLTIME:5,POPUlAR_NOW:6,POPULAR_MONTH:14,FILES_SORT_POPULAR:7,FILES_ALL:23},RENDER_MODE:{PREVIEW:-1,TILE:-4,CAROUSEL:-8},WIDGETS:{HEADER:1,SIDEBAR:2,FOOTER:4,CSS:8,RIGHTBAR:16},SettingsTypes:{SOUND_NOTIFY_BLOCK:1,FORM_SUBMIT_KEY:2,USER_NAME:4,AVATAR:5},LIMIT:{ATTACHES:3},ExternalVideo:{YOUTUBE:1},makeZbs:function(){var e,t;for(e=0;e<4;++e)(t=$("."+N.params.ac+e)).add(t.children("div")).each(function(){var e=$(this);e.attr("force-hidden")||"none"!=e.css("display")||e.attr("style","display: /*"+Date.now()+"*/ block /*"+Date.now()+"*/ !important")})},CK:function(){return N.sid().substr(-4)},init:function(){var t,r;N.params=_.SPACES_PARAMS,"operamini"!=Device.browser&&tick(function(){var e=N.persistModules();0<e.length&&require(e)}),/(spaces_js_debug=1|sandbox=)/i.test(document.cookie)&&(N.onError=function(e,t,r,_){if(!(0<=t.indexOf("yandex.ru"))){var R=e+(t?" at "+(t||"{main}")+(r!==undefined?":"+r+(_!==undefined?":"+_:""):""):"");N.notifications&&N.notifications.showNotification(R,"error",{silent:!0})}}),N.PushStream&&N.params.lp&&(pushstream=N.PushStream.create({host:N.params.lp.host,port:N.params.lp.port}),N.params.lp.ch?(pushstream.addChannel(N.params.lp.ch),$(_).load(function(){setTimeout(function(){pushstream.start()},16)}),t=Date.now(),setTimeout(r=function(){var e=Date.now()-t;e<3e4?setTimeout(r,3e4-e):pushstream.start()},3e4),N.DEBUG&&pushstream.on("message","spaces_debug",function(e){console.debug("[LP]",e)}),pushstream.on("message","spacesLib",function(e){e.act==N.LongPollingTypes.LOGOUT&&e.data.session_ctime==N.params.sid&&pushstream.disable()})):alert(L(" ! LP ID    !"))),"operamini"!=Device.browser&&(require("clock"),N.params.nid&&require("online_status"),"desktop"==Device.type&&require("hot_info")),N.view.sidebar(),$(function(){(N.makeZbs(),N.core.check(!1),"operamini"!=Device.browser)&&($("body").on("click.form_submit",'input[type="submit"], button',function(e){if(this.form)this.form.submit_btn=this;else{var t=$(this).parents("form")[0];t&&((this.form=t).submit_btn=this)}}).on("click",".js-pagenav_toggle",function(e){e.preventDefault();var t=$(this);t.parents(".pgn").find(".table__nums").toggleClass("hide"),t.toggleClass("pgn__button_press"),t.children().toggleClass("pgn__link_hover")}).on("click mouseup",function(){N.lastActivity=Date.now()}).on("blurwindow",function(){N.windowActive=!1}).on("focuswindow",function(){N.windowActive=!0}),"desktop"==Device.type&&require("ctrl_enter"))})},api_req_cnt:0,api_requests:{},cancelApi:function(e){var t=N.api_requests[e];t&&(N.api_requests[e]=!1,t.abort&&t.abort())},api:function(r,e,_,R){var t,E,a,n,i,o,s,c,O;return e=e||{},R=extend({cache:!1,prefix:"api",cacheTime:!1,disableChecks:!1,disableCaptcha:!1,GET:{},_rid:Date.now()+N.api_req_cnt++},R),document.cookie.indexOf("sid=")<0&&(e.sid=N.sid()),0==r.indexOf("/")||0==r.indexOf("http")?t=r:(0<=r.indexOf("/")&&(r=(E=r.split("/",2))[1],R.prefix=E[0]),E=r.split("."),t="/"+R.prefix+"/"+E[0],E.shift(),E.length&&(e.method=E.join(".")),a=R.GET||{},R.cache||(a._=N.api_req_cnt),t+=l.buildQuery(a,"&","?")),e._origin=location.protocol+"//"+location.host,e.CK!==undefined&&null===e.CK&&(e.CK=N.CK()),n=l.buildQuery(e),i=!1,o={method:r,params:e,callback:_,opts:R},s=function(e){if(R.captchaCallback&&R.captchaCallback(),"object"!=typeof e){if("string"==typeof e)try{e=$.parseJSON(e)}catch(t){e=null}if(!e)return void N.defaultAjaxErrorCallback({status:-666},o)}N.api_requests[R._rid]&&(R.cache&&!i&&(N.api_cache[r+"?"+n]={data:e,time:Date.now(),expire:1e3*R.cacheTime}),N.defaultAjaxCallback(e,o)&&(delete N.api_requests[R._rid],_&&_(e,o)))},R.cache&&(c=N.api_cache[r+"?"+n])&&c.data&&(!c.expire||Date.now()-c.time<c.expire)?(i=!0,N.api_requests[R._rid]={},s(c.data),R._rid):(O={},(!N.windowActive||Date.now()-N.lastActivity>p)&&(O["X-Unactive-Tab"]=1),R._response?s(R._response):N.api_requests[R._rid]=$.ajax(t,{method:"POST",headers:{},data:n,headers:O}).success(s).fail(function(e){R.captchaCallback&&R.captchaCallback(),N.defaultAjaxErrorCallback(e,o)}),R._rid)},defaultAjaxCallback:function(r,_){if(r.code!==undefined&&(r.$code=r.code,r.code=parseInt(r.code,10),.5<r.t&&console.warn(_.method+" ("+r.t+" s)\n"+l.buildQuery(_.params))),!_.opts.disableChecks){if(r.code==E.AUTH.ERR_AUTH_REQUIRED)return location.reload(),!1;if(r.code==E.AUTH.ERR_AUTH_ERROR&&3!=r.auth_errror)return 8==r.auth_errror||7==r.auth_errror?page_loader.reload():location.reload(),!1}return _.opts.disableCaptcha||r.code!=E.COMMON.ERR_NEED_CAPTCHA&&r.code!=E.COMMON.ERR_WRONG_CAPTCHA_CODE?(r.css_files&&Loader.loadCSS(r.css_files,!0),!0):(console.log("[captcha] req_id="+_.opts._rid),require("global_captcha",function(){var e;N.api_requests[_.opts._rid]&&(r.code==E.COMMON.ERR_WRONG_CAPTCHA_CODE&&(e=N.apiError(r)),N.view.showCaptcha(_.opts._rid,r.captcha_url,function(e,t){if(N.api_requests[_.opts._rid]){if(!1===e)return _.opts.captchaCallback=!1,_.opts.disableCaptcha=!0,(_.opts._response=r).code=E.COMMON.ERR_CANCEL_CAPTCHA,void N.api(_.method,_.params,_.callback,_.opts);_.opts.captchaCallback=t,_.params.image_code=e,_.params.captcha_code=e,N.api(_.method,_.params,_.callback,_.opts)}},e))}),!1)},defaultAjaxErrorCallback:function(e,t){if(N.api_requests[t.opts._rid]){if(console.log("[API ERROR] "+t.method+": "+e.status),t.opts.retry&&0==e.status)return--t.opts.retry,void setTimeout(function(){N.api(t.method,t.params,t.callback,t.opts)},1e3);delete N.api_requests[t.opts._rid],t.opts.onError&&t.opts.onError(N.getHttpError(e.status))}},apiError:function(e){var t,r,_,R;if(e.http_error)return N.getHttpError(e.http_error);if(e.error)return e.error;if(e.auth_errror&&N.AUTH_ERRORS[e.auth_errror])return N.AUTH_ERRORS[e.auth_errror];if(t=parseInt(e.code,10),a[t])return a[t];switch(t){case E.COMMON.ERR_NOT_ENOUGH_KARMA:return e.message||L(" .");case E.COMMON.ERR_WML:case E.COMMON.ERR_UNKNOWN_ERROR:return e.message||L(" ");case E.AUTH.ERR_AUTH_ERROR:return N.AUTH_ERRORS[e.auth_errror]||L("  #{0}",e.auth_errror);case E.AUTH.ERR_ACTIVATION_REQUIRED:return L(",    {0},   {2}  {3}.        ,   {1}.",e.action||" ",'<a href="'+N.config.support.addr+'">'+N.config.support.name+"</a>",'<a href="'+N.getActivationLink()+'">',"</a>");case E.MAIL.ERR_MESSAGE_ERROR:return e.message;case E.MAIL.ERR_MESSAGE_SEND_DENIED:return e.can_write_error.message;case E.FILES.ERR_UPLOAD_ERROR:return e.httpCode?N.getHttpError(e.httpCode):e.errMsg?e.errMsg:L("  ");case E.BLACKLIST.ERR_SPAM_CONTROL:return L("     . <br /> ,    {0}   {1}. ,        .  Spaces   .",e.action,e.time_left);default:for(r in E)if(_=E[r])for(R in _)if("code"!==R&&+_[R]==+e.code)return r+"."+R+" ("+(e.$code||e.code)+")";return L("  #{0}",e.$code||e.code)}},getHttpError:function(e){switch(e=parseInt(e)){case 501:case 502:case 503:case 504:return L("!  {0}      !<br />     . ",N.params.Domain)+(502==e&&ge("#sandbox_indicator")?"<br />("+L(",  ")+")<br />":"");case-666:return L("  API. ");case 500:case 525:return L("!    ,    !<br />   , ,   ,      {0} {1}<br /> ,    ,   ,      ,    . <br />        !<br />",N.config.support.what,'<a href="'+N.config.support.addr+'">'+N.config.support.name+"</a>");case-500:return L("!    ,    !<br />   , ,   ,       {0} {1}<br /> ,    ,   ,      ,    . <br />        !<br />",N.config.support.what,'<a href="'+N.config.support.addr+'">'+N.config.support.name+"</a>");case 413:return L("    . ");case 404:return L(" URL  . ");case 0:return L(" .     . ");default:return L("      HTTP: {code}",{code:e})}},clearError:function(e,t){if(e=e||"common_error",t)var r=$("#"+e).fadeOut(600,function(){r.remove()});else $("#"+e).remove()},clearErrors:function(){$("#siteContent").find(".js-alert_message").remove()},showError:function(e,t,r){r=$.extend({type:"alert",close:!0,classes:{alert:"system-message_alert",info:"system-message_service",warn:""},onRetry:!1,hideTimeout:0,scroll:!0},r),t=t||r.id||"common_error",$("#"+t).remove();var _=$(N.templates.notification({classes:r.classes[r.type],text:e,close:r.close,retry:!!r.onRetry}));return _.attr("id",t).find(".js-notif_close").click(function(){return N.clearError(t),!1}),_.find(".js-retry").click(function(e){e.preventDefault(),r.onRetry()}),ge("#Gallery")&&r.gallery?GALLERY.showNotif(e):($("#main_content").prepend(_),r.scroll&&$("html, body").scrollTop(0)),r.hideTimeout&&setTimeout(function(){N.clearError(t,!0)},r.hideTimeout),_},showMsg:function(e,t){return t=$.extend({type:"info"},t),N.showError(e,!1,t)},showApiError:function(e,t,r){return N.showError(N.apiError(e),t,r)},getHumanSize:function(e){return 1073741824<=e?L("{0} ",+(e/1024/1024/1024).toFixed(1)):1048576<=e?L("{0} ",+(e/1024/1024).toFixed(1)):1024<=e?L("{0} ",+(e/1024).toFixed(1)):L("{0} ",e)},getFileType:function(e){return/^(avi|mpg|mp4|m4v|mpeg|asf|wmv|3gp|3gpp|flv|mov|webm|mpe)$/.test(e=((e=e||"")+"").toLowerCase())?N.TYPES.VIDEO:/^(gif|jpg|jpeg|bmp|png)$/.test(e)?N.TYPES.PICTURE:/^(mp3|aac|amr|mp3|midi)$/.test(e)?N.TYPES.MUSIC:N.TYPES.FILE},getFileIcon:function(e){var t,r,_;return e=(e+"").toLowerCase(),(t=N.getFileType(e))==N.TYPES.VIDEO?"video":t==N.TYPES.MUSIC?"mp3":t==N.TYPES.PICTURE?"pic":(r={"txt|doc|docx|pdf|fb2":"txt",apk:"apk",jar:"jar","sis|sisx":"sis","exe|xap|cab":"exe","dmg|ipa":"apple","zip|gz|tar|7z|xz|bz|rar":"zip"},_="bin",$.each(r,function(e,t){if(RegExp("/^("+e+")$/i"))return _=t,!1}),_)},redirect:function(e,t){e!==undefined&&null!==e&&!1!==e||(e=location.href),page_loader.ok()&&page_loader.loadPage({url:e,routerData:t})||location.assign(e)},thumb:function(e,t,r){return e.replace(R,"$1."+t+"."+r)},getActivationLink:function(){return N.prepareLink("/registration/?link_id=::link_id::")},prepareLink:function(e,t){if("string"!=typeof e)return"";t=t||{};var r=N.params.link_id;return e.replace(/::CK::/g,N.CK()).replace(/::sid::/g,"").replace(/::link_id::/gi,t.link_id||r)},prepareLinks:function(e,t){var r,_,R;"length"in e||(e=[e]);for(r=0;r<e.length;++r)for(_=e[r].getElementsByTagName("a"),R=0;R<_.length;++R)_[R].href=N.prepareLink(_[R].href,t)},sid:function(){var e,t=cookie.get("sid");return t||(e=location.search.match(/sid=(\d+)/))&&(t=e[1]),t},persistModules:function(e){if(r){var t=JSON.parse(_.sessionStorage.preload_modules||"[]");return $.inArray(e,t)<0&&e&&(t.push(e),_.sessionStorage.preload_modules=JSON.stringify(t)),t}return[]},registerModuleEvent:function(e,t,r){N["$"+e+":"+t]=r}}),N.view={getFormSubmitter:function(e){var t=$(document.activeElement);return t.length&&e.has(t)&&t.is('input[type="submit"], button')?t:e[0].submit_btn?$(e[0].submit_btn):null},updateAvatars:function(){$(".js-my_avatar img").attr("src",N.params.avatar)},pageNav:{get:function(){return $(".pgn").first()},replace:function(e){return $(".pgn-wrapper").first().empty().append(e)}},pushWidget:function(e,t){var r=t?"widgets_pcontainer":"widgets_container",_=$("#"+r);_.length||(_=$('<div id="'+r+'" class="relative">'),$(t?"#content_wrap_move":"#main").prepend($('<div id="'+r+'_wrap">').append(_))),_.append(e)},sidebar:function(){$(_).on("resize orientationchange",function(){"none"==$("#sidebarOverlay").css("display")&&$("body").hasClass("openSidebar")&&Sidebar.toggle(!1)})},hasInputError:function(e,t){var r=e.parents(".js-input_error_wrap").last();return r.length||(r=e.parent().parent()),r.hasClass("error__item")},setInputError:function(e,t){var r,_=e.parents(".js-input_error_wrap").last(),R=_.find(".js-input_error:first");_.length||(_=e.parent().parent()),R.length||(R=_.find(".error__msg")),r="error__item "+(_.data("inner")?"content-bl_wrap":"our_error__item")+(_.hasClass("form__item")?" form__item_error":""),!1!==t?(_.hasClass("pdb")&&(_.data("has_pdb",!0),_.removeClass("pdb")),e.hasClass("text-input")&&e.addClass("text-input_error"),_.addClass(r),t?(R.length||(R=$("<div>",{"class":"error__msg js-input_error"}).insertAfter(e.parent())),R.removeClass("hide").html(t)):R.addClass("hide"),e.trigger("inputError",{error:t})):(e.hasClass("text-input")&&e.removeClass("text-input_error"),_.removeClass(r),R.addClass("hide"),_.data("has_pdb")&&_.addClass("pdb"),_.removeData("has_pdb"),e.trigger("inputErrorHide",{error:t})),Loader.loaded("ddmenu")&&N.DdMenu.fixSize()},onlyAuthMotivator:function(){return'<div class="t_center">'+L(",      .")+"<br />"+L("  ")+' <a href="/registration/" class="inl-link link-blue">'+L("")+' <span class="ico ico_arr"></span></a></div>'}},N.PREVIEW_TO_CLASS=mkhash([[N.PREVIEW.SIZE_81_80,"s81_80"]]),N.templates={notification:function(e){return'<div class="js-alert_message nl service-info '+e.classes+'">'+(e.close?'<a href="'+e.close+'" class="tdn right"><span class="ico ico_remove js-notif_close"></span></a>':"")+e.text+(e.retry?' <a href="'+e.close+'" class="tdn nl js-retry">'+L("")+"</a>":"")+"</div>"}},N.tools={formHidden:function(e,t,r){var _=e.find('input[name="'+t+'"]');null===r?_.remove():_.length?_.val(r):e.append($("<input>",{type:"hidden",name:t,value:r}))}},N.services={processingCodes:function(e){return N.apiError(e)},pageReload:function(e){page_loader.ok()?page_loader.loadPage({url:document.location.href,state:e?null:history.state,history:!1,scroll:!0}):location.reload()}},N.File={getMeta:function(e){var t,r,_,R,E,a,n,i,o,s;if(e instanceof jQuery&&(t=e.findClass("gview_link")).length&&(e=t),(e=e[0]||e)&&(r={el:e,link:e.href},_=e.getAttribute("g"),R=e.getAttribute("d")||"",_)){for(E=_.split("|"),a=0,n=c.length;a<n;++a)i=c[a],o=E[a],"#"==i.substr(0,1)&&(i=i.substr(1),o=+o||0),r[i]=o;return r.gif&&(r.gif=r.download),r.commentsLink||(r.commentsLink=r.link),r.resolution&&(s=r.resolution.split("x"),r.size=[+s[0],+s[1]]),r.description=R,r.partial=!r.preview,r}}},N.core={extractFile:function(e){var t,r={nid:e.data("nid"),type:e.data("type"),weight:e.data("weight"),name:html_wrap(e.data("name")||"unknown.ext"),previewURL:e.find("img").prop("src")};return(t=N.File.getMeta(e))&&(r.nid=t.nid,r.type=t.type,r.preview={URL:t.link,shareCnt:t.shareCnt,group:t.gid,commentCnt:t.commentCnt,downloadLink:t.download,showLink:t.image,previewURL:t.preview}),e.prop("href")&&!r.URL&&(r.URL=e.prop("href")),N.core.fixFile(r)},fixFile:function(e,t,r){var _,R;if(!e.type&&e.preview&&e.preview.type&&(e.type=e.preview.type),e.type||(e.type=t),!e.nid){if(!e.id)return console.error("File without id",e),!1;e.nid=e.id}if(e.filename&&(e.filename=e.filename.replace(/[\r\n]/g," ")),e.type==N.TYPES.EXTERNAL_VIDEO){if(e.fileext="",!e.filename){if(!e.name)return console.error("File without name",e),!1;e.filename=e.name}}else if((!e.filename||!e.fileext)&&e.name)if(e.name=e.name.replace(/[\r\n]/g," "),_=e.name.match(/^(.*?)\.([^\.]+)$/im),e.type!=N.TYPES.MUSIC||_&&_[2]&&/^mp3|aac$/im.test(_[2])){if(!_)return console.error("File without name",e),!1;e.filename=_[1],e.fileext=_[2]}else e.filename=e.name,e.fileext="mp3";return r&&e.preview&&e.thumbLink&&(e.preview.previewURL=e.thumbLink),!e.URL&&e.preview&&e.preview.URL&&(e.URL=e.preview.URL),e.name||(e.name=e.filename+"."+e.fileext),!e.URL&&e.redirect_link&&(e.URL=e.redirect_link),e.URL||((R={})[N.TYPES.MUSIC]="/music/",R[N.TYPES.PICTURE]="/pictures/",R[N.TYPES.FILE]="/files/",R[N.TYPES.VIDEO]="/video/",e.URL=new l(R[e.type]+"?read="+e.nid,!0).url()),e.show_preview=e.preview&&(e.type==N.TYPES.EXTERNAL_VIDEO||e.type==N.TYPES.VIDEO||e.type==N.TYPES.PICTURE||N.SHOW_PREVIEW_RE.test(e.fileext)),e.extType=N.getFileType(e.fileext),e},check:function(){var e=$("#sidebar_wrap").find(".js-my_avatar, .user_avatar");0<e.length&&(N.params.mysite_link=_.mysite_link=e.parents("a").attr("href"),N.params.avatar=e.find("img").attr("src"))}},N.LocalStorage={get:function(e,t){try{if("localStorage"in _&&e in _.localStorage)return _.localStorage[e]}catch(r){}return t},set:function(e,t){try{"localStorage"in _&&(_.localStorage[e]=t)}catch(r){}return this},remove:function(e){try{"localStorage"in _&&_.localStorage.removeItem(e)}catch(t){}return this},support:function(){var e=this,t="spaces_test";return e.supported===undefined&&(e.set(t,t),e.supported=e.get(t,!1)===t,e.remove(t)),e.supported}},l=Class({Constructor:function(e,t){e=e||"",this.parse(e,t)},Static:{controllers:{chat:"main",musicat:"index",files:"main",pictures:"main",video:"main",music:"main"},regexp:/^(([a-z0-9_.-]+\:)?(\/\/([^\/#\?@:]+))?(:\d+)?)?([^\?#]+)?(\?[^#]*)?(#.*)?$/i,onlyHashChanged:function(e,t){return!(!e||!t)&&("string"==typeof e&&(e=new l(e)),"string"==typeof t&&(t=new l(t)),(0<e.hash.length||0<t.hash.length)&&e.isSame(t))},parseQuery:function(e){var t,r,_,R,E,a;for("?"==e.charAt(0)&&(e=e.substr(1)),t={},r=e.split(/&amp;|&|;/),_=0;_<r.length;++_)E=null,-1!=(a=r[_].indexOf("="))?(R=l.decode(r[_].substr(0,a)),E=l.decode(r[_].substr(a+1))):(R=l.decode(r[_]),E=null),R.length&&(t[R]!==undefined?t[R]instanceof Array?t[R].push(E):t[R]=[t[R],E]:t[R]=E);return t},decode:function(e){return decodeURIComponent(e.replace(/%([^a-f0-9]{1,2}|$)/gi,"%25").replace(/\+/g," "))},encode:function(e){return"boolean"==typeof e?e?1:0:encodeURIComponent(e).replace(/%2F/g,"/")},buildQuery:function(e,t,r){var _,R,E=!0,a="";for(_ in t=t||"&",r=r||"",e)if(e[_]!==undefined)if(e[_]instanceof Array)for(R=0;R<e[_].length;++R)a+=(E?r:t)+encodeURIComponent(_)+"="+l.encode(e[_][R]),E&&(E=!1);else a+=(E?r:t)+encodeURIComponent(_)+"="+l.encode(e[_]),E&&(E=!1);return a},serializeForm:function(e,t){var r,_,R,E,a,n=t||{};for(e instanceof jQuery&&(e=e[0]),r=e.elements,"form"!=e.tagName.toLowerCase()&&(r=$(e).find("textarea, input, button, select")),_=0,R=r.length;_<R;++_)a=(E=r[_]).type.toLowerCase(),E.name.length&&("radio"!=a&&"checkbox"!=a||E.checked)&&("submit"!=a||E==e.submit_btn)&&(n[E.name]!==undefined?(n[E.name]instanceof Array||(n[E.name]=[n[E.name]]),n[E.name].push(E.value)):n[E.name]=E.value);return n}},parse:function(e,t){var r=this,_=e.match(l.regexp)||[];return r.scheme=_[2]||"",r.domain=_[4]||"",r.port=_[5]||"",r.path=_[6]||"",r.query=_[7]||"",r.hash=_[8]||"",t&&r._mergeWithCurrent(),r.domain=r.domain.toLowerCase(),r.scheme=r.scheme.substr(0,r.scheme.length-1).toLowerCase(),r.port=r.port.substr(1),r.query=r.query.substr(1),r.hash=r.hash.substr(1),r.query=l.parseQuery(r.query),r},isSame:function(e){return this.url(!0)===e.url(!0)},_mergeWithCurrent:function(){var e=this,t=_.location;return e.scheme.length||(e.scheme=t.protocol,e.domain.length||(e.domain=t.hostname,e.path.length?"/"!=e.path.substr(0,1)&&(e.path=t.pathname+("/"==t.pathname.substr(t.pathname.length-1)?"":"/")+e.path):(e.path=_.location.pathname,e.query.length||(e.query=t.search,e.hash.length||(e.hash=t.hash))))),e},val:function(e){return this.query[e]instanceof Array?this.query[e][0]:this.query[e]},merge:function(e){var t=this;return t.scheme.length||(t.scheme=e.scheme,t.domain.length||(t.domain=e.domain,t.path.length?"/"!=t.path.substr(0,1)&&(t.path=e.path+("/"==e.path.substr(e.path.length-1)?"":"/")+t.path):(t.path=e.path,$.isEmptyObject(t.query)&&(t.query=$.extend({},e.query),t.hash.length||(t.hash=e.hash))))),t},url:function(e){var t=this,r="";return t.scheme.length&&(r+=t.scheme+":"),(t.domain.length||t.port.length)&&(r+="//",t.domain.length&&(r+=t.domain),t.port.length&&(r+=":"+t.port)),t.path.length&&(r+=t.path),$.isEmptyObject(t.query)||(r+=l.buildQuery(t.query,"&","?")),t.hash.length&&!e&&(r+="#"+t.hash),r},toString:function(){return this.url()},clone:function(){return(new l).merge(this)},parseDomain:function(){var e,t={domain:this.domain,sub_domain:"",sub_domains:[],base_domain:""};return(e=this.domain.match(/((.*?)\.|^)([^\.]+\.[^\.]+)$/))&&(e[2]!==undefined&&(t.sub_domain=e[2].toLowerCase(),t.sub_domains=t.sub_domain.split(".")),e[3]!==undefined&&(t.base_domain=e[3].toLowerCase())),t},route:function(){var e,t,r=this,_=r.trimPath(),R="",E="";return _=_.substr(1,_.length-2),r.query.r&&(e=r.query.r.match(/^([\d\w_]+)\/([\d\w_]+)$/))?(R=e[1],E=e[2]):2==(t=_.split("/")).length?(_=t[0],R=l.controllers[_]||_,E=t[1]):3==t.length&&(_=t[0],R=t[1],E=t[2]),{prefix:_,controller:R,action:E,r:R?R+"/"+E:""}},trimPath:function(){var e,t=this;return 0==t.path.length?"/":"/"==(e=t.path.replace(/[\/]+/g,"/"))[e.length-1]?e:e+"/"}}),_.Url=l,t=Class({Static:{instances:{},instance:function(e){return this.instances[e]||(this.instances[e]=new t(e)),this.instances[e]}},Constructor:function(e){this.id=e},start:function(e,t){var r,_,R,E=this,a=N.LocalStorage.support(),n=cookie.enabled();if(E.ipc_interval&&(E.callback&&E.callback(E.sub_id),E.stop()),E.sub_id=t,E.callback=e,r=""+Date.now(),a)_="ipc:singleton:"+E.id,R="ipc:singleton:"+E.id+":alive",N.LocalStorage.set(_,r);else{if(!n)return;_="_"+E.id,cookie.set(_,r)}E.ipc_interval=setInterval(function(){var e=!1;a?(N.LocalStorage.get(R)!=r&&N.LocalStorage.set(R,r),N.LocalStorage.get(_)!=r&&(e=!0)):cookie.get(_)!=r&&(e=!0),e&&(E.callback&&E.callback(E.sub_id),E.stop(t))},1e3)},stop:function(e){var t=this;!t.ipc_interval||e&&t.sub_id!=e||(clearInterval(t.ipc_interval),t.sub_id=t.callback=t.ipc_interval=null)}}),_.IPCSingleton=t,N.init()}(window,Spaces)});define("clock","init",function(){function e(){var e,t,n,a,i,c=$("#user_time");return c.length&&!c.data("clocked")&&(e=c.text(),t=o||new Date,a=60*+(n=e.match(/(\d+):(\d+)/))[1]+ +n[2],i=60*t.getHours()+t.getMinutes(),u=0,5<Math.abs(a-i)&&(u=6e4*(a-i)),c.data("clocked",!0),t.getTimezoneOffset()),o=null,0<c.length}function n(){var e=Date.now(),t=new Date(e+u);$("#user_time").text(pad(t.getHours(),2)+":"+pad(t.getMinutes(),2)),i=Math.max(1e3*Math.min(c,60-t.getSeconds()-5),0),a=setTimeout(n,i)}if("operamini"!=Device.browser){var a,i,c=30,o=new Date(SPACES_LOAD_START),u=0;$(function(){e()&&n()}),Spaces.Clock={check:function(){a&&clearTimeout(a),e()&&n()}}}});define("ajaxify","init",function(){var m,w,e,c=/^\/(p\/|m\/|f\/|v\/|advertise|neoapi|api|capcha\/|captcha\/|i\/|js\/|css\/|\w{2}\/[a-f0-9]{32})/i,r=/(\s|^)(no_ajax)(\s|$)/,u=/^br|aquatika|bratva|bt|drako|farma|ferma|gbn|generals|gfarm|gonki|hata|heroes|li|looters|mdog|millioner-online|mt|naemniki|nazone|nebomobi|redline|sb|vi|vkletke|voindorog|voyna|wartank|wekings$/,E=["reklama","sidebar_reklama","rightbar_reklama","rightbar_app","widgets.partners"],t=function(){return'<div id="ajax_loader" style="display: none"><div class="ajax-loader__cancel" id="ajax_cancel"><span class="ico ico_remove"></span></div></div>'},T=REVISION,o=document.createElement("a"),x=0,D=function(e){var t,a,r,o,n,i,s,l,c,u=[],d={hidden:1,reset:1,file:1,image:1,buttom:1,submit:1},p=e.getElementsByTagName("form");for(t=0;t<p.length;++t){for(a={id:p[t].getAttribute("id"),name:p[t].getAttribute("name"),radios:{},texts:{},checkboxes:{},selects:{}},r=p[t],o=0;o<r.elements.length;++o)if(i="INPUT"!=(n=r.elements[o]).tagName?n.tagName:n.type.toLowerCase(),"INPUT"!=n.tagName||!d[i])if("SELECT"==i)if(a.selects[n.name]===undefined&&(a.selects[n.name]=[]),n.multiple){for(s={},l=n.getElementsByTagName("option"),c=0;c<l.length;++c)s[l[c].value]=l[c].selected;a.selects[n.name].push(s)}else a.selects[n.name].push(n.value);else"radio"==i?n.checked&&(a.radios[n.name]=n.value):"checkbox"==i?(a.checkboxes[n.name]===undefined&&(a.checkboxes[n.name]={}),a.checkboxes[n.name][n.value]=n.checked):(a.texts[n.name]===undefined&&(a.texts[n.name]=[]),a.texts[n.name].push(n.value));u.push(a)}return u},C=function(e,t){var a,r,o,n,i,s,l,c,u,d,p,f,m,_,h,g=e.getElementsByTagName("form"),v={},b=0;for(a=0;a<g.length;++a)o=(r=g[a]).getAttribute("id"),n=r.getAttribute("name"),v[o?"#"+o:n?":"+n:b++]=r;for(i=function(e,t,a,r){var o,n,i;if(e!==undefined)for(e.length===undefined&&(e=[e]),o={hidden:1,reset:1,file:1,image:1,buttom:1,submit:1,radio:1,checkbox:1},n=0;n<e.length;++n)i="INPUT"!=e[n].tagName?e[n].tagName:e[n].type.toLowerCase(),(":text"!=t||o[i])&&i!=t||a!==undefined&&null!==a&&a!=e[n].value||r(e[n])},a=b=0;a<t.length;++a)if(r=v[(s=t[a]).id?"#"+s.id:s.name?":"+s.name:b++]){for(l in s.selects)for(c=0,u=r.getElementsByTagName("select"),d=0;d<u.length&&(p=u[d],s.selects[l][c]!==undefined);++d)if("object"==typeof s.selects[l][c]){for(f=p.getElementsByTagName("option"),m=0;m<f.length;++m)f[m].selected=!!s.selects[l][c][f[m].value];c++}else for(f=p.getElementsByTagName("option"),_=!1,m=0;m<f.length;++m)(f[m].selected=!_&&f[m].value==p.value)&&(_=!1);for(l in s.radios)i(r.elements[l],"radio",null,function(e){e.checked=e.value==s.radios[l]});for(l in s.checkboxes)i(r.elements[l],"checkbox",null,function(e){e.checked=!!s.checkboxes[l][e.value]});for(l in s.texts)h=0,i(r.elements[l],":text",null,function(e){s.texts[l][h]!==undefined&&(e.value=s.texts[l][h++])})}},d=function(){function r(e){a(),document.domain=location.host.toString().match(/[a-zA-Z-_\d]+\.[a-zA-Z-_\d]+\.?$/)[0];var t="iframe_xhr_transport";-1<navigator.userAgent.indexOf("MSIE 7")?l=document.createElement('<iframe src="javascript:false;" name="'+t+'">'):((l=document.createElement("iframe")).src="javascript:false;",l.name=t),l.style.display="none",l.id=t,"string"==typeof e&&(l.src=e),document.body.appendChild(l),d=!(u=!1)}function s(e,t,a){!0!==a&&!1!==a||(a=+a),a!==undefined&&e.appendChild(i(t,a))}function i(e,t){var a=document.createElement("input");return a.type="hidden",a.name=e,a.value=t,a}function a(){if(c&&(c.parentNode.removeChild(c),c=null),l){if(!d){try{l.stop()}catch(e){}try{l.execCommand("stop")}catch(e){}try{l.contentWindow.document.execCommand("stop")}catch(e){}l.src="javascript:false;"}l.parentNode.removeChild(l),l=null}}function e(e){a(),d=!1,setTimeout(function(){t.always&&t.always(),t.error&&t.error(e)},0)}function o(){e(!1)}function n(){d=!1,setTimeout(function(){u||d||(a(),e(!0))},1)}var l,c,u=!1,d=!1,t={};return{get:function(e){r(e)},post:function(e,t,a){r(null),c=function(e,t,a,r){var o,n,i=document.createElement("form");for(o in i.action=e,i.method=t,i.target="iframe_xhr_transport",i.name="iframe_form",i.style.display="none",r&&(i.enctype=r),a)if(a[o]instanceof Array)for(n=0;n<a[o].length;++n)s(i,o,a[o][n]);else s(i,o,a[o]);return i}(e,"POST",t,a?"multipart/form-data":""),document.body.appendChild(c),l.onload=n,l.onerror=o,c.submit()},formSend:function(e,t){r(null),e=function(e,t){var a,r,o,n=document.createElement("form");for(n.action=t||e.action,n.method=e.method,n.enctype=e.enctype,n.encoding=e.encoding,n.target="iframe_xhr_transport",n.name="iframe_form",n.style.display="none",a=0;a<e.elements.length;++a)r=e.elements[a],o=r.type.toLowerCase(),r.name.length&&("radio"!=o&&"checkbox"!=o||r.checked)&&("submit"!=o||r==e.submit_btn)&&n.appendChild(i(r.name,r.value));return n}(e,t),document.body.appendChild(e),e.submit()},_data:function(e){u=!0,a(),setTimeout(function(){t.always&&t.always(),t.success&&t.success(e)},0)},abort:a,setCallbacks:function(e){t=extend({success:null,error:null,always:null},e)}}}();window.IFrameXHR=d,w={default_id:null,callbacks:{},old_url:null,cur_url:null,state:null,_startup_url:null,init:function(){w.old_url=location.href,w.cur_url=location.href,window.onpopstate=w.handler,w._startup_url=location.href},setDefault:function(e){w.default_id=e},add:function(e,t){w.callbacks[e]=t},remove:function(e){delete w.callbacks[e]},clean:function(){for(var e in w.callbacks)w.default_id!=e&&delete w.callbacks[e]},handler:function(e){if(!e.state&&history.state&&(e.state=history.state),w.state=e.state,w._startup_url==location.href)return console.error("prevent html5 history bug"),w._startup_url=null,!1;w._startup_url&&(w._startup_url=null),w.old_url=w.cur_url,w.cur_url=document.location.href,Url.onlyHashChanged(w.cur_url,w.old_url)||(Spaces.referer=w.old_url,spaces_track(document.location.href,document.title,w.old_url));var t=w.default_id;return e.state&&e.state.route&&w.callbacks[e.state.route]!==undefined&&(t=e.state.route),t&&w.callbacks[t](e),e.preventDefault(),!1},pushState:function(e,t,a){w.state=e||{},w._startup_url&&(w._startup_url=null),e=e||{},w.old_url=document.location.href,window.history.pushState(e,t,a),w.cur_url=document.location.href,Url.onlyHashChanged(w.cur_url,w.old_url)||(Spaces.referer=w.old_url,spaces_track(document.location.href,document.title,w.old_url))},replaceState:function(e,t,a){e!==undefined&&(w.state=e),w.old_url=document.location.href,window.history.replaceState(e,t,a),w.cur_url=document.location.href,w._startup_url&&w._startup_url!=document.location.href&&(w._startup_url=null)},updateState:function(e){var t;try{t=history.state}catch(a){}t||(t=w.state||{}),e(t),w.replaceState(t,null,null)}},window.HistoryManager=w,e=Class({Constructor:function(){var e,t=this;$.extend(t,{page_no_cache:!1,active_reqs:0,refresh_url:null,refresh_interval:null,pages_id:{},page_cache_time:18e5,disabled:!1,prev_url:null,last:{link_id:0,sid:"0"},callbacks:{},user_id:Spaces.params.nid,_rnd:0}),e="desktop"==Device.type&&"msie"!=Device.browser&&"safari"!=Device.browser&&!("chrome"==Device.browser&&63<=Device.v),/force_ajax_transport=1/i.test(document.cookie)?e=!1:/force_iframe_transport=1/i.test(document.cookie)&&(e=!0),t.opts={iframe_transport:e,loading_indicator:!e},t.ok()&&(t.onShutdown("loader_onnewrequest",Loader.onNewRequestHandler,!0),w.setDefault("common"),w.add("common",function(e){t.loadPage({url:document.location.href,state:e.state,history:!1,scroll:!1,from_history:!0})||location.assign(document.location.href)}),t.on("shutdown","page_no_cache",function(){t.page_no_cache=!1},{persist:!0})),"operamini"!=Device.browser&&$(function(){t.setup()})},handlers:{onLinkClick:function(e,t){if(r.test(this.className))return!0;if(e.ctrlKey)return!0;if("_blank"==this.getAttribute("target"))return!0;var a=this.getAttribute("data-android-app");return a&&(a=JSON.parse(a)),this.href||(o.href=this.getAttribute("href"),this.href=o.href),t.loadPage({url:this.href,app:a})?(e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),!1):("UC-CLICK"==this.nodeName.toUpperCase()&&(location.href=this.href),!0)},onFormSubmit:function(e,t){return!!r.test(this.className)||(!t.loadPage({url:this.action,form:this})||(e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),!1))}},setup:function(){var e,a=this;a.invalid_page=!(ge("#main_page_footer")||ge("#footer")||ge("#navi_footer")||ge("#navi")),$.event.special.click||($.event.special.click={postDispatch:null}),$.event.special.submit||($.event.special.submit={postDispatch:null,trigger:null}),$.event.special.click.postDispatch=function(e){var t=e.ajaxify&&e.ajaxify.el;if((e.ajaxify||e.isPropagationStopped()||e.isImmediatePropagationStopped())&&(!e.originalEvent||!1!==e.originalEvent.returnValue&&!e.originalEvent.defaultPrevented)&&!e.isDefaultPrevented()){if(!t)for(t=e.target;t&&"A"!=t.nodeName.toUpperCase()&&"UC-CLICK"!=t.nodeName.toUpperCase();)t=t.parentNode;t&&!1===a.handlers.onLinkClick.call(t,e,a)&&e.preventDefault()}},$.event.special.submit.postDispatch=function(e){var t=e.ajaxify&&e.ajaxify.el;if((e.ajaxify||e.isPropagationStopped()||e.isImmediatePropagationStopped())&&(!e.originalEvent||!1!==e.originalEvent.returnValue&&!e.originalEvent.defaultPrevented)&&!e.isDefaultPrevented()){if(!t)for(t=e.target;t&&"FORM"!=t.nodeName.toUpperCase();)t=t.parentNode;t&&!1===a.handlers.onFormSubmit.call(t,e,a)&&e.preventDefault()}},$("body").on("click","a, uc-click",function(e){e.ajaxify={el:this}}).on("submit","form",function(e){e.ajaxify={el:this}}),window.pushstream&&pushstream.on("message","ajaxify",function(e){e.act==Spaces.LongPollingTypes.REFRESH_WIDGETS&&(a.current_tab_widgets_updated||a.refreshWidgets(e.widgets&~Spaces.WIDGETS.FOOTER),a.current_tab_widgets_updated=!1),e.act==Spaces.LongPollingTypes.SETTINGS&&a.updateSettings(e.newSettings);var t=e.session_ctime||e.data&&e.data.session_ctime;e.act!=Spaces.LongPollingTypes.DEVICE_TYPE_CHANGE&&e.act!=Spaces.LongPollingTypes.LOGOUT||t!=Spaces.params.sid||a.disable(e.device_type!=Device.id)}),a.ok()&&(window.PAGE_REFRESH&&(e=PAGE_REFRESH.params.match(/^(\d+);\s*url=(.*?)$/i))&&(a.setRefresh(e[2],e[1]),PAGE_REFRESH.timer&&clearTimeout(PAGE_REFRESH.timer)),$("#main_shadow").prepend(t()),$("#ajax_cancel").click(function(e){e.preventDefault(),a.cancel()}))},onShutdown:function(e,t,a){return this.on("shutdown",e,t,a)},onRequestStart:function(e,t){return this.on("requeststart",e,t,!0)},onRequestEnd:function(e,t){return this.on("requestend",e,t,!0)},setRefresh:function(e,t){var a=this;a.refresh_interval&&(clearInterval(a.refresh_interval),a.refresh_interval=null,a.refresh_url=null),e&&(a.refresh_url=e,console.error("set refresh: "+e+", "+t),a.refresh_interval=setInterval(function(){a.loadPage({url:a.refresh_url})},1e3*t))},loadPage:function(d){var p,e,f,t,m,_,a,r,o,h,g,v,n,b,i,S,k,s,l,y=this;if(d=$.extend({url:"",form:null,history:!0,state:null,scroll:!0,from_history:!1,app:!1},d),$(document.body),d.form&&(e=d.form.getAttribute("enctype"),(p=e&&"multipart/form-data"==e.toLowerCase())&&$(d.form).find('input[type="file"]').length))return!1;if(!y._trigger("beforerequest",[d]))return!0;if(y.off("beforerequest"),!y.ok())return!(!d.form||y._trigger("formsubmit",[{form:d.form}]));if(t=new Url(d.url,!0),m=new Url(document.location.href,!0),t.scheme!=m.scheme&&(t.scheme=m.scheme,console.warn("Protocol mismatch: "+t.url())),_=null,d.form){if(!y._trigger("formsubmit",[{form:d.form}]))return!0;"get"==d.form.method.toLowerCase()?(t.query=Url.serializeForm(d.form),d.form=null):_=Url.serializeForm(d.form)}if(!y._trigger("router",[t,d]))return d.history&&w.pushState({noCache:y.page_no_cache},document.title,t.url()),!0;if(c.test(t.path))return!1;if(t.domain!=m.domain){if(m.parseDomain(),0<(a=t.parseDomain()).sub_domains.length&&(r=a.sub_domains[a.sub_domains.length-1],u.test(r.toLowerCase())||r.length<=2))return!1;if(a.base_domain!=m.domain)return!1;o="/"==t.path.replace(/\/+/g,"/")||!t.path.length,/\.grp\./i.test(t.domain)?(o&&(t.path="/comm/comm/show",t.query={}),t.query.address=a.sub_domains[0].replace(/-/g,"_")):(o&&(t.path="/mysite/",t.query={}),t.query.name=a.sub_domain.replace(/-/g,"_")),t.domain=m.domain}return h=function(e){y.setRefresh(!1),y._trigger("requestend",[e]),e?y._proccessInternalCb(location.hash.substr(1)):(y._trigger("shutdown"),y._resetHandlers()),Spaces.clearErrors()},g=function(){y._trigger("pageloaded")},v=t.hash,n=d.history?new Url(w.cur_url):new Url(w.old_url),!d.form&&(0<n.hash.length||0<t.hash.length)&&t.isSame(n)?(y._trigger("requeststart"),h(!0),y.page_no_cache&&w.updateState(function(e){e.noCache=!0}),!!d.from_history):!y.disabled&&(delete t.query.sid,f=t.url(),t.hash="",b=t.url(),!(d.app&&Device.android_app&&SpacesApp.exec("go",d.app))&&(i=y.pages_id[b],S=d.from_history&&i?i.rnd:(new Date).getTime(),d.state&&d.state.noCache&&(S=(new Date).getTime()),y.pages_id[b]||(y.pages_id[b]={}),y.pages_id[b].time=(new Date).getTime(),y.pages_id[b].rnd=S,d.state&&d.state.post_data&&(_=d.state.post_data,p=d.state.multipart),k=cookie.get("sid"),s=function(r){var e,t,a,o,n,i,s,l,c,u;if(r.reklama_id&&r.reklama_id!=Spaces.params.ac&&($("."+Spaces.params.ac).removeClass(Spaces.params.ac).addClass(r.reklama_id),$.each(E,function(e,t){$("."+Spaces.params.ac+e).removeClass(Spaces.params.ac+e).addClass(r.reklama_id+e)}),SPACES_PARAMS.ac=r.reklama_id,Spaces.params.ac=r.reklama_id),r.app&&Device.android_app)return SpacesApp.exec("go",r.app),!1;if(r.http_error===undefined){if(e=!1,r.copy_link_id&&(e=d.from_history&&y.last.link_id>r.copy_link_id&&y.last.sid==k,y.last.sid=k,y.last.link_id<r.copy_link_id&&(y.last.link_id=r.copy_link_id),Spaces.params.link_id=r.copy_link_id),t=$(window).scrollTop(),h(),window.Sidebar&&Sidebar.toggle(!1),e||(r.newSettings&&y.updateSettings(r.newSettings),r.refreshWidgets&&(y.current_tab_widgets_updated=!0,y.updateWidgets(r.refreshWidgets,!0)),r.friends&&($("#friends_cnt").text(r.friends[0]).parent().toggle(0<r.friends[0]),$("#friends_cake").toggle(0<r.friends[1]))),r.redirect){for(a=new Url(r.redirect.replace(/&amp;/gi,"&")).merge(new Url(f)),console.error("redirect: "+a.url(),"("+r.redirect+")"),o=0;o<r.cookie.length;++o)document.cookie=r.cookie[o];return a.domain==location.hostname.toLowerCase()&&r.user_id==y.user_id&&y.loadPage({url:a.url()})||location.assign(html_unwrap(r.redirect)),void g()}if(r.revision&&(r.revision[1]>SPACES_REV&&(console.log("new ajax rev: "+r.revision[1]),y.disable(!0)),r.revision[0]!=T&&(T=r.revision[0],y.refreshWidgets(Spaces.WIDGETS.CSS))),$("#main_search_input, #header_elements .js-search__input").val("").blur(),r.refresh){if(a=new Url(r.refresh.link),r.refresh.link=r.refresh.link.replace(/&amp;/gi,"&"),a.domain!=m.domain)return location.assign("/?redirect="+encodeURIComponent(r.refresh.link)+"&xyz=1"),void g();y.setRefresh(r.refresh.link,r.refresh.time)}if(r.user_id!=y.user_id)return location.assign(f),void g();for(i in d.from_history?y.prev_url&&(y.pages_id[y.prev_url].forms=D(document.getElementById("main_content"))):(y.pages_id[b]&&delete y.pages_id[b].forms,w.updateState(function(e){e.scroll=t,e.forms=D(document.getElementById("main_content"))})),d.history&&w.pushState({rnd:S,post_data:_,multipart:p},r.title,f),y.prev_url=b,n=(new Date).getTime(),y.pages_id){if(y.pages_id[i].time+y.page_cache_time>=n)break;delete y.pages_id[i]}++x,$("#main").off(),$("body").off(".oneRequest"),$(window).off(".oneRequest"),document.title=r.title,r.css_files&&Loader.loadCSS(r.css_files,!0),s=!!r.main_footer,l={">debug":"debug",sidebar:"widgets.sidebar",section_tabs:"widgets.section_tabs",location_header:"location",location_footer:r.locationBottom?"locationBottom":"location",coins_gift:"coins_gift",sharings:"shareButtons",page_counters:"counters",index_counters:"index_counters",main_footer:"main_footer",top_info_block:"top_info_block",moder_block:"moder_block",lang_switcher:"widgets.lang_switcher",apps_widget:"apps_widget"},$.each(E,function(e,t){if(r.refreshWidgets){if(r.refreshWidgets[Spaces.WIDGETS.RIGHTBAR]&&"rightbar_reklama"==t)return;if((r.refreshWidgets[Spaces.SIDEBAR.SIDEBAR]||find_var(r,"widgets.sidebar"))&&"sidebar_reklama"==t)return}l["."+Spaces.params.ac+e]=t}),each(l,function(e,t){var a=e&&find_var(r,e);(">"!=t[0]||(t=t.substr(1),a))&&$("."==t[0]?t:"#"+t).fastHtml(!1!==e&&a||"")}),c=$("#main_content").fastHtml('<div id="main">'+(r.game_motivator?r.game_motivator:"")+r.content+"</div>"),$("#main_page_footer, #bottom_tools_main, #main_page_footer, #index_counters").visible(s),$("#navi_footer_wrap, #bottom_tools_wrap").visible(!s),$("#version_selector").visible(r.showVersionSelector),require("notif",function(){r.notifications&&!e&&Spaces.notifications.pushNotifications(r.notifications)}),r.topCounters&&!e&&(u=r.topCounters,require("notif",function(){Spaces.notifications.updateCounter(Notifications.COUNTER.MAIL,u.mail_new,{blink:!1}).updateCounter(Notifications.COUNTER.LENTA,u.lenta,{blink:!1}).updateCounter(Notifications.COUNTER.JOURNAL,u.journal_imp+u.journal,{important:0<u.journal_imp,blink:!1})})),setTimeout(function(){var e;d.state&&d.state.forms&&(e=d.state.forms),y.pages_id[b]&&y.pages_id[b].forms&&(e=y.pages_id[b].forms),e&&C(c[0],e),r.copy_link_id&&($("#bottom_tools_wrap, #navi_footer_wrap, #header_elements, #page_sidebar, #bottom_tools_main, #page_rightbar").find("a").each(function(){this.href=this.href.replace(/(link_id=)(\d+)/gi,"$1"+r.copy_link_id)}),$("#page_sidebar, #page_rightbar").find('input[name="link_id"], input[name="Link_id"]').val(r.copy_link_id)),$("#copy_url").visible(!!r.copy_link_show),!d.scroll||d.state&&d.state.scroll||y.scrollDocument(v),setTimeout(Spaces.makeZbs,1e3),g()},0),d.state&&d.state.scroll&&y.scrollDocument(d.state.scroll)}else y.showLoadingError(Spaces.getHttpError(r.http_error),d)},"firefox"==Device.browser&&"desktop"!=Device.type&&(l=s,s=function(e){!d.scroll||d.state&&d.state.scroll||y.scrollDocument(),setTimeout(function(){l(e)},0)}),y._trigger("requeststart"),y.request(S,t,_,s,function(e){g(e.manual),y._trigger("requestend"),e.manual||(y.scrollDocument(),y.showLoadingError(e.error,d))},{multipart:p}),!0))},request:function(e,t,a,r,o,n){var i,s,l=this;n=$.extend({multipart:!1},n),Spaces.clearError("ajax_error"),l.opts.loading_indicator&&l.showLoading(),++l.active_reqs,i=function(e){--l.active_reqs,l.opts.loading_indicator&&l.hideLoading(),r&&r(e)},l.opts.iframe_transport?(t.path="/xhr"+e+t.path,d.setCallbacks({success:i,error:function(e){--l.active_reqs,l.opts.loading_indicator&&l.hideLoading(),o&&o({manual:!1,error:Spaces.getHttpError(e?-500:0)})},always:function(){}}),a?d.post(t.url(!0),a,n.multipart):d.get(t.url(!0))):(t.path="/ajax"+e+t.path,s=window.FormData&&n.multipart,l.cancel(),l._last_xhr_request=$.ajax({url:t.url(!0),processData:!1,contentType:!s&&"application/x-www-form-urlencoded; charset=UTF-8",data:s?function(e){var t,a,r,o=new window.FormData;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t))if(e[t]instanceof Array)for(a=0,r=e[t].length;a<r;++a)o.append(t,e[t][a]);else o.append(t,e[t]);return o}(a):Url.buildQuery(a),method:a?"POST":"GET",dataType:"json",cache:!0}).success(i).fail(function(e){--l.active_reqs,l.opts.loading_indicator&&l.hideLoading(),o&&o({xhr:e,manual:e.__manual_abort,error:Spaces.getHttpError(200==e.status?-500:e.status)})}).always(function(){l._last_xhr_request=null}))},cancel:function(){var e=this;e.opts.iframe_transport?d.abort():e._last_xhr_request&&4!=e._last_xhr_request.readyState&&(e._last_xhr_request.__manual_abort=!0,e._last_xhr_request.abort())},getRequestId:function(){return x},disable:function(e){this.disabled=e},reload:function(){page_loader.ok()&&page_loader.loadPage({url:location.href,state:w.state})||location.reload()},showLoadingError:function(e,t){var a=this;Spaces.showError(e,"ajax_error",{onRetry:function(){a.loadPage(t)}})},documentAutoScroller:function(e,t,a){var r,o,n,i,s=this,l=$("html, body"),c=$(window),u=(new Date).getTime(),d=0,p="object"!=typeof e&&$.isNumeric(e)?parseInt(e):null;a=a||3e4,o="touchmove.auto_scroller touchstart.auto_scroller keydown.auto_scroller click.auto_scroller MozMousePixelScroll.auto_scroller mousewheel.auto_scroller wheel.auto_scroller scroll.auto_scroller",n=function(e){e&&!e.originalEvent||e&&"scroll"==e.type&&e.originalEvent&&d==c.scrollTop()||(clearInterval(r),r=null,c.off(".auto_scroller"))},r=setInterval(i=function(){l.scrollTop(null!==p?p:parseInt(e.offset().top)),d=c.scrollTop(),(new Date).getTime()-u>a&&n()},t=t||200),i(),c.on(o,n),s.onRequestStart("auto_scroller",n)},scrollDocument:function(e){var t,a=this,r=parseInt(e);if(isNaN(r)&&e&&("object"==typeof e||0<e.length)){if("string"==typeof e&&"/"==e.substr(0,1))return;try{if(0<(t="object"==typeof e?$(e):$("#"+e+', a[name="'+e+'"]')).length)return void a.documentAutoScroller(t,200,3e4)}catch(o){console.error(o.toString())}}"firefox"==Device.browser?($("html, body").scrollTop(r||0),setTimeout(function(){$("html, body").scrollTop(r||0)},15)):$("html, body").scrollTop(r||0)},refreshWidgets:function(e,t){var a=this;e&&Spaces.api("neoapi/common.refreshWidget",{widgets:e},function(e){0==e.code&&e.widgets&&(a.updateWidgets(e.widgets),t&&t())})},updateWidgets:function(e,t){var a,r,o,n,i,s,l,c,u,d,p={},f={};for(o in p[Spaces.WIDGETS.FOOTER]="navi_footer_wrap",p[Spaces.WIDGETS.HEADER]="header_elements",p[Spaces.WIDGETS.SIDEBAR]="page_sidebar",p[Spaces.WIDGETS.RIGHTBAR]="page_rightbar",f[Spaces.WIDGETS.FOOTER]="footer",f[Spaces.WIDGETS.HEADER]="header",f[Spaces.WIDGETS.SIDEBAR]="sidebar",f[Spaces.WIDGETS.CSS]="css",f[Spaces.WIDGETS.RIGHTBAR]="rightbar",window.Sidebar&&Sidebar.toggle(!1),a=Spaces.params.avatar,r={},e)r[o]=!0,console.error(": "+f[o]),p[o]!==undefined?(o==Spaces.WIDGETS.FOOTER&&Spaces.footer&&Spaces.footer.update(),$("#"+p[o]).fastHtml(e[o]),o==Spaces.WIDGETS.HEADER&&(Loader.loaded("sidebar",function(){Sidebar.init()}),Loader.loaded("clock",function(){Spaces.Clock.check()})),o==Spaces.WIDGETS.SIDEBAR&&(Spaces.core.check(),a!=Spaces.params.avatar&&Spaces.view.updateAvatars())):o==Spaces.WIDGETS.CSS&&(n=$("head"),m&&(n.find("link[data-main-css]").each(function(e,t){var a=$(this);a.data("loading")&&a.prop("disabled",!0).remove()}),clearTimeout(m)),i=n.find("link[data-main-css]"),s=$("<div>").html(e[o]).find("link[data-main-css]").data("loading",!0),i.length!=s.length?(i.first().before(s),i.prop("disabled",!0).remove()):(l=Date.now(),c=s.map(function(e,t){if(s[e].href!=i[e].href)return $(i[e]).after(s[e]),{old:i[e],cur:s[e],secure:0<=s[e].href.indexOf("://"+location.host+"/")}}),u=1e3,c.length&&(m=setTimeout(d=function(){var o=[],n=Date.now()-l;$.each(c,function(e,t){var a=!1;if(t.secure&&"sheet"in t.cur)try{t.cur.sheet&&"cssRules"in t.cur.sheet&&(a=!t.cur.sheet.cssRules||0<t.cur.sheet.cssRules.length)}catch(r){a=6e4<=n}else a=2e4<=n;a?($(t.cur).data("loading",!1),t.old.disabled=!0,$(t.old).remove()):o.push(t)}),m=!1,(c=o).length&&(m=setTimeout(d,n<=8e3?u:2*u))},u))));$("body").trigger("spUpdatePart",r)},updateSettings:function(e){var t,a;for(t in e)a=e[t],t==Spaces.SettingsTypes.AVATAR?(Spaces.params.avatar=a,Spaces.view.updateAvatars()):t==Spaces.SettingsTypes.USER_NAME?Spaces.params.name=a:t==Spaces.SettingsTypes.FORM_SUBMIT_KEY?Spaces.params.form_submit_key=a?"ENTER":"CTRL_ENTER":t==Spaces.SettingsTypes.SOUND_NOTIFY_BLOCK&&(Spaces.params.play_sound=!a)},back:function(){return history.back(),!1},showLoading:function(){var e,t=this;t.active_reqs||(e=$("#main_shadow"),$("#ajax_loader").css({top:0,left:e.offset().left,width:e.outerWidth()}).visible(!0))},hideLoading:function(){this.active_reqs||$("#ajax_loader").visible(!1)},isJSC:function(){return!!this.ok()&&!!location.hash.substr(1).match(/^([^\/]+)\/?(.*?)$/i)},onJSC:function(e,t,a){return this.ok()?this.on("js_cb_"+e,"js_cb_"+e,t,a)._proccessInternalCb(location.hash.substr(1),e):this},setJSC:function(e,t,a){if(this.ok()){var r=new Url(location.href),o=location.hash.substr(1);e?(r.hash=e+"/"+t,w[a?"replaceState":"pushState"](null,null,r.url())):o.match(/^([^\/]+)\/?(.*?)$/i)&&(r.hash="",w.replaceState(null,null,r.url()))}},_proccessInternalCb:function(e,t){if(this.ok()){var a;new Url(location.href);e&&(!(a=e.match(/^([^\/]+)\/?(.*?)$/i))||t&&t!=a[1]||this._trigger("js_cb_"+a[1],[a[2]]))}},noCache:function(e){var t=this;if(t.ok())return t.page_no_cache=e===undefined||!!e,w.updateState(function(e){e.noCache=t.page_no_cache}),t},one:function(e,t){return this.on(e,"__signle__",t,!0)},push:function(e,t){return this.on(e,"shd"+ ++this._rnd,t,!1)},router:function(e,t){return this.on("router","router"+ ++this._rnd,e,{persistOnRequest:!t,persist:!!t})},on:function(e,t,a,r){return r=extend({persist:"boolean"==typeof r&&r,persistOnRequest:!1},r),a?(this.callbacks[e]=this.callbacks[e]||{},this.callbacks[e][t]={func:a,opts:r},this):this.off(e,t)},off:function(e,t){return t&&this.callbacks[e]?delete this.callbacks[e][t]:this.callbacks[e]={},this},_trigger:function(e,t){var a,r,o=this,n=!1;if(!o.callbacks[e])return!0;for(a in o.callbacks[e]){if((r=o.callbacks[e][a]).func)try{!1===r.func.apply(o,t)&&(n=!0)}catch(i){console.error("Handler ("+e+", "+a+") error:",i.stack?"\n"+i.stack:i)}r.func&&(r.opts.persist||r.opts.persistOnRequest)||o.off(e,a)}return!n},_resetHandlers:function(){var e,t,a=this;for(e in a.callbacks)for(t in a.callbacks[e])a.callbacks[e][t].opts.persistOnRequest&&a.off(e,t)},ok:function(){var e=this;return"_ok"in e||(e._ok=cookie.enabled()&&history.pushState&&!/ajaxify=0/i.test(document.cookie)&&"operamini"!=Device.browser&&!Spaces.params.no_ajaxify,Device.android_app&&Device.webkit()<=533.1&&(e._ok=!1),Device.android_app&&window.SpacesApp.exec("ajaxify",{enable:e._ok})),!e.invalid_page&&e._ok}}),w.init(),window.PageLoader=e,window.page_loader=new e});define("notif","init",function(){var a,c=24e4,s="operamobile"==Device.browser&&Device.v<=12,e="operamini"==Device.browser,r=!e&&Spaces.params.nid,n=Device.css("position","fixed",/fixed/i),d={},u=function(e){var t={1:"system-message_service",2:"",3:"system-message_alert"};return e.text=e.text.replace(/(spcs\.me|spaces\.ru)/gi,base_domain()),'<div id="notif_'+e.id+'" class="oh system-message notification_item '+(e.n||e.delayed?"hide ":"")+(e.delayed?"js-notif_to_show ":"")+t[e.severity]+'"><span class="notif_text"><span class="ico ico_remove js-notif_close pointer right"></span></span><span class="notification_counter '+(e.n?"":"hide ")+'">'+(e.n+1)+"</span> "+Spaces.prepareLink(e.text)+"</div>"},l=Class({Constructor:function(){var e,t,i,n,o=this;"operamobile"==Device.browser&&Device.v;o.lock=!1,o.deffered=[],o.blinker={interval:null,old_title:null},o.ncounter=0,o.top_notif_queue=[],o.top_notif_queue_lock=!1,o.page_load_time=(new Date).getTime(),o.oncounterchange=null,e="hidden",t="",i=document,e in document?t="visibilitychange":(e="mozHidden")in document?t="mozvisibilitychange":(e="webkitHidden")in document?t="webkitvisibilitychange":(e="msHidden")in document?t="msvisibilitychange":"onfocusin"in document?t="focusin focusout":(t="pageshow pagehide focus blur",i=window),o.window_active="true"!=cookie.get("spacesactive"),document[e]!==undefined&&o.checkWindow(!document[e]),$(i).on(t,{hidden:e},class_func(o,o.checkWindow)),cookie.set("spacesactive","true",{expires:7}),require("ajaxify",function(){page_loader.ok()&&(page_loader.onRequestStart("notifications",function(){o.lock=!0}),page_loader.onRequestEnd("notifications",function(){$("#top_notif_place").find(".js-notif_close").click(),$(".lp_notif_message").click(),o.lock=!1,$.each(o.deffered,function(e,t){o.pushNotification(t)}),o.deffered=[]}),page_loader.on("shutdown","notifications",function(){o.setPlace(!1)},!0))}),$(function(){var e="spaces:tab"+o.page_load_time+":alive",i=function(){Spaces.LocalStorage.get(e)&&Spaces.LocalStorage.remove(e)};$.each([document,window,document.body],function(e,t){t.addEventListener&&t.addEventListener("storage",i,!1)})}),r&&(Spaces.params.play_sound&&require("sound",function(){(a=new SpacesSound).ready(function(){a.load(ICONS_BASEURL+"sounds/newMessage.mp3")})}),pushstream.addMessageHandler("notifications",class_func(o,o.onLongPolling)),o.beacon_interval=setInterval(function(){Spaces.api("neoapi/common.beacon",d)},c)),n="touchmove.activity_detect touchstart.activity_detect keydown.activity_detect click.activity_detect MozMousePixelScroll.activity_detect mousewheel.activity_detect wheel.activity_detect scroll.activity_detect mousemove.activity_detect",$(window).on(n,function(e){e.originalEvent&&(o.window_active=!0,$(window).off(".activity_detect"))})},Static:{COUNTER:{JOURNAL:1,LENTA:2,MAIL:3},counters:{1:{title:L(""),id:"jour_notif_cnt",key:"journal"},2:{title:L(""),id:"lent_notif_cnt",key:"lenta"},3:{title:L(""),id:"mail_notif_cnt",key:"mail"}},_instance:null,instance:function(){return l._instance||(l._instance=new l),l._instance}},onLongPolling:function(e){var t,i=this;e.act==Spaces.LongPollingTypes.KARMA_CHANGED&&$(".js-karma_value").text((+e.value).toFixed(2)),i.needIgnore(e)||(e.act==Spaces.LongPollingTypes.NOTIFICATION_SEND?0<=$.inArray(Spaces.params.sid,e.sessions_ctimes)&&(e.lp=!0,i.pushNotification(e)&&i.showNewEvent(L(" "))):e.act==Spaces.LongPollingTypes.TOP_COUNTER_UPDATE?i.updateCounter(e.type,e.cnt,{important:!!e.important}):e.act==Spaces.LongPollingTypes.COMM_COUNTER_UPDATE&&(t=$("#cc"+e.com_id)).length&&(t.find(".acnt").text(e.cnt),0<e.cnt?t.show():t.hide()))},autohideTopNotif:function(e){var t=this,i=$(window);return e||$(".lp_notif_wrapper").length?i.on("scroll.autohideTopNotif",function(){var e=i.scrollTop();e<=50?t.closeTopNotif():n||$(".lp_notif_wrapper").css({top:e+"px"})}):i.off(".autohideTopNotif"),this},checkWindow:function(e){var t=this,i=null,n={focus:!0,focusin:!0,pageshow:!0,blur:!1,focusout:!1,pagehide:!1};if("boolean"==typeof e)i=e;else if(n[e.type]!==undefined)i=n[e.type];else{if(document[e.data.hidden]===undefined)throw"Unknown event: "+e.type;i=!document[e.data.hidden]}t.window_active!==i&&((t.window_active=i)?t.onFocusWindow():t.onBlurWindow())},isAliveTab:function(e,t){var i=Date.now(),n="spaces:tab"+e+":alive";Spaces.LocalStorage.set(n,i),setTimeout(function(){Spaces.LocalStorage.get(n)?(Spaces.LocalStorage.remove(n),t(!1)):t(!0)},100)},getTabId:function(){return this.page_load_time},onBlurWindow:function(){cookie.set("spacesactive","false",{expires:7}),$(".lp_notif_wrapper").remove(),$("#main").trigger("blurwindow")},onFocusWindow:function(){this.titleBlink(!1),cookie.set("spacesactive","true",{expires:7}),this.showBackgroundNotifications(),$("#main").trigger("focuswindow")},getCounter:function(e){return parseInt($("#"+l.counters[e].id).text())},setNotifFilter:function(e){return this.re_filter=e,this},setPlace:function(e,t,i){!1!==e?(d.objectType=i,d.Type=e,d.Id=t):(delete d.objectType,delete d.Type,delete d.Id)},needIgnore:function(e){return e.Oid&&d.Id&&e.Oid==d.Id&&e.Ot==d.objectType},updateCounter:function(e,t,i){var n,o,a,c,s=this;return i=extend({blink:!0,important:!1},i||{}),(n=l.counters[e])?(a=(a=(o=$("#"+n.id)).text()).length<1?0:+a)==t?s:((c=jQuery.Event("counterchange")).counterType=e,c.counterValue=t,$("#main").trigger(c),c.isDefaultPrevented()?this:(c.counterValue!=t&&(t=c.counterValue),0<t?o.text(t):o.stop(!0,!0).fadeOut(function(){o.text("")}),0<t&&(s.showNewEvent(n.title+" +"+t),i.blink&&$(window).scrollTop()<10?0<o.not(":animated").length&&o.fadeTo(500,.2).fadeTo(499,1).fadeTo(500,.2).fadeTo(499,1).fadeTo(500,.2).fadeTo(499,1):o.fadeTo(0,1)),s)):(console.error("Unknown counter type: ",e),s)},showNewEvent:function(e,t){var i=this,n=cookie.get("spacesactive");return t=$.extend({oneTab:!1,notif:!0},t),cookie.set("pageLoadTime",i.page_load_time,{expires:7}),"true"==n?i.window_active?t.opts&&i.pushTopNotification({text:e}):t.oneTab&&i._bgNotif(e,t.oneTab):i._bgNotif(e,t.oneTab),this},_bgNotif:function(e,t){var i=this;setTimeout(function(){i.titleBlink(e),i.playSoundInBg(t)},300)},showNotification:function(e,t,i){i=extend({silent:!0},i||{}),t=t||"info";return this.renderNotification({id:"user_"+(new Date).getTime(),generic:!0,text:e,severity:{error:3,warning:2,info:1}[t]}),i.silent||this.showNewEvent(L(" ")),this},pushNotifications:function(e){for(var t=0;t<e.length;++t)this.pushNotification(e[t]);return this},pushNotification:function(e){var t=this;if(e.lp){if((parseInt(cookie.get("qnotid"))||0)>=e.id)return console.error(" ",e,new Date),!1;if(this.window_active&&cookie.set("qnotid",e.id,{expires:7}),this.lock)return e.lp=!1,t.deffered.push(e),!1}return t.re_filter&&t.re_filter.test(e.text)||this.renderNotification(e),!0},closeNotification:function(e){var t,i=this,n=$("#notif_"+e);return n.length&&(n.remove(),--this.ncounter),(t=$("#top_notif_place .notification_item").first())&&(t.find(".notification_counter").text(this.ncounter).toggle(1!=this.ncounter),t.show()),i.fixLocationBar(),this},renderNotification:function(t){var i=this,e=$("#top_notif_place"),n=$(u({id:t.id,n:i.ncounter,delayed:t.lp&&!i.window_active,severity:t.severity,text:t.text})),o=n.find(".js-comments_notif").each(function(){var e=$(this);e.data("id")==d.Id&&e.data("type")==d.Type&&e.remove()}).length;return o&&!$.trim(n.find(".notif_text").text()).length?this:(0<this.ncounter&&e.find(".notification_item").first().find(".notification_counter").text(this.ncounter+1).removeClass("hide"),n.prop("nid",t.id).prop("generic",!t.lp),n.find(".js-notif_close").on("click",function(e){e.preventDefault(),t.close_link&&Spaces.api(t.close_link,{}),i.closeNotification(t.id)}),++i.ncounter,e.append(n),i.fixLocationBar(),i)},fixLocationBar:function(){var e=0<$("#top_notif_place .notification_item:visible").length;$("#header_path").toggleClass("no-shadow",e)},showBackgroundNotifications:function(e){var t,i=$("#top_notif_place"),n=parseInt(cookie.get("qnotid")||0),o=i.find(".js-notif_to_show");for(t=0;t<o.length;++t)o[t].nid<=n?this.closeNotification(o[t].nid):((n=parseInt(cookie.get("qnotid")||0))<o[t].nid&&cookie.set("qnotid",o[t].nid,{expires:7}),$(o[t]).removeClass("js-notif_to_show"));return this},pushTopNotification:function(e){return $(window).scrollTop()<=50?this:(e.id=e.id||(new Date).getTime(),this.top_notif_queue.push(e),this.topNotifQueue())},topNotifQueue:function(e){var i,t,n,o=this;if(e||!o.top_notif_queue_lock){if(o.top_notif_queue.length)return o.top_notif_queue_lock||(o.autohideTopNotif(!0),o.top_notif_queue_lock=!0),i=o.top_notif_queue.shift(),function(){$(this).remove(),o.topNotifQueue(!0)},t=function(){var t=o.renderTopNotif(i);t.slideDown({duration:400,start:function(){t.css("margin-left",-t.width()/2+"px")},done:function(){if(0<o.top_notif_queue.length)t.delay(2e3).slideUp(400,function(){$(this).remove(),o.topNotifQueue(!0)});else{var e=t.find(".lp_notif_message");s?setTimeout(function(){e.addClass("lp_notif_message-fade")},5e3):e.delay(5e3).fadeTo(400,.5),o.topNotifQueue(!0)}}})},0<(n=$(".lp_notif_wrapper")).length?n.first().slideUp(400,function(){$(this).remove(),t()}):t(),o;o.top_notif_queue_lock=!1}},renderTopNotif:function(e){var t=this,i=$('<div id="top_notif_id_'+e.id+'" class="lp_notif_wrapper hide'+(n?" lp_notif_wrapper_fixed":"")+'"><div class="lp_notif_message">'+e.text+"</div></div>");return n||i.css({top:$(window).scrollTop()}),i.find(".lp_notif_message").on("click",{id:e.id},function(e){e.preventDefault(),$("html, body").scrollTop(0),t.closeTopNotif()}),$(document.body).append(i),i},closeTopNotif:function(){return this.top_notif_queue=[],$(".lp_notif_wrapper").remove(),this.autohideTopNotif(!1),this},playSound:function(){if(r)return require("sound",function(){a.ready(function(){a.isSingle()&&Loader.loaded("music")&&MusicPlayer.playing()||(a.setVolume(100),a.stop(),tick(function(){a.play()}))})}),this},playSoundInBg:function(e){var t=parseInt(cookie.get("pageLoadTime")||0);return(this.page_load_time==t||e)&&Spaces.params.play_sound&&this.playSound(),this},titleBlink:function(e){var t,i=this,n=!0;return i.blinker.interval&&(document.title=i.blinker.old_title,clearInterval(i.blinker.interval),i.blinker.interval=null),e&&((t=function(){n?(i.blinker.old_title=document.title,document.title=e,n=!1):(document.title=i.blinker.old_title,n=!0),"true"==cookie.get("spacesactive")&&i.titleBlink(!1)})(),i.blinker.interval=setInterval(t,1e3)),this},isWindowActive:function(){return this.window_active}});e||(window.Notifications=l,Spaces.notifications=new l)});define("read_full","init",function(){window.Tools={fullText:function(e,t){var n,a,o,i,d,l,r;if((t=t||window.event).preventDefault?t.preventDefault():t.returnValue=!1,n=e.getAttribute("data-quote"),a=e.getAttribute("data-code"),(o=ge(".extSubject",e.parentNode.parentNode)[0]).style.display="inline",e.style.display="none",n||a){for(i=a?"code":"div",d=e,l=o.getElementsByTagName(i)[0];(d=d.previousSibling)&&(!d.tagName||d.tagName.toLowerCase()!=i););d&&l&&(a&&Loader.loaded("code_highlight")?Spaces.CodeHighligt.concatCode($(d),$(l)):(d.innerHTML+=l.innerHTML,l.parentNode.removeChild(l)))}0<(r=ge(".splr_item_dots",e.parentNode.parentNode)).length&&(r[0].style.display="none")}}});define("device","init",function(){function i(e,n){var t,r,i,a,o=["","webkit","Moz","ms","O"],s=["","-webkit-","-moz-","-ms-","-o-"],c=d[e];if(!c)for(t=0,r=o.length;t<r;++t)if(i=o[t],a=(e||"").replace(/-([a-z])/g,function(e,n){return(n||"").toUpperCase()}),i.length&&(a=i+a.charAt(0).toUpperCase()+a.substr(1)),"undefined"!=typeof u.style[a]){c=d[e]=[s[t]+e,a];break}return!!c&&c[n?0:1]}var e,n,t,r,a,u,d,o=["requestAnimationFrame","cancelAnimationFrame"],s="spdev"+Date.now();for(e=0;e<o.length;++e)n=o[e],window[n]||(t=can_eom(window,"requestAnimationFrame"))&&(window[n]=window[t]);r={transform:function(){var e=-1<navigator.userAgent.indexOf("Android 2.");return(!Device.webkit()||!e)&&"operamini"!=Device.browser&&Device.css("transform","translate(1px,1px)",/translate/i)},transform3d:function(){return Device.can("transform")&&Device.css("transform","translate3d(1px,1px,1px)",/3d/i)},transition:function(){return i("transition")},sessionStorage:function(){var e,n;try{if(e=window.sessionStorage)return e.setItem(s,s),n=e.getItem(s),e.removeItem(s),n==s}catch(t){}return!1}},a={},u=ce("div"),d={},window.can_css=i,extend(Device,{css:function(e,n,t){var r=i(e);return t&&(u.style[r]=n,t.test(u.style[r]+"")||(r=!1)),r},webkit:function(){var e=navigator.userAgent.match(/AppleWebKit\/([\d\.]+)/);return e?parseFloat(e[1]):0},android:function(){var e=navigator.userAgent.match(/Android\s+([\d\.]+)/);return e?parseFloat(e[1]):0},can:function(e){return e in r&&(e in a?a[e]:a[e]=r[e]())}})});define("comments_deffered","init",function(){function e(){r=!0,t=$(".js-load_comments_deffered"),page_loader.push("shutdown",i),t.length&&(t.on("click",function(e){e.preventDefault();var n=$(this),o=n.find(".js-ico"),t=n.data("params");o.hasClass("hide")&&(i(),o.removeClass("hide"),t.Type=n.data("type"),Spaces.api("neoapi/comments.getContainer",t,function(e){o.addClass("hide"),0==e.code?(n.parents(".js-comments_container").fastHtml(e.container),Loader.loaded("gallery",function(){GALLERY.addPhoto()})):Spaces.showApiError(e)},{onError:function(e){o.addClass("hide"),Spaces.showError(e)}}))}),d=0,n(),window.addEventListener?window.addEventListener("scroll",n,!1):$window.on("scroll.view_tracker",n))}function n(){var e=window.pageYOffset||(document.documentElement||document.body||{}).scrollTop,n=Math.max(window.innerHeight,(document.documentElement||{}).clientHeight||0);d=Math.max(d,e+n),a||(a=setTimeout(o,s))}function o(){d-t.offset().top>t.height()&&t.click(),a=!1}function i(){r&&(r=!1,a&&clearTimeout(a),a=t=null,window.removeEventListener?window.removeEventListener("scroll",n,!1):$window.off(".view_tracker"))}var t,d,a,r,s=130;define("comments_deffered","onRequest",function(){$(e)})});define("online_status","init",function(){var e,t=4e4,d=0,g=1,S=!0,_=!1,m=!1,h={},s=function(n){function u(n,i,e){n.parentNode&&(n.src=ICONS_BASEURL+(e?i.ico_on:i.ico_off),n.setAttribute("alt",e?"(ON)":"(OFF)"))}function i(n,i,e,t){if(!(n in h&&e==d)){if(Spaces.params.nid&&Spaces.params.nid==n){if(!m)return;m=!1}var s=l[n];return s||(a.push(n),s=l[n]={uid:n,widgets:{}}),s.widgets[e]||(s.widgets[e]=[]),s.widgets[e].push({el:i,data:t}),s}u(i,t,h[n])}var a,l,e,t,s,o,c,f,r,p;if(!n){if(!S)return;if(Spaces.notifications&&!Spaces.notifications.isWindowActive())return void(_=!0);_=!1}for(a=[],l={},t=(e=$("#main_content")).find("img.online_status_ico"),s=0;s<t.length;++s)if(c=(o=t[s]).getAttribute("u")){if(f=(c=c.split(":"))[0],n&&f!=n)continue;i(f,o,d,{ico_on:c[1],ico_off:c[2]})}for(r=e.find(".js-online_status"),s=0;s<r.length;++s)f=+(p=r[s]).getAttribute("data-user"),n&&f!=n||i(f,p,g);0<a.length&&(S=!1,Spaces.api("neoapi/users.isOnline",{UsErs:a},function(n){var i,e,t,s,a,o,c,f,r;if(S=!0,0==n.code)for(i in n.status)if(e=l[i],t=!!n.status[i].is_online,e)for(s in e.widgets)for(a in e.widgets[s])o=e.widgets[s][a],s==d?u(o.el,o.data,t):s==g&&(f=(c=$(o.el)).data("toggle"),c.toggle("online"==f&&t||"offline"==f&&!t),"offline"==f&&((r=c.data("inner"))?c.find(1==r?".js-online_status_time":r):c).text(n.status[i].human_last_time))},{onError:function(){S=!0}}))};Spaces.checkOnline=function(n,i){Spaces.params.nid&&(e&&(clearInterval(e),e=null),e=setInterval(s,t),n&&s(i))},pushstream&&pushstream.on("message","online_status",function(n){n.act==Spaces.LongPollingTypes.STATUS_CHANGE&&(h[Spaces.params.nid]=n.Online,m=!0,Spaces.checkOnline(!0,Spaces.params.nid))}),Spaces.params.nid&&$(function(){Spaces.checkOnline(),page_loader.on("pageloaded","online_status",function(){Spaces.checkOnline()},!0),$("#main").on("focuswindow",function(n){_&&Spaces.checkOnline(!0)})})});define("sidebar","init",function(){var c,s="touch"==Device.type?"-240%":"-120%",i=!!navigator.userAgent.match(/(UCBrowser|UCWEB)/i),l=50,d=60,r=Device.android(),e=!1,p={locked:!1,lock:function(e){p.locked=e,Device.android_app&&window.SpacesApp.exec("sidebar",{enable:!e})},init:function(){$("#home_link, #sidebarOverlay").off("click.sidebar").on("click.sidebar",function(e){e.preventDefault(),p.toggle()}),e||(e=!0,p.initSwipe())},toggle:function(e){var i=ge("#sidebar_wrap"),t=ge("#left_nav_bg"),n=ge("#content_wrap_move"),o=ge("#main_search_form"),a=ge("#main_search_input_ico");i&&ge("#wrap_all").clientWidth&&(e=e===undefined?!hasClass(i,"sidebar_open_width"):e,Device.android_app&&Loader.loaded("jq",function(){e?(c=$(window).scrollTop(),$("html, body").scrollTop(0),$("#siteContent").css({marginTop:-c})):($("#siteContent").css({marginTop:0}),$("html, body").scrollTop(c)),$("#pmb8876").remove(),$("#navi").append('<div id="pmb8876">')}),toggleClass(i,"sidebar_open_width",e),t&&toggleClass(t,"sidebar_open_width",e),n.style.marginRight=e?s:0,o&&(o.style.display="block"),a&&(a.style.display=e?"none":"block"),$("body").toggleClass("openSidebar",e),$("#home_link").toggleClass("horiz-menu__link_no_hover",e))},initSwipe:function(){var a,c,s,e=document.body;!e.addEventListener||"touch"!=Device.type||"operamini"==Device.browser||i||Device.android_app||(c=a=0,s=!1,e.addEventListener("touchstart",function(e){p.locked||(Spaces.lastActivity=Date.now(),s=!e.touches||1==e.touches.length,a=e.touches?e.touches[0].clientX:e.clientX,c=e.touches?e.touches[0].clientY:e.clientY)},!1),e.addEventListener("touchmove",function(e){if(s){var i=e.touches?e.touches[0].clientX:e.clientX,t=e.touches?e.touches[0].clientY:e.clientY,n=Math.abs(i-a),o=Math.abs(t-c);d<o?s=!1:o<=.66*n?(r&&e.preventDefault(),l<=n&&(p.toggle(a<=i),s=!1)):s=!1}},!1))}};window.Sidebar=p,$(function(){p.init()})});define("checkall","init",function(){function c(e){var n,c=this,t=ge("#"+c.getAttribute("data-parent"))||document.body,i=t.getElementsByTagName("input");for(n=0;n<i.length;++n)"checkbox"==i[n].type&&(i[n].checked=o);return o=!o,!1}var o=!0;SPACES_MOBILE?Loader.ready(function(){var e,n=ge(".js-checkall");for(e=0;e<n.length;++e)n[e].onclick=c}):(require("jq",function(){$("body").on("click",".js-checkall",c)}),define("checkall","onRequest",function(){o=!0}))});define("likes","init",function(){var A,E={up:"ico_vote_up",upActive:"ico_vote_up_on",down:"ico_vote_down",downActive:"ico_vote_down_on"},s=function(e){return'<div class="red">'+e+"</div>"};$("#main_wrap").on("click",".js-vote_btn",function(e,t){var i,o,c,n,s,a,l,d,r,g,_,p,u,v,k,f,h,b,m,w,C,D,O,j;if(e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),(c=(o=(i=$(this)).data()).type)+"_"+(n=o.vote_id),s=$("#"+n+"_voteUp"),a=$("#"+n+"_voteDown"),l=s.data(),d=a.data(),r=c<0?s:a,g=c<0?l:d,_=$("#subscribe_offer_"+o.ot+"_"+o.oid),p=$("#share_offer_"+o.ot+"_"+o.oid),u=function(){$("#vote_err_"+n).addClass("hide"),clearTimeout(A)},v=function(e){var t=$("#vote_err_"+n);t.length||(t=i.parents(".js-action_bar").find(".js-vote_error")),t.length&&!ge("#Gallery")?(t.removeClass("hide").html(e),A=setTimeout(u,4e3)):Spaces.showMsg(e,{gallery:!0,type:"alert"})},t&&t.ignore||u(),o.mode=o.mode||"default",k=i.data("binded"))$("#"+k+(c<0?"_voteDown":"_voteUp")).click();else{if(Spaces.params.nid)return o.ot==Spaces.TYPES.EXTERNAL_VIDEO?(f=c<0?L(""):L(""),void v(L("   {0}.",f))):void(o.privatePhoto&&c<0?v(L("   .")):o.disabled?v(L("     .")):(b={CK:null,Oid:o.oid,Ot:o.ot,from:o.from,Visit:o.visit,Widgets:0<_.length&&o.subscr,Link_id:Spaces.params.link_id},m=!1,o.clicked?(--o.cnt,h="neoapi/voting.delete",o.clicked=!1):r.data("clicked")?(++o.cnt,--g.cnt,h="neoapi/voting.like",b.Down=c<0?1:0,o.clicked=!0,g.clicked=!1,m=!0):(++o.cnt,h="neoapi/voting.like",b.Down=c<0?1:0,o.clicked=!0),l=l||{cnt:0},d=d||{cnt:0},w=$("#vote_up_cnt_"+n).text(l.cnt),C=$("#vote_down_cnt_"+n).text(d.cnt),w.data("hideable")&&w.toggle(0<l.cnt),C.data("hideable")&&C.toggle(0<d.cnt),D=-d.cnt+l.cnt,$("#"+n+"_voteFullCnt").text(D).toggleClass("red",D<0).toggleClass("green",0<D),s.attr("title"," "+l.cnt),a.attr("title"," "+d.cnt),_.length&&_.addClass("hide"),p.length&&p.toggleClass("hide",!l.clicked),"old_button"==o.mode?(s.children().toggleClass("on",!!l.clicked),a.children().toggleClass("on",!!d.clicked)):"default"==o.mode&&(s.find(".ico_abar").toggleClass(E.up,!l.clicked).toggleClass(E.upActive,!!l.clicked),s.find(".action-bar_cnt").toggleClass("action-bar_cnt_on",!!l.clicked),a.find(".ico_abar").toggleClass(E.down,!d.clicked).toggleClass(E.downActive,!!d.clicked),a.find(".action-bar_cnt").toggleClass("action-bar_cnt_on action-bar_cnt_on_red",!!d.clicked)),O=$("#voted_"+o.ot+"_"+o.oid),d.clicked||O.addClass("hide"),s.trigger("like",{polarity:d.clicked?-1:l.clicked?1:0,plus:l.cnt,minus:d.cnt}),l.clicked&&(j=p.parents(".widgets-group")).length&&p.insertAfter(j),t&&t.ignore||Spaces.api(h,b,function(e){var t,i,o;0==e.code&&e.warn&&v(e.warn),0==e.code&&d.clicked&&O.removeClass("hide"),0!=e.code&&e.code!=Codes.VOTING.ERR_VOTE_NOT_FOUND&&(v(Spaces.apiError(e)),l.clicked?m?a.trigger("click",[{ignore:!0}]):s.trigger("click",[{ignore:!0}]):d.clicked&&(m?s.trigger("click",[{ignore:!0}]):a.trigger("click",[{ignore:!0}]))),_.length&&e.widgets&&e.widgets.author&&((t=_.parents(".widgets-group")).length&&_.insertAfter(t),_.find(".js-subscribe_offer_object").html(e.widgets.author),_.find(".js-subscribe_offer_button").html(e.widgets.subscr_link),_.removeClass("hide")),(o=(i=$("#vote_up_list_"+n)).prop("slider"))&&(o.resetItems(),i.is(":visible")&&o.firstLoad())})));v(Spaces.view.onlyAuthMotivator())}}).on("click",".js-show_likes",function(e){var t,i,o,c,n;e.preventDefault(),i=(t=$(this)).data("id"),o=i.split("_"),(c=$("#vote_up_list_"+i)).is(":visible")?c.hide():(n=c.prop("slider"))?(n.update().firstLoad(),c.show()):require("slider",function(){var e=$('<div data-bg="0">');c.append(e).show(),(n=e.carousel({hasMore:!0,firstLoad:!0,gallery:!1,limit:30,apiMethod:"neoapi/voting.users",apiData:{Oid:o[1],Ot:o[0]},apiResult:"users",metric:"likes_users_list"})).on("loadError",function(e){n.resetItems().insert($(s(e.message))).update()}),c.prop("slider",n)}),t.toggleClass("js-clicked",c.is(":visible"))})});define("files_monitor","init",function(){function v(t){var e=t.prop("tagName");return e&&/^textarea|input$/i.test(e)}function t(){var r,i,p,l=!1;d&&(i=$("#main"),$("body").on("dragover.oneRequest",function(t){var e,a,n=t.originalEvent;if(o(n.dataTransfer.types)){for(t.preventDefault(),e=0;e<f.length;++e)(a=f[e]).addClass(a.data("dragavail-class"));l||i.trigger("dragGlobalStart"),l=!0,r&&(clearTimeout(r),r=null)}}).on("dragleave.oneRequest drop.oneRequest",function(t){var e=t.originalEvent;o(e.dataTransfer.types)&&("drop"==t.type&&e.preventDefault(),!1,r||(r=setTimeout(function(){var t,e;for(t=0;t<f.length;++t)(e=f[t]).removeClass(e.data("dragavail-class"));r=null,l&&i.trigger("dragGlobalEnd"),l=!1},u)))}),g&&document.addEventListener&&(p=function(t){0<t.length&&y.el.trigger("pasteurl",{urls:t,target:y.el,fromInput:v(y.el)})},document.addEventListener("paste",function(e){var a,n,r,i,l,s,o,f,d,g,u,c=e.clipboardData;y&&((a=m(c))?(e.preventDefault(),y.el.focus(),y.el.trigger("ffpastefiles",{files:a}),y=null):0<=$.inArray("text/plain",c.types)?(e.preventDefault(),r=h(n=c.getData("text/plain")),p(r),v(y.el)&&(y.el.focus(),f=n,d=(o=y).el.val(),g=d.substring(0,o.start),u=d.substring(o.end,d.length),o.el.val(g+f+u),set_caret_pos(o.el[0],o.start+f.length,o.start+f.length)),y=null):0<=$.inArray("text/html",c.types)?(e.preventDefault(),(i=c.getData("text/html"))&&(l=i.match(/<img[^>]+src="(http(s?):([^"]+))"/im))&&(r=h(l[1]),p(r)),y=null):(s=y.el,y=null,x.focus(),function t(e,a,n){var r=e.find("img");if(e.length&&0<n){if(!r.length)return void setTimeout(function(){t(e,a,--n)},20);a&&a(r.attr("src"))}e.empty()}(x,function(t){if(s.focus(),0==t.indexOf("http"))p(h(t));else{var e=function(t){var e,a,n,r,i,l,s=";base64,";if(t&&"data:"==t.substr(t,5).toLowerCase()&&-1<t.indexOf(s)){for(a=(e=t.split(s))[0].split(":")[1],n=atob(e[1]),r=new Uint8Array(n.length),i=0,l=n.length;i<l;++i)r[i]=n.charCodeAt(i);return new Blob([r],{type:a})}return null}(t);e&&s.trigger("ffpastefiles",{files:[e]})}},20)))},!1)))}function h(t){var e,a,n,r=[],i=/^http(s?):\/\//i;for(l.lastIndex=0;t&&(e=l.exec(t));)n=e[(a=e[4]?0:e[11]?7:14)+2],i.test(n)||(n="http://"+n),r.push({url:n,domain:e[a+4]});return r}function m(t){var e,a,n,r;if(t){if(t.files&&0<t.files.length)return t.files;if("items"in t&&t.items){for(e=[],a=0;a<t.items.length;++a)"file"==(n=t.items[a]).kind&&n.getAsFile&&(r=n.getAsFile(),e.push(r));if(0<e.length)return e}}if((t=window.clipboardData)&&t.files&&0<t.files.length)return t.files}function o(t){return(-1<$.inArray("Files",t)||-1<$.inArray("application/x-moz-file",t))&&$.inArray("text/_moz_htmlcontext",t)<0}var y,f=[],e=-1!=navigator.platform.indexOf("Mac"),d="ondragover"in document.body,g="firefox"==Device.browser&&window.atob,i=".spdnd"+Date.now(),u=300,a=["xn--p1ai|xn--j1amh|xn--80asehdb|xn--80aswg","|||||su"],n="([!()?.,\\s\\n\\r]|^)",r="(?:[.!:;,*()]*([\\s\\r\\n]|$))",l=RegExp("(?:"+n+"((https?://)?((?:[a-z0-9_\\-]+\\.)+(?:[a-z]{2,7}|"+a[0]+"))(/.*?)?(\\#.*?)?)"+r+"|"+n+"((https?://)?((?:[a-z0-9-_\\-]+\\.)+(?:"+a[1]+"))(/.*?)?(\\#.*?)?)"+r+"|"+n+"((https?://)((?:[a-z0-9-_\\-]+\\.)+(?:[a-z]{2,7}|"+a[1]+"))(/.*?)?(\\#.*?)?)"+r+")","gi"),x=$('<div contenteditable="true" style="position:fixed;width:1px;height:1px;opacity:0;overflow:hidden"></div>');Spaces.checkUrl=function(t){l.lastIndex=0;var e=l.exec(t);return!(!e||0!==$.trim(t).indexOf($.trim(e[0])))},Spaces.extractUrls=h,$.fn.filesMonitor=function(){var s,a,n,r,t=arguments;return 1<this.length?(this.each(function(){$.fn.draggable.apply($(this),t)}),this):(n=!1,(s=this).data("inited"+i)||(s.data("inited"+i,!0),f.push(s),d&&s.on("dragenter"+i,function(t){o(t.originalEvent.dataTransfer.types)&&t.preventDefault()}).on("dragover"+i,function(t){var e=t.originalEvent;a&&(clearTimeout(a),a=null),o(e.dataTransfer.types)&&(t.preventDefault(),n||s.trigger("fileDragStart"),n=!0,s.addClass(s.data("dragover-class")),s.removeClass(s.data("dragleave-class")))}).on("dragleave"+i,function(t){t.originalEvent;a||(a=setTimeout(function(){n&&s.trigger("fileDragEnd"),n=!1,s.removeClass(s.data("dragover-class")),s.addClass(s.data("dragleave-class"))},u))}).on("drop"+i,function(t){var e=t.originalEvent;0<e.dataTransfer.files.length&&!e[i]&&(t.preventDefault(),s.trigger("fileDragEnd"),s.trigger("dragGlobalEnd"),s.trigger("files",{files:e.dataTransfer.files}),n=!1,s.removeClass(s.data("dragover-class")),s.removeClass(s.data("dragleave-class")),e[i]=!0)}),g?(r=function(t){if(!y||1e3<=Date.now()-y.time){var e=t.target;y={el:$(e),start:e.selectionStart,end:e.selectionEnd,time:Date.now()},x.focus()}},s.on("keydown"+i,function(t){(e?t.metaKey:t.ctrlKey)&&86==t.keyCode&&r(t)}).on("ffpastefiles"+i,function(t,e){s.trigger("files",{files:e.files})}).on("paste"+i,function(t,e){$(t.target).data("no_paste")||r(t)})):s.on("paste"+i,function(t,e){var a,n,r,i,l=$(t.target);if(!l.data("no_paste"))if(a=t.originalEvent.clipboardData||window.clipboardData,n=m(a))t.preventDefault(),tick(function(){s.trigger("files",{files:n})});else if(a&&(!a.types||0<=$.inArray("text/plain",a.types)||0<=$.inArray("Text",a.types))){try{r=a.getData("text/plain")}catch(t){}if(!r)try{r=a.getData("Text")}catch(t){}0<(i=h(r)).length&&s.trigger("pasteurl",{urls:i,target:l,fromInput:v(l)})}}),s.on("spacpaste"+i,function(t){var e,a=h($(this).val());0<a.length&&(e=$(t.target),s.trigger("pasteurl",{urls:a,target:e,fromInput:v(e)}))})),s)},define("files_monitor","onRequest",function(){t(),page_loader.on("shutdown","files_monitor",function(){d=[],f=[],y=null}),g&&$("#main").append(x)})});define("min_height","init",function(){var n;Spaces.fixHeight=function(t){t&&t.addClass("js-fix_height");var i=$("#main_content"),e=(i.outerHeight(),i.offset().top),h=0;n=0,$(".js-fix_height").each(function(){var t=$(this);t.offset()&&(h="fixed"==t.css("position")?Math.max(h,t.outerHeight(!0)):Math.max(h,t.outerHeight(!0)+(t.offset().top-e)+(t.data("ypad")||0)),++n)}),i.css("min-height",h)},define("min_height","onRequest",function(){n&&Spaces.fixHeight()})});define("dd_menu","init",function(){function t(e,t){function n(){!function(){var e,t,n,i,o,a,s,d,r,l;if(!g)return;e=30,t=$("#Gallery");{if(t.length&&u.data("in_gallery"))return n=GALLERY.getGalleryRect(),i=u.data("small_screen"),x||(i=Math.min($(window).height(),$(window).width())<360,u.data("small_screen",i),GALLERY.lock(!0),u.data("gallery_state",{fullscreen:GALLERY.isFullscreen(),small:i}),i?(t.hide(),t.before(u)):t.append(u),x=!0),i?u.css({marginTop:0,position:"static",minHeight:n.rh+"px",boxSizing:"border-box"}).show():(o=u.data("gallery_state"),a=$(window).height()<400||o.fullscreen,GALLERY.isFullscreen()!=a&&GALLERY.toggleFullscreen(a),u.css({position:"absolute",left:0,right:0,bottom:n.rh-(n.h+n.y),marginTop:0,maxHeight:n.h+"px",minHeight:0,boxSizing:"border-box",top:"auto"}).show());if("bottom"==g)return s=u.css({top:0}).show().offset().top,d=_.offset().top-s+_.height()-e,u.css({bottom:d+"px",top:"","margin-bottom":0});if("page_top"==g||"fullpage_top"==g)return x||(C=u.show().outerHeight()-y.outerHeight(),x=!0),r=$(window).height()-C,u.show().css({top:u.css("margin-top")}),"page_top"==g&&y.css("height",r+"px");"opener_top"==g?e=-_.height():"top"==g?e=0:"abs_val"==g&&(e=0)}b?(d=_.offset().top-e-v,x?u.offset({top:d-u.outerHeight()}):(u.css({visibility:"visible",opacity:0,filter:"alpha(opacity=0)"}).show(),tick(function(){u.offset({top:d-u.outerHeight()}).css({visibility:"",opacity:"",filter:""}),x=!0}))):"fixed"==w?(x||(u.show(),C=u.innerWidth()-u.width(),x=!0),u.css({position:"fixed",height:"",left:j.offset().left+"px",width:u.parent().parent().innerWidth()-C}).show().offset({top:"abs_val"==g?_.data("position_top_val"):_.offset().top+_.height()+v+e})):P.data("global")?(l=_.offset().top+_.outerHeight()+20,u.show().offset({top:l}),l>u.offset().top&&u.offset({top:l+(l-u.offset().top)})):(s=u.css({top:0}).show().offset().top,d=_.offset().top+_.height()-s+v+e,u.css({top:d+"px"}))}(),u.data("events")&&u.trigger("dd_menu_resize")}var i,o,a,s,u,d,r,l,p,c,f,_,m,h,g,w,v,x,b,y,j,k,D,C,L,S,P=$(this);t&&t.ignoreEvent||P.data("disabled")||((i=Spaces.DdMenu.current())&&$.contains(P[0],i[0])&&e.ajaxify?console.warn("dd_menu in dd_menu link!"):(P.data("nocancel")||e.preventDefault(),o=P.hasClass("js-delete-confirm"),a=P.attr("id"),s=$.trim(P.data("menu_id")),u=$("#"+s),d=P.data("inner"),P.data("city_prefix")||!1,P.data("no_bottom_fix")||!1,P.data("allow_only")||!1,r=P.hasClass("js-add-friend"),$(".js-dd_menu_link"),l=$(P.data("om_margin")?P.data("om_margin"):[]),p=P.data("position_rel")?$(P.data("position_rel")):P,u.data("disabled")||(P.data("global")&&Spaces.view.pushWidget(u,P.data("globalPersist")),A=P.data("custom_class"),u.prop("menuOpener",P),(c=H())&&(f=c.position()),(_=o&&_||p)||(_=$('data-menu_id="'+s+'"')),(m=c&&c.attr("id")==s)&&(h=jQuery.Event("dd_menu_toggle"),u.trigger(h,{link:_,sameLink:u.data("menu_opener")&&_[0]==u.data("menu_opener")[0]}),h.isDefaultPrevented())||m&&P.data("notoggle")||G()&&!m&&(u.data("menu_opener",_),h=jQuery.Event("dd_menu_open"),u.trigger(h),h.isDefaultPrevented()?u.removeData("menu_opener"):(u.data("menu_opened",!0),R(c=u)&&Spaces.view.pushWidget(u.data("position",1)),R(P)&&(_=i.data("menu_opener")),A&&P.addClass(A),d&&$("#"+d).addClass("drop-down-list_inner_open"),_.addClass("js-clicked "+(P.data("noclass")?"":"clicked")),g=P.data("position")||u.data("position"),w=P.data("position_method")||u.data("position_method"),v=+(_.data("fix_position")||P.data("fix_position")||u.data("fix_position")||0),x=!1,b="before"==P.data("menu_pos"),y=u.find(".js-ddmenu_content"),j=$("#siteContent"),(k=u.data("place"))&&((D=$(k)).length||alert(k+" not found"),D.append(u)),u.data("spoiler")&&(g=null),"page_top"==g&&M.push(function(){y.css("height","")}),"fixed"==w&&M.push(function(){u.css({position:"",height:"",left:"",width:""})}),(L=$(window)).scrollTop(),L.on((u.data("scroll")?"scroll.fix_scroll_ddmenu ":"")+"resize.fix_scroll_ddmenu",function(e){u.data("menu_opened")&&(n(),Spaces.DdMenu.fixSize())}),L.on("fixDdMenuPos.fix_scroll_ddmenu",function(e){u.data("menu_opened")&&n()}),o?(P.data("noposition")||u.css({top:f.top+"px"}),u.show()):"new_status_btn"==a?($("#new_status_ta").select(),u.show()):(g?n():u.show(),!0===r&&"desktop"==Device.type&&u.find(".text-input:first").focus()),"operamini"==Device.browser&&l.length&&(l.css("margin-bottom",u.height()+30),M.push(function(){l.css("margin-bottom","")})),c.trigger($.Event("dd_menu_opened")),_.trigger("dd_menu_opened"),E(c,!0),$("body").on("click.ddmenu",function(e){if(u.data("menu_opened")){if(e&&e.target&&e.target.ajax_upload_button)return;if(Loader.loaded("draggable")&&$.draggableNoClick())return;G()}}),Spaces.DdMenu.fixSize(),u.data("spoiler")&&(g=null,u.parents(".js-multi_spoiler_inject").find(".spoiler_inject").removeClass("spoiler_inject-chain").each(function(){var e=$(this);S&&S.toggleClass("spoiler_inject-chain",!(!S.is(":visible")||!e.is(":visible"))),S=e})))))))}function E(e,t){var n=e.prop("menuOpener");n&&(n.find(".js-dd_menu_state_open").toggleClass("hide",!t),n.find(".js-dd_menu_state_close").toggleClass("hide",!!t))}function G(e){var t,n,i,o,a=H();if(!a||e&&e!=a.attr("id"))return!0;if(E(a,!1),$("#main_content").css("min-height",0),t=jQuery.Event("dd_menu_close"),a.trigger(t),t.isDefaultPrevented())return!1;for((n=a.data("gallery_state"))&&(GALLERY.lock(!1),n.small?($("#Gallery").show(),GALLERY.onResize()):n.fullscreen||GALLERY.toggleFullscreen(!1)),a.prop("menuOpener",null),a.data("menu_opened",!1),$(".drop-down-list_inner").removeClass("drop-down-list_inner_open"),$(".js-dd_menu_link").removeClass("js-clicked clicked "+A),a.hide(),A="",$("body").off(".ddmenu"),$(window).off(".ddmenu").off(".fix_scroll_ddmenu"),a.trigger("dd_menu_closed"),(i=a.data("menu_opener"))&&i.trigger("dd_menu_closed"),o=0;o<M.length;++o)M[o]();return M=[],!(a=null)}function H(){var e,t,n=$(".dropdown-menu__wrap:visible, .js-dd_menu_item:visible");for(t=0;t<n.length;++t)n[t].getAttribute("skip")||(e=$(n[t]));return e&&e.length?(e.data("menu_opened",!0),e):null}function R(e){return 0<e.parents(".dropdown-menu__wrap, .js-dd_menu_item").length}var A="",M=[],n=function(e){return'<div class="js-dd_menu_item" id="'+e.id+'"><div class="widgets-group'+(e.flat?" dropdown-menu":"")+' js-ddmenu_content"></div></div>'};define("dd_menu","onRequest",function(){$("body").off(".ddmenu"),$(window).off(".ddmenu").off(".fix_scroll_ddmenu")}),$("body").on("focus click",".js-dd_menu_link_focus",function(e){if("click"==e.type)return e.stopPropagation(),void e.preventDefault();t.apply(this,arguments)}),$("body").on("click",".js-dd_menu_link, .js-delete-confirm",t),$("body").on("click",".js-dd_menu_item",function(e){e.ajaxify||(e.stopPropagation(),e.stopImmediatePropagation())}),$("body").on("click",'.js-dd_menu_close, .js-cancel, .js-cancel a, a[data-action="cancel"]',function(e){e.stopPropagation(),e.preventDefault(),G()}),$("body").on("click",".js-confirm_yes",function(e){e.stopPropagation(),e.preventDefault(),$("#"+$(this).data("id")).trigger("confirm"),G()}),$("body").on("click",".js-confirm_cancel",function(e){e.stopPropagation(),e.preventDefault(),$("#"+$(this).data("id")).trigger("cancel"),G()}),Spaces.DdMenu=Class({Constructor:function(e){var t=this;t.opts=$.extend({id:"ddmenu_"+Date.now(),data:{},persist:!1,flat:!0},e),t.id=t.opts.id,t.menu=$(n({id:t.opts.id,flat:t.opts.flat})),t.menu.toggleClass("user__dropdown-menu dropdown-menu__wrap",!t.opts.data.spoiler).hide(),t.opts.data&&t.menu.data(t.opts.data),t.menu_content=t.menu.find(".js-ddmenu_content"),t.opts.data.spoiler||Spaces.view.pushWidget(t.menu,t.persist)},Static:{fixSize:function(){var a,e=H();e&&(Spaces.DdMenu.fixPos(),a=0,e.find("textarea").each(function(){var e,t,n=this,i=$(n),o=i.height();(e=i.data("max_textarea_h"))||(e=(t=i.innerHeight())/n.rows*6+(o-t),n.style.maxHeight=e+"px",i.data("max_textarea_h",e)),a+=i.data("max_textarea_h")-o}),Spaces.fixHeight(e.data("ypad",a)))},fixPos:function(){$(window).trigger("fixDdMenuPos")},findOpeners:function(e){return $('.js-dd_menu_link[data-menu_id="'+e+'"]')},currentId:function(){var e=H();return e?e.attr("id"):null},current:function(){return H()},close:function(e){G(e)},isOpen:function(e){var t=H();return t&&(!e||t.attr("id")==e)}},content:function(){return this.menu_content},element:function(){return this.menu},opener:function(){return this.menu.data("menu_opener")},on:function(e,t){return this.menu.on("dd_menu_"+e,t),this},link:function(e,t){return e.data($.extend({menu_id:this.id,position:!0,noclass:!0},e.data(),t)),e.attr("data-menu_id",this.id).addClass("js-dd_menu_link"),e.data("no_label")||("before"==e.data("menu_pos")?e.addClass("triangle-show").addClass("triangle-show_top"):e.addClass("drop-down-label")),this},openAs:function(e,t){var n=this;return n.dummy_link||(n.dummy_link=$("<a>",{"class":"js-dd_menu_link hide"}),n.menu.parent().append(n.dummy_link)),n.dummy_link.removeData().data($.extend({menu_id:n.id,position:!0,noclass:!0,position_rel:e},t)),tick(function(){n.dummy_link.click()}),n},open:function(e){return Spaces.DdMenu.findOpeners(this.id).first().click(),this},close:function(){return G(this.id),this}})});define("gallery","init",function(){function p(e){return e.gallery_cache_id&&ue[e.gallery_cache_id]||Spaces.File.getMeta(e)}function P(){ke||(ke=!0,setTimeout(function(){ke=!1},130))}function Y(e,a,t,i,r,l,o){var n=Math.max(r*a-e.w,0)/2,s=Math.max(l*a-e.h,0)/2,g=n<Math.abs(t),c=s<Math.abs(i);return o&&(n<t?t=o?n:t+(n-t)/te:t<-n&&(t=o?-n:t-(n+t)/te)),s<i?i=o?s:i+(s-i)/te:i<-s&&(i=o?-s:i-(s+i)/te),z<a?a=o?z:a+(z-a)/te:a<1&&(a=o?1:a+(1-a)/te),{x:t,y:i,overX:g,overY:c,scale:a}}function r(e,a,t){var i,r=new Image;return r.src=e,r.id=a,r.className="gallery__image",D(i=$(r),e,t),i}function Z(e,a,t){var i=r(a,e.attr("id"),e.parent());return e.replaceWith(i),i}function D(e,a,t){if(!oe)return a===undefined?a=ICONS_BASEURL+"preloader_dark.gif":ce[a]=!0,void e.prop("src",a);if(a===undefined)return e.prop("src",A).removeData("o_src"),void c(e,t);var i=e[0],r=$.data(i,"o_src");$.prop(i,"src");if(r!=a){if(!ce[a])return i.src=A,$.data(i,{src:a,o_src:a}),c(e,t),void s(a);i.src=a,$.data(i,"o_src",a)}ce[a]&&c(e,t)}function l(e,a){var t,i=de[e];if(i){for(t=0;t<i.length;++t)i[t](e,a);delete de[e]}}function s(e,a){var t,i;if(a&&(de[e]||(de[e]=[])).push(a),ce[e])l(e,!0),d(e);else{if(t=Date.now(),ge[e]&&t-ge[e]<1e3)return;delete se[e],ge[e]=Date.now(),(i=new Image).onload=function(){i=null,ce[e]={width:this.width,height:this.height},d(e),l(e,!0),delete ge[e],se[e]&&(delete se[e],X&&De.update(!0))},i.onerror=function(){i=null,delete ge[e],ce[e]||(se[e]=!0,X&&De.update(!0)),l(e,!1)},i.src=e,i=null}}function o(e,a,t,i){return t<e||i<a?a<e?[+t,Math.round(t/e*a)]:[Math.round(i/a*e),+i]:[+e,+a]}function n(e,a,t,i){var r=e/a;return i<a&&(e=(a=i)*r),t<e&&(a=(e=t)/r),[Math.round(e),Math.round(a)]}function g(e){if(e){var a=e.match(/\.\w+\.(\d+)\.(\d+)/);return a&&[a[1],a[2]]}}function W(e,a,t){var i=e.offset();return!!(i&&a>=i.left&&a<=i.left+e.outerWidth()&&t>=i.top&&t<=i.top+e.outerHeight())}function c(e,a){var t=!ce[e.data("o_src")];!t&&e.data("src")&&(e.prop("src",e.data("src")),e.removeData("src").removeAttr("width").removeAttr("height")),(a||e.parent()).toggleClass("gallery-img_loading",!!t)}function d(e,a){var t,i;for(t=0;t<C;++t)(i=$("#gallery_img_"+t)).data("o_src")==e&&c(i)}function E(){var e=a();return{x:0,y:b?0:k,h:e-(b?0:k+I),rh:e,w:U.innerWidth()}}function x(){return a()-(b?0:k+I)}function a(){return j?screen.availHeight:$("#Gallery").height()}function u(e,a){return e-Math.floor(e/a)*a}var X,H,N,b,O,_,U,m,f,y,h,t,A=ICONS_BASEURL+"transparent.gif",k=50,I=50,v="ucbrowser"==Device.type,w=50,M=1,S=2,V=66,C=3,i="rgba(69, 69, 69, 0.95)",z=3,q=.212,B=300,K=300,J=150,G=200,Q=9,ee=100,ae=.35,te=1.5,ie=1.5,re=5,T=[["ico_gallery_vote_up","ico_gallery_vote_up_on"],["ico_gallery_vote_down","ico_gallery_vote_down_on"]],j=""+window.operamini=="[object OperaMini]",R=!cookie.get("gal_no_transp")&&Device.css("box-shadow","0px 0px 0px #000",/\d\w/),le="desktop"==Device.type&&R,F=!!navigator.userAgent.match(/(MSIE 7.0|Opera Mini)/i)||j,oe=!F&&$.support.nativeAnim&&!("firefox"==Device.browser&&"touch"==Device.type),ne=oe,se=(Device.type,{}),ge={},ce={},de={},_e={},me={},ue={},pe={},fe={},ye={},he={},ve=0,we=0,xe=0,be=0,$e=[!1,!1,!1],ke=!1,Ie=!1,Me=!1,Se=!1,Ce=!1,Le={playerStub:function(e){return'<div class="player-dummy_wrap" id="galleryVideoStub"><div class="player-dummy"><img src="'+e.preview+'" alt="" /></div></div>'},gallery:function(e){var a=j?"a":"div",t=(e.arrowSmall,e.arrowSmall,'<div id="Gallery" class="gallery'+(F?" not_centered":"")+'"><div class="gallery__page_shadow"></div><div class="gallery__shadow"></div><'+a+' class="gallery__side gallery__side_prev js-gallery_arrow" data-dir="-1" href="#gprev"><div class="gallery__side-arrow ico_gallery ico_gallery_arrow_left"></div></'+a+"><"+a+' class="gallery__side gallery__side_next js-gallery_arrow" data-dir="1" href="#gnext"><div class="gallery__side-arrow ico_gallery ico_gallery_arrow_right"></div></'+a+'><div class="gallery__fs_header"><div class="gallery__fs_btn js-gallery_cnt"></div><a class="gallery__fs_btn right js-gallery_fullscreen" href="#fullscreen"><span class="ico_gallery ico_gallery_exit"></span></a></div><div class="gallery__loader"></div><div class="gallery__header" id="gallery_tools"><table class="gallery_cnt-table"><tr><td><div class="gallery_cnt js-gallery_cnt"></div></td></tr></table><div class="gallery__header_inner"><a class="gallery__tools_button" href="" target="_blank" rel="noopener" id="g_dloadlink"><span class="ico_gallery ico_gallery_download m"></span></a><div class="gallery__tools_place">&nbsp;</div>'+("desktop"==Device.type?'<a class="gallery__tools_button" href="#zoom" id="gallery__zoom"><span class="ico_gallery ico_gallery_zoom m"></span></a><a class="gallery__tools_button js-gallery_fullscreen" href="#fullscreen"><span class="ico_gallery ico_gallery_fullscreen m"></span></a>':"")+'<a class="gallery__tools_button" href="#gallery_exit" id="gallery__exit"><span class="ico_gallery ico_gallery_exit m"></span></a></div></div>'+(F?'<table class="gallery__wrapper" id="Gallery__wrapper"><tr><td>':"")+'<div id="gallery-container" class="accel-3d"><div id="gallery_close_msg"><span id="gallery_close_text">'+Le.closeMsg()+'</span><span id="gallery_closed_text">'+Le.closeMsg(!0)+'</span></div><div id="gallery_img_0_wrap" class="gallery-anim_hide gallery__image-wrapper accel-3d gallery-sibling"><img src="'+A+'" alt="" id="gallery_img_0" class="gallery__image" /><div class="gallery__error gallery__image"></div></div><div id="gallery_img_1_wrap" class="gallery-anim_hide gallery__image-wrapper accel-3d"'+(F?' style="margin: 0"':"")+'><img src="'+A+'" alt="" id="gallery_img_1" class="gallery__image" /><div class="gallery__error gallery__image"></div><center id="galleryVideo"></center></div><div id="gallery_img_2_wrap" class="gallery-anim_hide gallery__image-wrapper accel-3d gallery-sibling"><img src="'+A+'" alt="" id="gallery_img_2" class="gallery__image" /><div class="gallery__error gallery__image"></div></div></div>'+(F?"</td></tr></table>":"")+(j||"desktop"==Device.type?"":'<div class="gallery__descr hide" id="gallery_descr_wrap"><div class="gallery__descr_text" id="gallery_descr"></div></div>')+'<div class="gallery__footer" id="gallery_bottom"><table class="gallery__footer_table"><tr><td class="gallery__link"><a href="" id="g_advancepage"><span class="ico_gallery ico_gallery_mess"></span> <span id="g_commentCnt" class="gallery__link_text"></span></a></td><td class="first gallery__link" id="g_sharelink_inner"><a href="" id="g_sharelink" title="'+L("  ")+'"><span class="ico ico_plus_white"></span> <span id="g_shareCnt" class="gallery__link_text"></span></a></td>'+("desktop"==Device.type?'<td class="pointer js-descr_wrap"><div class="gallery__descr_text hide" id="gallery_descr_wrap"><div id="gallery_descr"></div></div></td>':"")+'<td class="gallery__link"><a href="#glup" class="js-vote_btn" data-type="1" mode="gallery"><span class="ico_gallery '+T[0][0]+'"></span> <span class="js-vote_btn_cnt gallery__link_text"></span></a></td><td class="last gallery__link"><a href="#gldown" class="js-vote_btn" data-type="-1" mode="gallery"><span class="ico_gallery '+T[1][0]+'"></span> <span class="js-vote_btn_cnt gallery__link_text"></span></a></td></tr></table></div><div class="gallery__loader_shadow"></div><div class="gallery__shadow_error" id="Gallery_error"></div></div>');return t},error:function(e){return'<div class="gallery-error_msg">'+e+"</div>"},loadError:function(e){return'<div class="gallery__error_inner">'+e.message+(e.action?'<br /><a href="#g-adult-show" class="gallery__button js-gallery_repeat" data-action="'+e.action+'"><span class="ico_gallery ico_gallery_reload m"></span> <span class="m">'+L("")+"</span></a>":"")+"</div>"},retry:function(){return'<div><a href="#g_retry" class="gallery__button"><span class="ico_gallery ico_gallery_reload m"></span> <span class="m">'+L("")+"</span></a></div>"},closeMsg:function(e){return e?L(",  ..."):L(",  ...")},adult:function(e){var a="video"==e.content?L(" "):L(" "),t='<div class="gallery__error_inner">'+L("!     ! ")+L(" &quot;{0}&quot;,  , ",a)+L("  18   .")+'<br /><a href="#g-adult-show" class="gallery__button js-adult"><span class="ico_gallery ico_gallery_eye m"></span> <span class="m">'+a+"</span></a></div>";return t},notif:function(e){return'<div id="gallery_notif"><div class="gallery__notif_inner word_break">'+e.text+'<a href="#gnc" class="gallery__notif_close"><span class="ico_gallery ico_gallery_exit js-gallery_notif_close"></span></a></div></div>'},collectionsMotivator:function(){return'<div class="t_center">     .   <span class="ico ico_plus_white ico_no-mrg m pointer js-gallery_collaction"></span></div>'}},De=new(Class({Implements:[TSimpleEvents],init:function(){var t=this;page_loader.ok()&&page_loader.onJSC("gallery",function(a){tick(function(){require("gallery",function(){if(a.match(/^[\/\d+\w+:_-]+$/)){var e=a.split("/");2==e.length&&t.open(e[0],e[1],!0)}})})},!0),page_loader.on("shutdown","removegallery",function(){me={},pe={},ue={},fe={},ye={},he={},t.off(!1)}),_e={},se={},ge={},ce={},$(".js-gallery_skip").each(function(){var e=$(this).find(".gview_link:first");e.length&&(_e[p(e).gid]=1)})},open:function(e,a,t,i){var r,l,o,n,s=this;if(a=+a,Device.android_app&&s.pullToRefresh(!1),t&&pe[e]&&(a=pe[e][a-(he[e]||0)]),H=null,X&&e==X.gid&&a==X.id)s.update();else{if(y=f=!1,r=!($e=[!1,!1,!1]),!X){if(ve=0,O=b=!1,Se=ke=Ie=!1,l=Date.now(),i||(we=$(window).scrollTop(),le||$("html, body").scrollTop(0)),r=!0,page_loader.ok()&&!t&&page_loader.setJSC(!1),!me[e]||!me[e][a])return void console.warn("[gallery] not found: "+e+"/"+a);U=$(Le.gallery({mode:"normal",id:l})),o="video"==me[e][a].content,U.toggleClass("gallery__touch","desktop"!=Device.type&&!j).toggleClass("gallery__om gallery__arrows_hide",j),(n=$("#Gallery")).length?n.replaceWith(U):($("#main_wrap").append(U),$("body").addClass(le?"gallery__transp_open":"gallery__open"),$("html, body").addClass("gallery__doc")),m=$("#gallery-container"),Me=!o&&"operamini"!=Device.browser&&(oe||"touch"==Device.type),o||s.initGestures(),Me&&(o||s.initMouseScale(),U.toggleClass("gallery-anim",oe),$("#gallery-siblings").removeClass("hide")),U.on("click",".js-gallery_collaction",function(e){e.preventDefault(),s.hideNotif(),h=!0,tick(function(){$("#g_sharelink").click()})}).on("click",".js-adult",function(e){e.preventDefault();$(this);$.each(me,function(e,a){$.each(this,function(){delete this.adult})}),s.update(!0),Spaces.api("neoapi/session.adultCheck",{passed:1}),X.showOnAdult&&(X.showOnAdult(),delete X.showOnAdult)}).on("click",".js-gallery_repeat",function(e){var a,t,i;if(e.preventDefault(),"img"==(a=$(this).data("action")))X.currImage=Z(X.currImage,X.item.image),s.update(!0);else if("loader"==a)for(t=fe[X.gid].callbacks,s.setGroupError(X.gid,!1),i=0;i<t.length;++i)t[i]()}).on("like",function(e,a){if(X){var t=X.item.like.split(",");t[0]=a.polarity,t[1]=a.plus,t[2]=a.minus,X.item.like=t.join(","),s.syncLikes()}}).on("click",".disabled",function(e){e.preventDefault();var a=$(this).find("a").attr("id"),t="video"==X.item.content?L(""):L(""),i={g_advancepage:L("  {0}  .",t),g_sharelink:Spaces.params.nid?L(" {0}    .",t):Spaces.view.onlyAuthMotivator()};Spaces.showMsg(i[a],{gallery:!0,type:"alert"})}).on("click",".js-gallery_notif_close",function(e){e.preventDefault(),$("#gallery_notif").find(".js-gallery_collaction").length&&(h=!0),s.hideNotif()}).on("click",".js-descr_wrap",function(e){e.preventDefault(),$("#g_advancepage").click()}),"operamini"!=Device.browser&&(Spaces.params.nid||cookie.enabled())&&U.on("click","#g_sharelink",function(e){var a,t,i=$(this);i.parents("td").hasClass("disabled")||(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),s.autoHideNotif(),h=!0,a=i.find(".ico"),t=function(){a.removeClass("ico_spinner"),FileCollections.open(X.item.type,X.item.extType,X.item.nid,"gallery")},Loader.loaded("collections")?t():(a.addClass("ico_spinner"),require("collections",t)))}),Date.now(),$(".js-gallery_arrow").on("click",function(e){if(e.preventDefault(),!ke&&1==X.scale){var a=+$(this).data("dir");s.move(a)}}),$(".js-gallery_fullscreen").on("click",function(e){e.preventDefault(),ke||(ke=!0,setTimeout(function(){ke=!1},300),O=!U.hasClass("gallery__fullcreen"),s.toggleFullscreen(O),U.toggleClass("gallery__fullcreen",O),s.onResize())}),$("#gallery__zoom").on("click",function(e){e.preventDefault(),ke||s.toggleZoom()}),$("#gallery__exit").on("click",function(e){e.preventDefault(),s.exit()}),$("#g_advancepage").on("click",function(e){var a=new Url(location.href),t=new Url(this.href);a.isSame(t)&&(e.preventDefault(),s.exit(!0))}),$("#main").on("like.gallery",function(){X&&s.syncLikes()}),$(window).on("keydown.gallery",function(e){var a=e.keyCode;Se&&a!=Spaces.KEYS.ESC||(e.preventDefault(),a==Spaces.KEYS.ESC?s.exit():a==Spaces.KEYS.UP?s.toggleZoom(!0):a==Spaces.KEYS.DOWN?s.toggleZoom(!1):a==Spaces.KEYS.LEFT?s.move(-1):a==Spaces.KEYS.RIGHT&&s.move(1))}).on("resize.gallery orientationchange.gallery",function(e){s.onResize()}),me[e].length<2&&U.addClass("one_image"),page_loader.on("requestend","removegallery",function(e){(!e||_&&location.hash!=_)&&s.exit(!0)},!0),page_loader.on("mailrequestend","removegallery",function(){s.exit(!0)},!0),j&&(location.hash="#GalleryTop"+l)}s.selectItem(e,a,r,!1,0,t),"video"==X.item.content&&U.find("#gallery__zoom, .js-gallery_fullscreen").remove(),s.blinkArrows()}},exit:function(e,a){var t,i=this;X&&(Device.android_app&&tick(function(){i.pullToRefresh(!0)}),U.draggable(!1),i.freeItem(),$("#main").off(".gallery"),$(window).off(".gallery"),a||($("body").removeClass("gallery__transp_open gallery__open"),$("html, body").removeClass("gallery__doc"),document.body.style.cssText="",U.remove(),U=m=null),page_loader.on("requestend","removegallery",!1),page_loader.on("mailrequestend","removegallery",!1),j&&(document.body.style.height="auto"),a||(le||((t=function(){$("html, body").scrollTop(we)})(),tick(t)),i._onGroupTrigger(X.gid,"exit",[])),X=null,Loader.loaded("collections")&&FileCollections.freeInstance("gallery"),!e&&page_loader.ok()&&history.back(),Device.android_app&&($("#pmb8876").remove(),$("#navi").append('<div id="pmb8876">')))},pullToRefresh:function(e){SpacesApp.exec("pullToRefresh",{enable:e}),SpacesApp.exec("fullscreen",{enable:!e,onlyHeader:!0}),SpacesApp.exec("sidebar",{enable:e})},initMouseScale:function(){var r,l,o,n,e,a,t,s=this;if(oe){for(t in n=function(){o=null;var e=Y(H,X.scale,X.imageX,X.imageY,r.w,r.h,!0);s.toggleSiblings(!1),s.setMoveAnim("transform","ease",K,function(){X.scale<=1&&s.toggleZoom(!1,!0)}),s.moveImage(e.x,e.y,e.scale)},a={onmousewheel:"mousewheel",onwheel:"wheel",DOMMouseScroll:"DOMMouseScroll"})if(t in document){e=a[t];break}U[0].addEventListener(e,function(e){var a,t,i;if(!Se&&(e.preventDefault(),e.stopPropagation(),(a=-e.deltaY||e.detail||e.wheelDelta)!==undefined&&s.canScale())){if(o)clearTimeout(o);else{if(t=X.currImage,!(r={h:t.width(),w:t.height()}).w||!r.h||!X)return;l=X.scale,s.setMoveAnim(!1),s.toggleZoom(!0,!0)}o=setTimeout(n,200),i=Y(H,l*=0<a?1.05:.95,X.imageX,X.imageY,r.w,r.h,!1),s.moveImage(i.x,i.y,i.scale)}},!1)}},initGestures:function(){var m,u,p,y,h,v,w,x,b,k,I,M,S,C,e,f,L,D,E,A,z=this,G=!0,T=0,j=1,R=2,F=T;type="none",k=!1,C=new Spaces.Inertia,e=function(){var e=Y(H,X.scale,X.imageX,X.imageY,M,S,!1);z.toggleSiblings(!1),z.setMoveAnim("transform","ease",K,function(){X.scale<=1&&z.toggleZoom(!1,!0)}),z.moveImage(e.x,e.y,e.scale)},U.draggable({disableContextMenu:!1,onlyEvents:!0,realtime:!0,scroll:le,detectZoom:!0,fastEvents:!0,forceStart:!0,calcRelative:!1,events:{zoomStart:function(){F!=R&&F!=T||(G||z.toggleZoom(!0,!0),G=!0)},zoomEnd:function(){!G||F!=R&&F!=T||e(),G=!1},dragStart:function(){F=T,Ie||!X||Se||(Ce=!(G=!1),z.setMoveAnim(!1),v=z.canMove(1),w=z.canMove(-1),m=X.imageY=X.imageY||0,u=X.imageX=X.imageX||0,p=X.scale,C.start(),f=L=0,D=E=0)},dragMove:function(e){var a,t,i,r,l,o,n,s,g,c,d,_;Ce&&X&&!Se&&(D=e.dX-f,E=e.dY-L,h=m,y=u,Me&&(F==T&&(a=Math.abs(D),t=Math.abs(E),i=!G&&1==X.scale,A=z.canScale(),(5<a||5<t||!i)&&(f=e.dX,L=e.dY,D=e.dX-f,E=e.dY-L,5<t&&a<=5&&i?(b=$("#gallery_notif, #gallery_bottom, #gallery_tools, #gallery_zoom, #gallery_descr_wrap"+(le?", .gallery__shadow":"")),F=j,oe&&((x={wrap:$("#gallery_close_msg").show(),closeMsg:$("#gallery_close_text").css("opacity","1"),closedMsg:$("#gallery_closed_text").css("opacity","0"),msg:null}).msg=x.closeMsg,b.cssAnim("opacity","ease-out",J).css("opacity",0),X.currImageWrap.css("overflow","visible"),k=!1,z.switchShadow(!0))):(F=R,r=z.getImageSize(),M=r[0],S=r[1])),z.toggleSiblings(F==R&&1==X.scale&&!G)),F==R?(l=X.scale,e.scale&&A&&(l=p*e.scale),1!=X.scale&&(h+=E),y+=!w&&0<=D||!v&&D<0?D/te:D,oe&&(o=Y(H,l,y,h,M,S,!1),z.moveImage(o.x,o.y,o.scale))):F==j&&(n=h+E/re,h+=E/ie,oe&&(k!=ee<=(s=Math.abs(h))&&(k=ee<s,x.msg[0].style.opacity=0,x.msg=k?x.closedMsg:x.closeMsg),g=x.msg[0].style,c=X.currImageWrap[0].style,d=Math.max(0,Math.min(s/(H.h/2),1)),c.opacity=(1-.4*d).toFixed(2),g=x.msg[0].style,_=Math.max(0,Math.min(s/ee,1)).toFixed(2),E<0?(g.top="-1em",n+=H.rh):g.top="0",g.opacity=_,x.wrap.transform({translate:[y,n]}),z.moveImage(y,h)),I=0<=E),C.add(y,h)))},dragEnd:function(e){var a,t,i,r,l,o,n,s,g,c,d,_,m,u,p,f;if(Ce&&X&&!Se){if(Ce=!1,C.end(),F!=T){if(P(),a=C.speed(),t=C.inertia(4.7),F==R)return i=H.w/2,t&&(1==X.scale?(y+=t.x,(r=.6*H.w)<y&&(y=r),y<-r&&(y=-r),z.moveImage(y,h)):(X.imageX+=t.x,X.imageY+=t.y)),l=Y(H,X.scale,X.imageX,X.imageY,M,S,!0),o=1==X.scale&&a.speedX<-q,n=1==X.scale&&a.speedX>q,s=1==X.scale||l.overX,void((y<-i||o)&&v&&s?z.move(1,!0,!0,!0):(i<y||n)&&w&&s?z.move(-1,!0,!0,!0):(z.setMoveAnim("transform, opacity","ease-out",B),z.moveImage(l.x,l.y,l.scale)));if(F==j&&(h=y=0,g=a.speedY,c=Math.abs(ve)<Q&&q<Math.abs(g)&&0<=g==I,oe)){if(x.wrap.hide(),k||c)return z.lockTouch(!0),z.setMoveAnim("transform, opacity","ease-out",J,function(){z.lockTouch(!1),z.exit()}),z.moveImage(0,I?H.h:-H.h),void X.currImageWrap.css("opacity",0);b.cssAnim().css("opacity",""),X.currImageWrap.css({opacity:"",overflow:""}),z.setMoveAnim("transform, opacity","ease-out",K,function(){z.toggleSiblings(!1)}),z.moveImage(y,h),z.switchShadow(!1)}}else if(!ke){if(X.item.gif&&Math.abs(D)<=10&&Math.abs(D)<=10&&(d=$("#Gallery").offset(),_=Math.max(V,H.w*ae)*X.scale,m=H.h*ae*X.scale,u=d.left+(H.x+H.w)/2-_/2+X.imageX,p=d.top+(H.y+H.h)/2-m/2+X.imageY,e.x>=u&&e.x<=u+_&&e.y>=p&&e.y<=p+m))return(!X.gif_time||500<Date.now()-X.gif_time)&&(X.currImage=Z(X.currImage,X.gifed?X.item.image:X.item.gif),z.moveImage(X.imageX,X.imageY,1),X.gifed=!X.gifed,X.gif_time=Date.now()),void P();f=!0,$(".js-gallery_arrow, .gallery__error_inner, #gallery_tools, #gallery_bottom, #gallery_notif").each(function(){if(W($(this),e.x,e.y))return f=!1}),le&&!W(U,e.x,e.y)&&(tick(function(){z.exit()}),f=!1),f&&"video"!=X.item.content&&(N||(N=setTimeout(function(){N=null,ke||Ce||(1==be?U&&("desktop"==Device.type?U.find(".js-gallery_fullscreen").click():O||z.toggleFullscreen()):2==be&&z.toggleZoom()),be=0},300)),++be)}X.inited||tick(function(){z.postSelectItem()})}}}})},toggleSiblings:function(e){!X.siblings!=!e&&(X.siblings=!!e)},setMoveAnim:function(e,a,t,i){if(oe&&Me&&X.currImageWrap)if(X.siblings)X.currImageWrap.cssAnim(!1),m.cssAnim(e,a,t,i);else if(m.cssAnim(e,a,t),X.fixZoom){var r=function(){var e=i;i=null,e&&e()};X.fixZoom.img.cssAnim(e,a,t,r),X.currImageWrap.cssAnim(e,a,t,r)}else X.currImageWrap.cssAnim(e,a,t,i)},moveImage:function(e,a,t){var i,r,l=this;if(oe&&Me){if(!1===e)return X.scale=1,X.imageY=X.imageX=0,X.currImageWrap.cssAnim(!1),void m.cssAnim(!1).transform({translate:[0,0]});if(e=Math.round(e),a=Math.round(a),i=X.scale,!(t&&t!==X.scale||X.imageY!=a||X.imageX!=e||X._fz!=!!X.fixZoom||X.invalidate))return X.currImageWrap.cssAnim(!1),void l.setMoveAnim(!1);delete X.invalidate,t&&(X.scale!=t&&(X.scale=t,l.recalcFrames(!1),l.toggleZoom(1!=X.scale,!0)),X.zoomDir!=1<=t&&(X.zoomDir=1<=t,U.toggleClass("gallery__zoom",X.zoomDir))),X.imageY=a,X.imageX=e,X._fz=!!X.fixZoom,(r=X.fixZoom)&&r.img.transform({translate:[r.x,r.y+a],scale:r.scale*X.scale}),X.siblings&&1==i?m.transform({translate:[e,0]}):(m.transform({translate:[e,0]}),X.currImageWrap.transform({translate:[0,a],scale:X.scale}))}},fixSiblings:function(){var e,a,t=this;t.syncErrors(),oe&&Me&&X?(e=me[X.gid],(a=t.getNeighbors(X.gid,X.id,!0))&&t.recalcFrames(undefined,e[a.next].image,e[a.prev].image)):"video"!=X.item.content&&X&&(X.currImage=Z(X.currImage,X.item.image))},getFrame:function(e){return oe?u(ve+1+((e=e||0)<0?2:0<e?-2:0),3):e<0?0:1<e?2:1},syncErrors:function(){var e,a=this,t=me[X.gid],i=a.getNeighbors(X.gid,X.id,!0),r=oe?[a.getFrame(-1),a.getFrame(0),a.getFrame(1)]:[a.getFrame()],l=t[i.prev],o=X.item,n=t[i.next],s=[!!l.adult,!!o.adult,!!n.adult],g=[!l.partial&&!!se[l.image],!o.partial&&!!se[o.image],!n.partial&&!!se[n.image]],c=[!!l.not_found,!!o.not_found,!!n.not_found],d=[!(!l.partial||!fe[X.gid]),!(!o.partial||!fe[X.gid]),!(!n.partial||!fe[X.gid])];for(e=0;e<3;++e)$e[r[e]]!=(c[e]||d[e]||s[e]||g[e])&&(c[e]?a.setImageError(r[e],Le.loadError({message:L("  ."),action:!1})):d[e]?a.setImageError(r[e],Le.loadError({message:fe[X.gid].errors.join("<br />"),action:"loader"})):g[e]?a.setImageError(r[e],Le.loadError({message:L("  .   ."),action:"img"})):a.setImageAdult(r[e],s[e]))},recalcFrames:function(e,a,t){var i,r,l,o,n,s,g,c,d,_,m;if(oe&&Me&&X&&H&&"video"!=X.item.content){for(i=this,l=u(r=ve+1,3),o=u(r-2,3),n=u(r+2,3),!1!==e&&i.moveImage(0,0),g=[-(s=1.05*H.w)-s/2*(X.scale-1),0,s+s/2*(X.scale-1)],c=[n,l,o],+(+X.scale).toFixed(2),d=0;d<3;++d)(e||c[d]!=l)&&$("#gallery_img_"+c[d]+"_wrap").transform({translate:[Math.floor(g[d]),0]});e?(_=$("#gallery_img_"+n),m=$("#gallery_img_"+o),e<0?Z(_,a):Z(m,t),X.currImage=$("#gallery_img_"+l),X.currImageWrap=$("#gallery_img_"+l+"_wrap")):(a||t)&&(D(X.currImage,X.item.image),D($("#gallery_img_"+o),a),D($("#gallery_img_"+n),t))}},update:function(e){var a,t,i,r,l,o=this;X&&(a=pe[X.gid],i=!(t=he[X.gid]||0),r=a.length+t>=ye[X.gid]||!ye[X.gid],i&&r?X.prev=X.next=1<a.length:(X.prev=0<X.n||!i,X.next=X.n+1<a.length||!r),l="video"==X.item.content,$(".js-gallery_arrow[data-dir=-1]").toggleClass("hide",!X.prev||l),$(".js-gallery_arrow[data-dir=1]").toggleClass("hide",!X.next||l),U.find(".js-gallery_cnt").text(L("{0}  {1}",t+X.n+1,Math.max(a.length,ye[X.gid]||0))),e&&(o.fixSiblings(),o.syncErrors()))},selectItem:function(e,a,t,i,r,l){var o,n,s,g,c,d,_,m,u,p,f,y,h,v,w,x,b,k,I,M,S,C=this;if(X&&e==X.gid&&a==X.id)C.update();else{if(C.freeItem(),C.toggleZoom(!1,!0),o=C.getNeighbors(e,a,!0),n=me[e],g="video"==(s=me[e][a]).content,c=pe[e].length,d=o.prev,_=o.next,m=X,X={gid:e,id:a,item:s,zoomed:!1,scale:1,siblings:!0,n:o.n},m&&!m.partial!=!s.partial)for(u=0;u<3;++u)C.setImageError(u,!1);if(C.update(),p=X.prev&&(Me&&X.prev||a!=d)&&n[d],f=X.next&&(Me&&X.next||d!=_)&&n[_],y=p?p.image:A,h=f?f.image:A,!g&&oe&&Me?j?(X.currImage=$("#gallery_img_1"),X.currImageWrap=$("#gallery_img_1_wrap"),X.currImage=Z(X.currImage,s.image),C.syncErrors()):t?tick(function(){var e,a,t;for(H||(H=E()),a=[-(e=1.05*H.w),0,e],t=0;t<3;++t)$("#gallery_img_"+t+"_wrap").transform({translate:[a[t],0]}).removeClass("gallery-anim_hide");X.currImage=$("#gallery_img_1"),X.currImageWrap=$("#gallery_img_1_wrap"),C.moveImage(!1),D($("#gallery_img_0"),y),D($("#gallery_img_2"),h),D(X.currImage,s.image),C.syncErrors()}):C.recalcFrames(r,y,h):(X.currImage=$("#gallery_img_1"),X.currImageWrap=$("#gallery_img_1_wrap"),$("#gallery_img_0").prop("src",y),g||(X.currImage=Z(X.currImage,s.image)),$("#gallery_img_2").prop("src",h),C.syncErrors()),g&&!X.item.partial&&(v=$("#galleryVideo").show(),w=$(X.item.el).find(".player_container:first").attr("id","GVP_"+Date.now()),x=w[0].id,X.playerId=x,v.fastHtml(Le.playerStub({preview:X.item.image})),w.data("preview",X.item.image),b=function(){if(X&&X.playerId==x&&!X.playerInited){v.on("vp_ready vp_resize",function(){C.onResize()});var e=vplayer(w);e.show(v[0].id).onReady(function(){"desktop"==Device.type&&(X.item.adult?X.showOnAdult=function(){e.player.play()}:e.player.play())}),X.playerInited=!0,C.onResize()}},Loader.loaded("video_player")?b():require("video_player",b)),X.item.partial&&(X.item.not_found=!!$(X.item.el).data("notFound"),X.item.type&&!X.item.not_found)){for(k=[],I=[],u=0,S=(M=C.getPartial(X.gid)).length;u<S;++u)s=M[u],k.push(s.nid),I.push(s.type);C._onGroupTrigger(X.gid,"partial",[{partials:M,nids:k,types:I}])}C._onGroupTrigger(X.gid,"list",[{current:X.n,last:!!m&&m.n,total:c}]),i||C.postSelectItem(t,l),C.syncErrors()}},setImageAdult:function(e,a){this.setImageError(e,!!a&&Le.adult({content:X.item.content}))},setImageError:function(e,a){var t=$("#"+("gallery_img_"+e)).parent(),i=t.find(".gallery__error");a?(t.addClass("gallery__show_error"),i.html(a)):$e[e]&&(t.removeClass("gallery__show_error"),i.empty()),$e[e]=!!a,a&&e==this.getFrame(0)&&X.zoomed&&this.toggleZoom(!1)},hasError:function(){return!(!$e[this.getFrame(0)]&&!X.hasError)},postSelectItem:function(e,a){var t,i,r,l;X&&(t=this,i=X.item,e||t.moveImage(!1),X.inited=!0,t.toggleSiblings(!1),ne&&$("#gallery__zoom").toggle("video"!=X.item.content),$("#g_sharelink").prop("href",i.share).toggleClass("mr_l_0",0<i.shareCnt).parents("td").toggleClass("disabled",!i.share).toggleClass("js-clicked",!!+i.reposted),$("#g_advancepage").prop("href",i.commentsLink).toggleClass("mr_l_0",0<i.commentsCnt).parents("td").toggleClass("disabled",!i.commentsLink||0<i.commentsLink.indexOf("#no_link")),(r=$("#gallery_descr")).length&&(r[0].innerHTML=i.description,$("#gallery_descr_wrap").toggleClass("hide",!i.description||"video"==i.content&&"desktop"!=Device.type)),$("#g_dloadlink").prop("href",i.download).toggle(!!i.download),$("#g_shareCnt")[0].innerHTML=+i.shareCnt||"",$("#g_commentCnt")[0].innerHTML=+i.commentsCnt||"",$("#gallery_bottom td").toggle(!X.item.partial),X.item.showMotivator&&!h&&i.share&&tick(function(){GALLERY.showNotif(Le.collectionsMotivator(),{timeout:!1})}),t.syncLikes(),page_loader.ok()&&(l=t.getItemPos(),page_loader.setJSC("gallery",X.gid+"/"+l,!e||a),_=location.hash),t.toggleSiblings(!1),t.onResize(!0),t.toggleSiblings(!0),t.autoHideNotif())},blinkArrows:function(){if("desktop"!=Device.type&&"operamini"!=Device.browser){var e=this,a=$(".gallery__side-arrow");e.arrows_timeout&&clearTimeout(e.arrows_timeout),a.stop(!0,!0).show(),e.arrows_timeout=setTimeout(function(){e.arrows_timeout=!1,a.fadeOut()},1500)}},syncLikes:function(){var l,o,e,a,t,i,n,s=X.item;s.partial||(o=!1,s.parent?(a=(e=s.parent.split(":"))[0]+"_"+e[1],t=$("#"+a+"_voteUp"),i=$("#"+a+"_voteDown"),l=[t.data("clicked")?1:i.data("clicked")?-1:0,t.data("cnt")||0,i.data("cnt")||0,!t.length||t.data("disabled")||0,!i.length],o=a):l=s.like.split(","),n=Spaces.params.nid&&!+l[3]&&s.type!=Spaces.TYPES.EXTERNAL_VIDEO,U.find(".js-vote_btn").each(function(){var e=$(this),a=e.find(".js-vote_btn_cnt"),t=s.type+"_"+s.nid,i=e.data("type"),r=i<0?+l[2]:+l[1];a.toggleClass("mr_l_0",!r).text(r||""),e.attr({id:t+(i<0?"_voteDown":"_voteUp"),title:(i<0?L(""):L(""))+" "+r}).data({cnt:r,oid:s.nid,ot:s.type,disabled:!n,vote_id:t,clicked:l[0]==i,privatePhoto:!!l[4],binded:o}),a.attr("id","vote_"+(i<0?"down":"up")+"_cnt_"+t),e.parents("td").toggleClass("js-clicked",l[0]==i).toggleClass("disabled",!(n&&(-1!=i||!l[4])))}))},freeItem:function(){X&&X.playerInited&&VideoPlayer.destroy(X.playerId)},getItemPos:function(){return X.n+(he[X.gid]||0)},getMaxZoom:function(){var e,a,t,i,r=g(X.item.image);return r&&X.item.size?(a=n((e=o(X.item.size[0],X.item.size[1],r[0],r[1]))[0],e[1],H.w,H.h),t=Math.max(X.item.size[0],X.item.size[1])/Math.max(a[0],a[1]),i=Math.max(X.item.size[0],X.item.size[1])/Math.max(e[0],e[1]),z=Math.max(2,t),[t,i]):1},getImageSize:function(){var e,a,t=g(X.item.image);return t&&X.item.size?[(a=n((e=o(X.item.size[0],X.item.size[1],t[0],t[1]))[0],e[1],H.w,H.h))[0],a[1]]:[X.currImage.width(),X.currImage.height()]},toggleZoom:function(e,a){var r,l,t,i,o,n=this;X&&"video"!=X.item.content&&ne&&(e===undefined&&(e=!X.zoomed),e!=X.zoomed&&(e&&!n.canScale()||(n.autoHideNotif(),X.zoomDir=!0,X.zoomed=e,U.toggleClass("gallery__zoom gallery__nav_hide",X.zoomed),r="session_id:"+Date.now(),l=n.getMaxZoom(),t=Math.max(1.4,l[0]),X.zoomId=r,i=function(){e||(U.removeClass("gallery__loading"),X.fixZoom&&(X.currImage.removeClass("hide"),X.fixZoom.img.remove(),X.fixZoom=!1))},o=function(){if(e&&1.1<=l[1]){U.addClass("gallery__loading");var i=function(e,a){if(X&&X.zoomId==r&&X.zoomed&&!X.fixZoom){if(U.removeClass("gallery__loading"),X.scale<=1)return void setTimeout(function(){i(e,a)},1e3);var t=$("<img>",{id:"gallery_img_z",src:e});X.currImage.addClass("hide").parent().after(t),X.fixZoom={img:t,scale:1/l[0]},n.onResize(!0)}delete ce[e]};s(X.item.download,i)}},a?(i(),o(),n.toggleSiblings(!e)):"ucbrowser"==Device.browser?(i(),o(),n.toggleSiblings(!1),n.setMoveAnim(!1),n.moveImage(0,0,e?t:1),n.toggleSiblings(!e)):(n.toggleSiblings(!1),i(),n.setMoveAnim("transform","ease-out",G,function(){e||n.toggleSiblings(!0),o()}),n.moveImage(0,0,e?t:1)))))},lockTouch:function(e){Ie=e},toggleFullscreen:function(e){b="boolean"==typeof e?e:!b,U.toggleClass("gallery_hide-toolbars",b),H=undefined,this.onResize(!0),b||this.blinkArrows()},isFullscreen:function(){return b},blinkButtons:function(){var e,a=0;"operamini"!=Device.browser?e=setInterval(function(){0==a?U.addClass("gallery__side-arrow_show"):1==a&&(clearInterval(e),U.removeClass("gallery__side-arrow_show"),U.addClass("gallery__animation-ended")),++a},1e3):U.addClass("gallery__animation-ended")},canScale:function(){return X&&(X.gifed?ce[X.item.gif]:ce[X.item.image])&&!this.hasError()},canMove:function(e){return!(e<0&&!X.prev)&&(!(0<e&&!X.next)&&1<pe[X.gid].length)},needLoad:function(e){var a,t,i=this;return!!i.canMove(e)&&(a=he[X.gid]||0,t=ye[X.gid],!!(e<0&&a&&X.n<1)||!!(0<e&&t&&X.n>=pe[X.gid].length-1&&a+X.n<t-1))},getNeighbors:function(e,a,t){var i,r,l=pe[e];for(i=0,r=l.length;i<r;++i)if(l[i]==a)return{prev:0<i?l[i-1]:!!t&&l[l.length-1],next:i+1<l.length?l[i+1]:!!t&&l[0],n:i};return!1},move:function(a,e,t,i){var r,l,o,n;if(X&&(r=this,l=pe[X.gid],r.setMoveAnim(!1),!(Ie||"video"==X.item.content&&Loader.loaded("video_player")&&VideoPlayer.isBusy()))){if(r.needLoad(a)){if(r._onGroupTrigger(X.gid,"load",[{dir:a}]),r.needLoad(a))return void GALLERY.setLoading(!0);if(!e)return void tick(function(){r.move(a,!1)})}if((!((a=0<=a?1:-1)<0)||X.prev)&&(!(0<a)||X.next)){if(Me&&oe){if(e)return o=function(){r.toggleSiblings(!0),r.setMoveAnim("transform","ease-out",B,function(){r.move(a,!1,Ce)});var e=1.05*H.w;r.moveImage((e+e/2*(X.scale-1))*-a,0)},void(v?tick(o):o())}else e=t=!1;(n=X.n+a)>=l.length&&(n=0),n<0&&(n=l.length-1),n=pe[X.gid][n],ve+=a,r.selectItem(X.gid,n,!1,t,a)}}},switchShadow:function(e){if(le){var a="0px 0px 0px "+Math.ceil(Math.max(($(window).innerWidth()-H.w)/2,$(window).innerHeight()-H.rh/2))+"px "+i;U.css(R,a+(e?", inset "+a:""))}},onResize:function(e){var a,t,i,r,l,o,n,s,g,c,d,_,m,u,p,f,y,h,v,w=this;X&&(H&&e||(a=$(window).innerHeight(),t=Math.max(window.innerHeight,a),document.body.style.cssText=a!=t?"min-height:"+t+"px !important":"",H=E()),w.switchShadow(!1),X.hasError&&(i=$("#Gallery_error .gallery-error_msg")).css("top",(H.rh-i.height())/2),"video"==X.item.content?(r=$("#Gallery .js-vc_status"),l=H.h+(r.length?-r.outerHeight(!0):0),Loader.loaded("video_player")&&(o=vplayer(X.playerId,!0))&&o.setMaxSize(H.w,l),(f=H.w)<(v=(h=l)*(y=16/9))&&(h=(v=f)/y),n=[Math.round(v),Math.round(h)],$("#galleryVideoStub").css({maxWidth:n[0]+"px",maxHeight:n[1]+"px"}),$("#galleryVideo").css("margin-top",(l-n[1])/2+"px")):e||w.recalcFrames(),F&&(s=x(),(g=X.currImage).attr("style","max-height: "+(x()-8)+"px !important;max-width: "+(U.width()-2)+"px"),g.show(),j&&((c=$("#gallery_bottom")).removeClass("gallery__bottom").addClass("gallery_tools"),c[0].style.top=s+k+"px"),F&&$("#Gallery__wrapper").css({height:s+"px",marginTop:b?0:k+"px",marginBottom:b?0:I+"px"})),e||tick(function(){X&&w.moveImage(X.imageX,X.imageY)}),(d=X.fixZoom)&&(m=(_=w.getMaxZoom()[0])/(1/d.scale),u=X.scale*m,d.scale=1/_,d.x=Math.round((H.w-X.item.size[0])/2),d.y=Math.round((H.rh-X.item.size[1])/2),p=Y(H,u,X.imageX,X.imageY,!0),X.invalidate=!0,w.moveImage(p.x,p.y,p.scale)))},addPhoto:function(e,a){var t,i,r,l,o,n,s,g,c,d,_,m,u=this;for(a||(pe={}),t=!1,i=e||$(".gview_link"),r=0;r<i.length;++r)if(n=(o=p(l=i[r])).gid,!_e[n]){if(me[n]||(me[n]=[]),pe[n]||(pe[n]=[]),!l.gallery_cache_id){if(s=me[n].length,"video"==o.content&&j)continue;if(l.onclick=u._openLink,j&&!l.href&&(l.href="#"+Date.now()),l.gallery_cache_id=++xe,ue[l.gallery_cache_id]=o,a){for(c=0,d=(g=me[n]).length;c<d;++c)if((_=g[c]).partial&&_.nid==o.nid&&_.type==o.type){s=_.n;break}me[n][s]=o}else me[n].push(o);o.n=s,o.el.setAttribute("data-gallery_id",s)}a||(X&&X.item.n==o.n&&(X.n=pe[n].length,t=!0),pe[n].push(o.n))}!X||a||t||(n=X.gid,m=u.getItemPos(),pe[n][m]||(m=pe[n].length-1),u.exit(!0,!0),u.open(n,m,!0,!0))},updatePartial:function(e,a){var t,i=this;i.addPhoto(a,!0),X&&(e=X.gid,t=X.id,i.exit(!0,!0),i.open(e,t,!0,!0))},_openLink:function(e){if((e=e||window.event).stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),$.draggableNoClick())return!1;var a=p($(this)[0]);return De.open(a.gid,a.n),!1},removeFiles:function(e,a,t,i){var r,l,o,n=pe[e],s=me[e],g=[];if(a<0){for(r=0;r<t;++r)o=s[l=n[r]].el,ue[o.gallery_cache_id]=null,g.push(o),me[l]=null;X&&(X.n-=t),pe[e]=n.splice(t)}else{for(r=n.length-t;r<n.length;++r)o=s[l=n[r]].el,ue[o.gallery_cache_id]=null,g.push(o),me[l]=null;pe[e]=n.splice(0,n.length-t)}i?$(g).parents(i).remove():$(g).remove()},getFiles:function(e,a,t,i){var r,l,o,n=pe[e],s=[];if(n)for(r=a,l=Math.min(n.length,a+t);r<l;++r)o=me[e][n[r]],s.push(i?$(o.el).parents(i)[0]:o.el);return s},getPartial:function(e){var a,t,i,r=pe[e],l=[];if(r)for(a=0,t=r.length;a<t;++a)(i=me[e][r[a]]).partial&&i.type&&l.push(i);return l},onGroup:function(e,a,t){return this.on(a+":"+e,t)},unlockGroup:function(e){_e[e]=null,delete _e[e]},_onGroupTrigger:function(e,a,t){return this._trigger(a+":"+e,t)},setBaseOffset:function(e,a){he[e]=a},setGroupVisibleCount:function(e,a){ye[e]=a},getGroupCnt:function(e,a){if(!pe[e])return 0;var t=pe[e].length;return a&&ye[e]||t},showNotif:function(e,a){var t=this;a=$.extend({timeout:5e3},a),f&&clearTimeout(f),$("#gallery_notif").remove(),U.append(Le.notif({text:e})),a.timeout&&(f=setTimeout(function(){t.hideNotif()},a.timeout)),y=!0},hideNotif:function(){var e=$("#gallery_notif");clearTimeout(f),f=0,y=!1,oe?e.cssAnim("opacity","ease-out",300,function(){e.remove()}).css("opacity",0):e.remove()},autoHideNotif:function(){y&&this.hideNotif()},setLoading:function(e){X&&!X.isLoading!=!e&&($("#Gallery").toggleClass("gallery__loading gallery__lock",!!e),X.isLoading=Ie=!!e)},setGroupError:function(e,a,t){a?fe[e]?($.inArray(a,fe[e].errors)<0&&fe[e].errors.push(a),fe[e].callbacks.push(t)):fe[e]={errors:[a],callbacks:[t]}:delete fe[e],X&&this.syncErrors()},setError:function(e,a){var t,i,r=this;X&&X.hasError!=e&&(r.setLoading(!1),t=$("#Gallery_error").toggle(!!e).html(e?Le.error(e+(a?"<br />":"")):""),a&&(i=$(Le.retry()).click(function(e){e.preventDefault(),a()}),t.find(".gallery-error_msg").append(i)),X.hasError=Ie=!!e,r.onResize(!0),X.hasError&&X.zoomed&&r.toggleZoom(!1))},getGalleryRect:E,lock:function(e){Se=e}}));window.GALLERY=De,t=Class({Static:{setupLoaders:function(e){return $(e||".js-gallery_loader").each(function(){var e=$(this);e.data("GalleryLoader")||e.data("GalleryLoader",new t(e))}).data("GalleryLoader")}},Constructor:function(e){var a=this;a.opts=$.extend({apiMethod:"",apiData:{},total:0,limit:0,offset:0,gc:!1,itemWrap:!1,hasMore:!1,fixResult:null},e.data()),a.el=e,a.offset=0,a.loaded_offset=a.opts.offset,a.total=a.opts.total,a.limit=a.opts.limit,a.setupGallery()&&a.hasMore(0)&&(a.update(),page_loader.push("shutdown",function(){a.destroy()}))},hasMore:function(e){var a=this;return 0<e?a.loaded_offset+a.offset+a.limit<a.total:e<0?!!a.loaded_offset:a.hasMore(-1)||a.hasMore(1)},gc:function(){var e,a=this,t=De.getGroupCnt(a.gid),i=((a.page-1)*a.limit-a.loaded_offset)/a.limit,r=(t-(a.page*a.limit-a.loaded_offset))/a.limit;S<i&&(e=i-M,De.removeFiles(a.gid,-1,e*a.limit,a.opts.itemWrap),a.offset-=e*a.limit,a.loaded_offset+=e*a.limit,De.setBaseOffset(a.gid,a.loaded_offset)),S<r&&(e=r-M,De.removeFiles(a.gid,1,e*a.limit,a.opts.itemWrap),a.offset-=e*a.limit)},setupGallery:function(){var s=this,e=s.el.find(".gview_link");return!!e.length&&(s.limit||(s.limit=2*e.length),s.gid=p(e[0]).gid,De.unlockGroup(s.gid),De.setBaseOffset(s.gid,s.loaded_offset),De.addPhoto(),De.onGroup(s.gid,"partial",function(n){var a=function(){s.loadData(function(e){var a,t,i,r,l,o;for(s._load_partial=!1,a=De.getFiles(s.gid,0,Math.min(e.widgets.length,n.types.length)),t=[],i=0;i<a.length;++i)l=(r=$(a[i])).index(),o=r.parent(),e.widgets[i]?(r.replaceWith(e.widgets[i]),t.push(o.children()[l])):r.attr("data-not-found",1);GALLERY.updatePartial(s.gid,t)},function(e){s._load_partial=!1,GALLERY.setError(e.message||L(" . "),a)},0,n.types.length,{nids:n.nids,types:n.types})};s._load_partial||(s._load_partial=!0,a())}),De.onGroup(s.gid,"load",function(e){s._go_next=!0,De.setLoading(!0)}),De.onGroup(s.gid,"exit",function(e){s.el.trigger("galleryExit",{page:s.page,total:s.total})}),De.onGroup(s.gid,"list",function(e){var a,t,i,r;!1!==e.last?a=e.current-e.last:0==e.current?a=-1:e.current==e.total-1&&(a=1),t=100*(1-Math.min(1,a<0?e.current/s.limit:(e.total-e.current)/s.limit)),w<t&&s.load(a),i=s.getPage(s.loaded_offset+e.current+1),s.page!=i&&(r=De.getFiles(s.gid,(i-1)*s.limit-s.loaded_offset,s.limit,s.opts.itemWrap),s.el.trigger("galleryPageChanged",{files:r,prevFiles:s.shadow_prev_items,nextFiles:s.shadow_next_items,page:i,lastPage:s.page,totalPages:Math.ceil(De.getGroupCnt(s.gid,!0)/s.limit)}),s.page=i)}),s.shadow_prev_items=$('<div class="hide">').insertBefore(s.el),s.shadow_next_items=$('<div class="hide">').insertAfter(s.el),s.page=s.getPage(s.loaded_offset+s.offset+1),!0)},getPage:function(e){return Math.max(1,Math.ceil(e/this.limit))},update:function(){De.setGroupVisibleCount(this.gid,this.total)},load:function(a){var t=this;a=a<0?-1:1,t.hasMore(a)&&t.loadChunk(t.limit*a,function(){t._go_next&&(De.move(a),t._go_next=!1)},function(e){De.setError(e.message,function(){De.setError(!1),De.setLoading(!0),t.load(a)})})},loadChunk:function(i,r,a){var e,l=this;l._proccess||(e=i<0?l.loaded_offset+i:l.loaded_offset+l.offset+i,l._proccess=!0,l.loadData(function(e){l._proccess=!1,l.total=e.count,De.setLoading(!1);var a=e.widgets,t=De.getGroupCnt(l.gid);(t+a.length>=l.total||a.length<i)&&(l.total=t+a.length+l.loaded_offset),0<i?l.shadow_next_items.append(a.join("")):l.shadow_prev_items.prepend(a.join("")),l.offset+=a.length,i<0&&(l.loaded_offset-=a.length),l.update(),De.setBaseOffset(l.gid,l.loaded_offset),De.addPhoto(),l.opts.gc&&l.gc(),De.update(!0),r()},function(e){l._proccess=!1,a(e)},e,Math.abs(i)))},loadData:function(a,t,i,r,e){var l=this,o=$.extend({},l.opts.apiData,{L:r,O:i});e&&(o.IdS=e.nids,o.TyPes=e.types),Spaces.api(l.opts.apiMethod,o,function(e){l.opts.fixResult&&l.opts.fixResult(e),e.code==Codes.AUTH.ERR_AUTH_ERROR&&e.auth_errror==Codes.AUTH.AUTH_ERROR.ERR_FREQ_LIMIT?(console.error(":("),setTimeout(function(){l.loadData(i,r,a,t)},3e3)):0!=e.code?t({message:Spaces.services.processingCodes(e),retry:!0}):a(e)},{onError:function(e){t({message:e,retry:!0})}})},destroy:function(){this.el=null,this.shadow_prev_items.remove(),this.shadow_next_items.remove()}}),window.GalleryLoader=t,define("gallery","onRequest",function(){Loader.ready(function(){"operamini"!=Device.browser&&t.setupLoaders(),De.init(),De.addPhoto()})})});define("anim","init",function(){function o(n){return n!==undefined&&null!==n}var l=Device.can("transition"),f=Device.can("transform"),d=Device.can("transform3d"),n=l&&f,c=/\s*,\s*/;$.support.nativeAnim=n,$.support.nativeAnim3d=n&&d,$.fn.move=function(n,t){var e=this;return f?e.transform({translate:[n,t]}):(e.style.left=n+"px",e.style.top=t+"px",e)},$.fn.transition=function(n,t,e){var i,s,a,r,o=0;if(l)for(e=e||100,t=t||"linear";(i=this[o++])&&i.style;){if(s="",n)for(a=n.split(c),r=0;r<a.length;++r)s+=(r?", ":"")+can_css(a[r],!0)+" "+e+"ms "+t;else s="none";("none"!=s||""!=i.style[l]&&"none"!=i.style[l])&&(i.style[l]=s)}return this},$.fn.transform=function(n){if(f)for(var t=0,e=(r="",(i=n)&&(i.translate&&(s=i.translate[0]+"",a=i.translate[1]+"",s.indexOf("%")<0&&(s+="px"),a.indexOf("%")<0&&(a+="px"),r+=d?"translate3d("+s+", "+a+", 0px) ":"translate("+s+", "+a+") "),o(i.scale)&&(r+=d?"scale3d("+i.scale+", "+i.scale+", 1) ":"scale("+i.scale+") "),o(i.rotate)&&(r+="rotate("+i.rotate+") ")),r.length?r:"none");(el=this[t++])&&el.style;)("none"!=e||""!=el.style[f]&&"none"!=el.style[f])&&(el.style[f]=e);var i,s,a,r;return this},$.fn.hasAnim=function(){return this.length&&!!$.data(this[0],"spAnimEnd")},$.fn.cssAnim=function(n,t,e,i){var s,a,r=0,o="transitionend webkitTransitionEnd oTransitionEnd otransitionend msTransitionEnd".split(" ");if(t=t||"linear",e=e||100,l)for(;s=this[r++];)if(s=$(s),(a=$.data(s[0],"spAnimEnd"))?a.call(s[0]):s.transition(),n){for(!1,a=function(n){var t,e=$.data(this,"spAnimEnd");if($(this).transition(),e){for(t=0;t<o.length;++t)this.removeEventListener(o[t],e);$.removeData(this,"spAnimEnd"),i&&i()}},r=0;r<o.length;++r)s[0].addEventListener(o[r],a,!1);s.transition(n,t,e),$.data(s[0],"spAnimEnd",a)}return this}});define("draggable","init",function(e){function S(e,t){var n,r,o,a,i;return r=t+"X",o=t+"Y",(n=(e=e.originalEvent||e).touches)?n.length<2?[n[0][r],n[0][o]]:[a=(n[0][r]+n[1][r])/2,i=(n[0][o]+n[1][o])/2,a-n[0][r],i-n[0][o]]:[e[r],e[o]]}function P(e){if(e&&1<e.length){var t=e[1].clientX-e[0].clientX,n=e[1].clientY-e[0].clientY;return Math.sqrt(t*t+n*n)}return!1}function n(e){for(;e;){if(e===document.body)return!0;e=e.parentNode}return!1}var k,C="draggable-"+Date.now(),_=0,q=!1;Spaces.Inertia=function(){var l,d,s,g,c;extend(this,{start:function(){l=[],Date.now()},add:function(e,t){l&&(l.push([Date.now(),e,t]),l=l.slice(-20))},end:function(){var e,t,n,r,o,a,i,u;if(d=s=g=c=0,l){for(t=l.pop(),n=Date.now(),r=l.length;0<r--&&!(150<n-l[r][0]);)e=l[r];l=null,e&&t&&(o=t[1]-e[1],a=t[2]-e[2],i=Math.sqrt(o*o+a*a),u=t[0]-e[0],d=i/u,s=o/u,g=a/u,c=u)}},speed:function(){return{speed:d,speedX:s,speedY:g,time:c}},inertia:function(e){if(!(d<.1)){var t=d/e,n=s?s*t-e*t*t/2:0,r=g?g*t-e*t*t/2:0;if(t*=530,r*=140,(n*=140)||r)return{x:n,y:r,time:t}}}})},k=[],$.fn.draggable=function(l){var d,e,s,g,c,f,a,v,h,i,p,m,b,w,E,D,y,u,L,x,X,Y,o,M,t,n,r=$(document);if(!1===l)return r.off(".draggable"),r.off(".draggable_tmp"),this.each(function(){var e,t,n,r,o=$(this).removeData(C).off(".draggable").off(".draggable_tmp");for(t=0,n=k.length;t<n;++t)if(k[t].el===o[0]){e=k[t],k.splice(t,1);break}if(!e)return this;r=e.events,o[0].removeEventListener&&r&&each(r,function(e,t){var n,r,o=t.split(" ");for(n=0;n<o.length;++n)for(r=0;r<e[1].length;++r)e[0].removeEventListener(o[n],e[1][r])}),e=null}),this;if(l=$.extend(!0,{selector:null,onlyEvents:!0,disableContextMenu:!0,preventStart:!1,hoverClass:"",fastEvents:!1,detectZoom:!1,forceStart:!1,forceMove:!1,relative:!1,scroll:!1,events:{dragStart:null,dragMove:null,dragEnd:null}},l),!this.length)return!1;if(1<this.length)return this.each(function(){$(this).draggable(l)}),this;if(!(d=this).length)return d;if(d.data(C))return this;if(e={el:this[0]},k.push(e),d.data(C,!0),d.on((l.disableContextMenu?"contextmenu.draggable dblclick.draggable ":"")+"dragstart.draggable dragenter.draggable",function(e){return!1}),$(window),a=l.fastEvents,i=h=v=!1,y=function(e,t){var n,r,o=!0;return a?(n=l.events[e])&&(o=!1===n(t)):(r=new $.Event("sp"+e.toLowerCase()),extend(r,t),d.trigger(r)),o},function(){v&&D&&(y("dragMove",D),D=null)},u=function(e){var t=!!document.addEventListener;e?t?document.addEventListener("mousemove",M,!1):r.on("mousemove.draggable",M):t?document.removeEventListener("mousemove",M):r.off("mousemove",M)},L=l.scroll?"page":"client",(Y=!!l.relative)&&!l.scroll)throw"`relative` depends on `scroll`";return o=function(e){var t,n,r,o,a;if(!(q&&"mousedown"==e.type||(t=(e.originalEvent||e).touches,v||"mousedown"==e.type&&1!=e.which||t&&1<t.length&&i))){if(l.selector){for(n=e.target,r=!1;n;){if(0<jQuery.find(l.selector,this,null,[n]).length){console.log(l.selector,n),r=!0;break}n=n.parentNode}if(!r)return;X=$(n)}else X=d;if(v=!0,(h="touchstart"==e.type)&&(q=!0),o=S(e,L),p=m=0,E=w=b=!1,c=s=o[0],f=g=o[1],Y&&(a=X.offset(),x={x:a.left,y:a.top,w:X.width(),h:X.height()}),M(e,!0),l.preventStart&&t)return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1;h||u(!0)}},M=function(e,t){var n,r,o,a,i,u;if(v&&("mousemove"!=e.type||!h)&&(t||(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()),!1,!(n=(e.originalEvent||e).touches)||n.length))return r=S(e,L),n&&(1<n.length?!1===b&&(b=P(n),p=r[2],m=r[3],y("zoomStart",{})):!1!==b&&(p=r[0]-s,m=r[1]-g,y("zoomEnd",{}),b=!1)),o=r[0]-p,a=r[1]-m,i=!1,w||s-o==0&&g-a==0&&!l.forceStart||(w=!0,y("dragStart",{target:d[0],x:o,y:a,trueTouch:h}),i=l.forceMove),w&&(s!=o||g!=a||i)&&(D={x:o,y:a,dX:o-c,dY:a-f,dirX:s-o<0?-1:1,dirY:g-a<0?-1:1,target:d[0],trueTouch:h},Y&&(D.relX=o-x.x,D.relY=a-x.y,D.rpW=D.relX/x.w,D.rpH=D.relY/x.h),!1!==b&&!1!==(u=P(n))&&(D.scale=u/b),y("dragMove",D),E=!0),s=o,g=a,!1},t=function(e){if((!e.touches||!e.touches.length)&&v&&("mouseup"!=e.type||!h)){if(M(e,!0),x=X=null,(v=!1)!==b&&y("zoomEnd",{}),w&&y("dragEnd",{moved:E,dX:c-s,dY:f-g,x:s,y:g,target:d[0],trueTouch:h}),E)_=Date.now(),e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault();else if(l.preventStart&&touches){var t=document.elementFromPoint&&document.elementFromPoint(s+window.pageXOffset,g+window.pageYOffset);$(t||d).trigger("click")}h||u(!1)}},n=d[0],e.events={"mouseup mousemove":[document,[M,t]],"touchstart mousedown":[n,[o]],touchmove:[n,[M]],"touchend touchcancel":[n,[t]]},n.addEventListener?(n.addEventListener("touchstart",o,!1),n.addEventListener("touchmove",M,!1),n.addEventListener("touchend",t,!1),n.addEventListener("touchcancel",t,!1),document.addEventListener("mouseup",t,!1)):r.on("mouseup.draggable",t),"msie"==Device.browser&&Device.v<=8?r.on("mousedown.draggable",function(e){var t=d.offset(),n=d.outerWidth(),r=d.outerHeight();if(t.left<=e.pageX&&t.left+n>=e.pageX&&t.top<=e.pageY&&t.top+r>=e.pageY)return o.call(this,e)}):n.addEventListener?n.addEventListener("mousedown",o):d.on("mousedown.draggable",o),this},$.draggableNoClick=function(){return Date.now()-_<100},define("draggable","onRequest",function(){page_loader.ok()&&page_loader.on("pageloaded","draggable",function(){var e,t;for(e=0;e<k.length;++e)n(t=k[e].el)||($(t).draggable(!1),--e)})})});define("video_player","init",function(){function i(e,t){var r,a,i=16/9;return e*i==t?[e,t]:(a=t*i,t<(r=e/i)?[Math.round(a),Math.round(a/i)]:[Math.round(r*i),Math.round(r)])}var n=[],r=0,h={240:{w:426,codecs:"avc1.42c00d, mp4a.40.2",index:0},360:{w:640,codecs:"avc1.42c01e, mp4a.40.2",index:1},480:{w:854,codecs:"avc1.4d401e, mp4a.40.2",index:2},720:{w:1280,codecs:"avc1.64001f, mp4a.40.2",index:3},1080:{w:1920,codecs:"avc1.640028, mp4a.40.2",index:4}},p=1,f="vpq",v=(cookie.get("spaces_dummy_vc"),function(e){var t,r='<div class="vp-convert_status js-vc_status"><table><tr class="js-vc_table_status">';for(t=0;t<e.sources.length;++t)r+="<td>"+e.sources[t].res+"p</td>";return r+='</tr></table><div class="upload_pb"><div class="upload_pb_pointer js-vc_pb" style="width: 5%"></div></div><small class="js-vc_status_msg"></small></div>'}),g=function(e){return'<div class="player-dummy_error">'+e+"</div>"},t=function(e){return'<span class="red"><span class="ico ico_alert"></span> '+e+"</span>"},s=function(){return'<span class="ico_player ico_player_play"></span>'},_={},m={},o={},e=!1,w=Class({Static:{instances:[],converted:{},drivers:{},init:function(){page_loader.onShutdown("video_players",function(){IPCSingleton.instance("cp").stop("video"),w.destroyAll()},!0),page_loader.ok()&&page_loader.onJSC("vp",function(e){e=e.split(":"),document.getElementById(e[0])?vplayer(e[0]).onJSC(e):page_loader.setJSC(!1)},!0),"operamini"!=Device.browser&&$(window).on("resize orientationchange",function(){var e,t;for(e in _)(t=_[e])&&t.checkNode()&&t.onResize()}),window.pushstream&&pushstream.on("message","video_convert",function(e){if(e.act==Spaces.LongPollingTypes.VIDEO_CONVERT){var t,r=e.file_type+":"+e.file_id,a=m[r];if(a&&(t=vplayer(a.id,!0)))return t.onConvert(e,a.callback);o[r]||(o[r]=[]),o[r].push(e)}}),define("video_player","onRequire",w.populate)},_populate:function(){$(".js-vp_new").each(function(e,t){vplayer(t).show()})},populate:function(){e||(e=!0,Loader.ready(function(){tick(function(){e=!1,w._populate()})}))},isBusy:function(){var e,t;for(e in _)if((t=_[e])&&t.checkNode()&&t.player&&t.player.isBusy())return!0;return!1},destroy:function(e){_[e]&&_[e].destroy(!0)},destroyAll:function(){for(var e in _)w.destroy(e)},destroyNotAvail:function(){var e,t;for(e in _)(t=_[e])&&!t.checkNode()&&w.destroy(e)},canPlayMP4:function(){var e=document.createElement("video");return e.canPlayType&&e.canPlayType('video/mp4; codecs="'+h[240].codecs+'"')},instance:function(e,t){return _[e]?_[e]:t?null:new w(e)},onConvertRequestDone:function(e,t,r){console.log("    . ",e,t,r)},onConvertRequestError:function(e,t,r,a){if(console.error(e),r){var i,n=m[t+":"+r];if(n&&(i=vplayer(n.id,!0)))return i.setConvError(e)}Spaces.showError(e+(a?"<br />(md5: "+a+")":""))},needNativePlayer:function(){return("ucbrowser"==Device.browser||"operamobile"==Device.browser)&&w.canPlayMP4()},stopAll:function(){var e,t;for(e in _)(t=_[e])&&t.player&&t.player.pause()},getMaxQuality:function(){return this.__max_quality||(this.__max_quality=this._getMaxQuality()),this.__max_quality},_getMaxQuality:function(){var e,t,r,a,i,n,s,o,l=[Math.min($(window).width(),$(window).height()),Math.max($(window).width(),$(window).height())],p=window.screen,u=document.createElement("video"),c=p?Math.min(p.width,p.height):l[0],d=p?Math.max(p.width,p.height):l[1],y=u.canPlayType&&u.canPlayType("video/mp4");if(!d&&!c)return 240;for(a in t=0,r=e=240,h)i=h[a],n=a<=c&&i.w<=d||240==a||!d||!c,s=u.canPlayType&&u.canPlayType('video/mp4; codecs="'+i.codecs+'"'),!n||y&&!s||(!y||-1<s.indexOf("probably")?e=a:t=a),y&&!s||(r=a);return o={q:e,max:r,mp4:y},t&&e<t&&e<360&&(o.q=360),"desktop"==Device.type?o.q=Math.min(o.q,480):o.q=Math.min(r,360),o}},Constructor:function(e){var t,r,a,i=this;if(i.delayed_onready=[],i=this,t=$("#"+e).removeClass("js-vp_new"),i.id=e,!t.length)throw"Player node not found: "+e;if((_[e]=i).params=$.extend({fileId:0,fileType:0,convertLink:null,allow3gp:!1},t.data()),i.player=null,i.params.fileType&&(r=o[i.params.fileType+":"+i.params.fileId]))for(a=0;a<r.length;++a)i.onConvert(r[a],!1);i.src_id=i.params.fileType+"_"+i.params.fileId,i.params.has_3gp=!i.params.convertLink&&i.isFullConverted()},checkNode:function(){return!!ge("#"+this.params.playerId)},onResize:function(){this.player&&this.player.onResize()},setMaxSize:function(e,t){this.player&&this.player.resize(e,t)},show:function(e){var r,t,a,i,n,s,o,l,p,u,c,d,y;if(!this.player){if((t=(r=this).params).playerId=e||r.id,a="player_"+t.playerId+"_"+r.id,i=$("#"+a),n=$("#"+t.playerId),i.length||((i=$('<div id="'+a+'">')).append(n.children()),n.append(i)),s=[],t.convertLink&&(m[t.fileType+":"+t.fileId]={id:r.id,callback:function(){r.show(e)}}),o=w.getMaxQuality(),l=cookie.get(f)||o.q,p=!w.needNativePlayer(),t.external)switch(t.external){case Spaces.ExternalVideo.YOUTUBE:s=[{"default":!0,file:"//www.youtube.com/watch?v="+t.externalId}]}else u=null,c=!1,each(t.src,function(e,t){var r={file:e.link,label:e.res+"p","default":e.converted&&l==e.res};s.push(r),w.canPlayMP4()&&(r.type='video/mp4; codecs="'+h[e.res].codecs+'"'),e.converted&&(u=s.length-1),e.converted&&l==e.res&&(c=!0)}),null===u||c||(s[u]["default"]=!0);if(!r.params.convertLink||r.queued||r.isFullConverted()&&!r.params.allow3gp||(d=function(){var e=t.convertLink+(0<=t.convertLink.indexOf("?")?"&":"?")+"_="+(new Date).getTime()+"&domain="+encodeURIComponent(base_domain());console.error(e),Loader.loadScripts([{src:e}])},r.isFullConverted()||(n.prepend(v({sources:t.src})),r.updateConvStatus({message:window.pushstream?L(" ..."):L(" .     ,   .")})),window.pushstream?pushstream.avail()?d():pushstream.on("connect","video_converter:"+r.id,function(){r.isFullConverted()&&r.params.has_3gp?pushstream.off("connect","video_converter:"+r.id):d()}):d(),r.queued=!0),r.updateConvStatus(),!r.isAvailSources())return this;for(Device.android_app&&t.nativeVideo?r.player=new b(!0):Device.android_app&&(!o.mp4||Device.android()<3)&&!t.external?r.player=new b(!1):r.player=t.external?new C:p?new S:new x,y=r.player,r.player.on("play",function(){var e,t;for(e in _)(t=_[e])&&t!=r&&t.player&&t.player.pause();IPCSingleton.instance("cp").start(function(){w.stopAll()},"video"),n.trigger("video_play")}),r.player.on("pause",function(){IPCSingleton.instance("cp").stop("video")}),r.player.on("error",function(e){n.find(".player-dummy").prepend(g(e)),r.updateConvStatus()}),t.external||(y.on("sources",function(){r.updateAvailSourcesList()}),y.on("sourcechange",function(e){var t=w.getMaxQuality(),r=parseInt(y.getQualityLevels()[e.currentQuality]);t.max<r&&!confirm(L("       {0}p. ?",r))?y.setQualityLevel(h[t.q].index):cookie.set(f,r,{expires:1825,path:"/"})})),y.setup({sources:s,id:r.id,player_id:a,preview:t.preview,external:t.external,externalId:t.externalId,file:{id:t.fileId,type:t.fileType,dir:t.fileDir}});r.delayed_onready.length;)y.ready(r.delayed_onready.pop());return this}},updateConvStatus:function(e){var r,a,i,n=this,t=$("#"+n.params.playerId),s=t.find(".js-vc_status"),o=s.find(".js-vc_pb"),l=s.find(".js-vc_status_msg");n.params.external||(e=e||{},r=s.find("table td"),a=0,i={},$.each(n.params.src,function(e,t){$(r[e]).addClass(t.converted?"green":"red"),t.converted&&++a,i[t.res]=t.converted}),i[144]=n.params.has_3gp,i.fail=!!n.cant_play,o.css("width",a/r.length*100+"%"),"message"in e&&l.html(e.message).toggle(!!e.message),$(".js-vc_visible").each(function(){var e=$(this),t=e.data();t.id==n.src_id&&(t.show?e.toggle(!!i[t.show]):t.hide&&e.toggle(!i[t.hide]))}),n.isFullConverted()&&($(".js-vc_fileext").each(function(){var e=$(this);e.data("id")==n.src_id&&e.removeClass("js-vc_fileext").text("mp4")}),s.remove()),$("#player_"+n.params.playerId+"_"+n.id).trigger("vp_resize"))},setConvError:function(e){return this.updateConvStatus({message:e?t(e):""})},updateAvailSourcesList:function(){var e,t=this,r=t.player,a=r.getQualityLevels();for(e=0;e<a.length;++e)r.setQualityVisibly(e,t.params.src[e]&&t.params.src[e].converted)},isAvailSources:function(){var e,t=this,r=0;if(t.params.external)return 1;for(e=0;e<t.params.src.length;++e)t.params.src[e].converted&&++r;return r},isFullConverted:function(){var e,t=this;if(t.params.external)return!0;for(e=0;e<t.params.src.length;++e)if(!t.params.src[e].converted&&!t.params.src[e].not_avail)return!1;return!0},setConverted:function(e,t,r){var a,i=this;for(a=0;a<i.params.src.length;++a)i.params.src[a].res<=e&&(i.params.src[a].converted=!!t)},setNotAvail:function(e){var t,r=this;for(t=0;t<r.params.src.length;++t)r.params.src[t].res>=e&&(r.params.src[t].not_avail=!0)},onConvert:function(e,t){var r,a=this.params,i=this;if(a.convertLink)return 0<e.size&&i._updateFileSize(e.resolution,e.size),0<e.duration&&i._updateDuration(e.duration),console.log(" : "+e.resolution+(e.not_avail?" (not_avail)":"")),144==e.resolution?(i.params.has_3gp=!0,void i.updateConvStatus()):(e.not_avail?i.setNotAvail(e.resolution):i.setConverted(e.resolution,!0),r=i.isAvailSources(),i.setConvError(!r&&!e.resolution&&L('  .   <a href="/soo/support">Support</a>.')),i.player?i.updateAvailSourcesList():r&&t&&t(),this)},onReady:function(e){return this.player?this.player.ready(e):this.delayed_onready.push(e),this},destroy:function(e){var t=this;window.pushstream&&pushstream.off("connect","video_converter:"+this.params.id),t.player&&(t.player.destroy(),t.player=null,t.delayed_onready=[]),e&&delete _[t.id],window.pushstream&&pushstream.off("connect","video_converter:"+t.id)},_updateFileSize:function(t,r){var a=this;$(".js-vc_filesize").each(function(){var e=$(this);e.data("id")==a.src_id&&e.data("res")==t&&e.html(Spaces.getHumanSize(r)).removeClass("hide")})},_updateDuration:function(t){var r=this;$(".js-vc_duration").each(function(){var e=$(this);e.data("id")==r.src_id&&e.html(r._duration(t))})},_duration:function(e){var t,r=Math.floor(e/3600);return e-=3600*r,e-=60*(t=Math.floor(e/60)),r?r+":"+("0"+t).slice(-2)+":"+("0"+e).slice(-2):t+":"+("0"+e).slice(-2)},onJSC:function(e){var t=this;t.onReady(function(){t.player.onJSC(e)})}}),a=Class({Constructor:function(){this.events={},this.is_ready=!1},destroy:function(){return this},play:function(){return this},pause:function(){return this},playing:function(){return!1},getRenderingMode:function(){return""},getQualityLevel:function(){return 0},getQualityLevels:function(){return[]},setQualityVisibly:function(e,t){return this},setQualityLevel:function(e){return this},onResize:function(){return this},isReady:function(){return this.is_ready},ready:function(e){return this.is_ready?e():this.on("ready",e),this},on:function(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),this},_trigger:function(e,t){if(this.events[e])for(var r=0;r<this.events[e].length;++r)this.events[e][r].apply(this,t);return this},isBusy:function(){return!!this.busy},onJSC:function(){page_loader.ok()&&page_loader.setJSC(!1)}}),b=Class({Extends:a,Constructor:function(e){a.call(this),this["native"]=e},setup:function(e){var t,r,a=this;for(a.id="android_"+e.player_id,a.playing=!1,a.file=e.file,t=0;t<e.sources.length;++t)e.sources[t]["default"]&&(a.source=e.sources[t]);(r=$("#"+e.player_id)).find(".player-dummy").click(function(e){e.preventDefault(),a.play()}).append(s()),a.wrap=r,a._trigger("pause"),window.SpacesApp=$.extend(window.SpacesApp||{},{onVideoPlay:function(){a.playing=!0,a._trigger("play")},onVideoPause:function(){a.playing=!1,a._trigger("pause")},onVideoFallback:function(){a["native"]=!1,a.play()}}),a._trigger("ready")},resize:function(e,t){var r=i(e,t);this.wrap.width(r[0]).height(r[1])},destroy:function(){var e=this;return e.destroyed=!0,delete window.SpacesApp.onVideoPlay,delete window.SpacesApp.onVideoPause,e.playing&&(e._trigger("pause"),e.playing=!1),e},play:function(){return this["native"]?SpacesApp.exec("nativeVideo",this.file):SpacesApp.exec("playVideo",{src:this.source.file}),this},pause:function(){return this},playing:function(){return this.playing}}),C=Class({Extends:a,Constructor:function(){a.call(this)},setup:function(e){var t,r,a,i=this;i.playing=!1,i.id="yt_"+e.player_id,(r=(t=$("#"+e.player_id)).find("iframe")[0])||(r=ce("iframe",{className:"player-dummy"},{width:"100%",height:"100%"},{type:"text/html",src:location.protocol+"//www.youtube.com/embed/"+e.externalId+"?enablejsapi=1&autoplay=0&origin="+location.protocol+"//"+location.hostname}),t.addClass("player-dummy_wrap").empty().append(r)),r.id=i.id,i.wrap=t,i.iframe=r,a=function(){i.destroyed||(i.player=new YT.Player(i.id,{events:{onReady:function(){i.player&&(i.is_ready=!0,i._trigger("ready"))},onStateChange:function(e){var t=i.playing,r=e.data;r==YT.PlayerState.PLAYING&&(i.playing=!0),r!=YT.PlayerState.PAUSED&&r!=YT.PlayerState.ENDED||(i.playing=!1),t!=i.playing&&i._trigger(i.playing?"play":"pause")}}}))},n?n.push(a):a(),window.onYouTubeIframeAPIReady||(Loader.loadScripts([{src:"https://www.youtube.com/iframe_api"}],function(){}),window.onYouTubeIframeAPIReady=function(){for(var e=0;e<n.length;++e)n[e]();n=null})},resize:function(e,t){var r=i(e,t);this.wrap.width(r[0]).height(r[1])},destroy:function(){var e=this;return e.destroyed=!0,e.playing&&(e._trigger("pause"),e.playing=!1),e.player&&e.player.destroy(),e.player=null,e},play:function(){return this.player&&this.player.playVideo(),this},pause:function(){return this.player&&this.player.pauseVideo(),this},playing:function(){return this.playing}}),x=Class({Extends:a,Constructor:function(){a.call(this)},setup:function(e){var t,r,a=ge("#"+e.player_id),i=this;e.player_id;for(i.curr_source=0,i.sources=e.sources,i.quality_selector=null,i.player_wrap=ce("div",{className:"vp-html5_wrap"}),i.loading_shadow=ce("div",{className:"vp-html5_loading_shadow"}),i.player_wrap.style.width="100%",i.player_wrap.appendChild(i.loading_shadow),i.player_wrap.addEventListener("click",function(e){e.stopPropagation()},!1),i.player=ce("video",{className:"vp-html5"},{},{preload:"none",controls:"controls",poster:e.preview}),i.player.addEventListener("play",function(){i._trigger("play")},!1),i.player.addEventListener("pause",function(){i._trigger("pause")},!1),i.player.addEventListener("ended",function(){i._trigger("pause")},!1),i.player.style.width="100%",i.player_wrap.appendChild(i.player),a.parentNode.replaceChild(i.player_wrap,a),i.player_wrap.id=e.player_id,1<i.sources.length&&i._renderQualitySelector(),r=t=0;r<i.sources.length;++r)i.sources[r]["default"]&&(t=r);return i._setQualityLevel(t),i._trigger("sources",[{levels:i.getQualityLevels(),currentQuality:i.getQualityLevel()}]),i.onResize(),tick(function(){$("#"+e.player_id).trigger("vp_ready")}),this},resize:function(e,t){i(e,t)},onResize:function(){var e=this,t=$(e.player),r=t.width()*(9/16);Math.floor(r)&&t.height(r)},destroy:function(){var e=this;return e.pause(),e.player.parentNode.removeChild(e.player),e.player_wrap.parentNode.removeChild(e.player_wrap),e.player=null,e.player_wrap=null,e.sources=[],e},getRenderingMode:function(){return"html5"},setQualityVisibly:function(e,t){return 0<=e&&e<this.sources.length&&(this.sources[e].visible=t),this._updateQualitySelector(),this},getQualityLevel:function(){return this.curr_source},setQualityLevel:function(e){return this._setQualityLevel(e)&&this._trigger("sourcechange",[{levels:this.getQualityLevels(),currentQuality:this.getQualityLevel()}]),this},getQualityLevels:function(){var e,t=[];for(e=0;e<this.sources.length;++e)t.push(this.sources[e].label);return t},play:function(){return this.player&&!this.playing()&&this.player.play(),this},pause:function(){return this.player&&this.playing()&&this.player.pause(),this},playing:function(){return this.player&&!this.player.paused},_setQualityLevel:function(e){return 0<=e&&e<this.sources.length&&(this.curr_source=e,this._updateQualitySelector(),this._setSource(this.sources[e].file,!0),!0)},_renderQualitySelector:function(){var r=this,e=ce("div",{innerHTML:'<span class="left">'+L(" :")+"&nbsp;</span>",className:"vp-html5_quality_selector"});this.quality_selector=ce("select",{className:"right",onchange:function(e){var t=this.options[this.selectedIndex].value;t!=r.curr_source&&r.setQualityLevel(t)}}),e.appendChild(this.quality_selector),this.player_wrap.appendChild(e)},_updateQualitySelector:function(){var e,t;if(this.quality_selector){for(e=this.quality_selector.options,t=0;t<e.length;++t)e[t].parentNode.removeChild(e[t]),--t;for(t=0;t<this.sources.length;++t)"visible"in this.sources[t]&&!this.sources[t].visible||this.quality_selector.appendChild(ce("option",{value:t,innerHTML:this.sources[t].label}));this.quality_selector.value=this.curr_source}},_setSource:function(e,t){var r,a=this,i=this.player.paused,n=t?a.player.currentTime:0;0<n?(a._setLoading(!0),r=function(){a._setLoading(!1),a.player.pause(),this.currentTime=n,i||a.player.play(),this.removeEventListener("loadedmetadata",r,!1)},a.player.addEventListener("loadedmetadata",r,!1),a.player.src=e,a.player.load(),a.player.play()):a.player.src=e},_setLoading:function(e){var t=this.loading_shadow.style,r=this.player;r.controls=!e,e?(t.width=r.offsetWidth+"px",t.height=r.offsetHeight+"px",t.display="inline-block",r.controls=!1):t.display="none"}}),S=Class({Extends:a,Constructor:function(){a.call(this)},setup:function(r){var a,i,e,t,n,s,o,l=this;page_loader.on("requestend","vplayer"+r.player_id,function(){l.player.setFullscreen(!1)},{persistOnRequest:!0}),page_loader.on("mailrequestend","vplayer"+r.player_id,function(){l.player.setFullscreen(!1)},{persistOnRequest:!0}),e=$("#"+r.player_id),t=Math.floor(e.width()*(9/16)),Math.floor(t)&&(a=$("<div>").css({"min-height":t+"px",position:"relative"}),i=$("<div>").css({position:"absolute",top:0,width:l._resize?l._resize[0]+"px":"100%",height:l._resize?l._resize[1]+"px":"auto","z-index":9999999}),a.append(i),l._stub=e.children().appendTo(i),(l._stub_wrap=a).insertAfter(e),a.append(e)),$("#"+r.player_id).trigger("vp_ready"),l.id=r.player_id,l.busy=!0,l.params=r,n={aspectratio:"16:9",sources:r.sources,flashplayer:BASE_URL+"/libs/jwplayer.flash.swf?"+p,html5player:BASE_URL+"/libs/jwplayer.html5.js?"+p,image:r.preview,primary:"html5",levels_toggle:!1,startparam:"start"},l._resize?(n.width=l._resize[0],n.height=l._resize[1]):n.width="100%",o=s=!1,require("jwplayer",function(){l.destroyed||(jwplayer.utils.saveCookie("qualityLabel",""),l.player=jwplayer(r.player_id).setup(n).onReady(function(e){l.busy=!1;var t=setInterval(function(){var e=$("#"+r.player_id);e.parent()&&e.offset()&&!l.destroyed?e.height()&&(setTimeout(function(){a&&(a.css("min-height","0"),i.css("z-index","0"),setTimeout(function(){i.hide()},100)),$("#"+r.player_id).trigger("vp_ready")},0),clearInterval(t)):clearInterval(t)},1);$("#"+r.player_id).trigger("vp_ready"),l.is_ready=!0,l._trigger("ready"),ge("#"+r.player_id).onclick=function(e){e.stopPropagation&&e.stopPropagation()}}).onQualityChange(function(e){l._trigger("sourcechange",[{levels:l.getQualityLevels(),currentQuality:l.getQualityLevel()}])}).onQualityLevels(function(e){l._trigger("sources",[{levels:l.getQualityLevels(),currentQuality:l.getQualityLevel()}])}).onFullscreen(function(e){Device.android_app&&(SpacesApp.exec("fullscreen",{enable:e.fullscreen}),SpacesApp.exec("pullToRefresh",{enable:!e.fullscreen}),Loader.loaded("gallery",function(){GALLERY.lock(e.fullscreen)}),SpacesApp.exec("sidebar",{enable:!e.fullscreen}),Loader.loaded("sidebar",function(){Sidebar.lock(e.fullscreen)}),document.body.style.position=e.fullscreen?"fixed":"static"),page_loader.ok()&&(e.fullscreen?(page_loader.setJSC("vp",r.id),l.jsc=location.hash):(l.jsc===location.hash&&history.back(),l.jsc=null))}).onPlay(function(e){o&&o(),l.old_playing||l._trigger("play"),l.old_playing=l.playing()}).onPause(function(e){o&&o(),l.old_playing&&l._trigger("pause"),l.old_playing=l.playing()}).onComplete(function(e){l.old_playing&&l._trigger("pause"),l.old_playing=l.playing()}).onError(function(e){if(o&&o(),!s&&"chrome"==Device.browser&&0<=e.message.indexOf("File could not be played")){console.log("chrome save data bug!!!");var t=$("#"+l.id+"_display_button"),r=t.css("display");t.css("display","none"),l.player.stop(),l.player.play(),tick(function(){t.css("display",r),l.player.forceState("IDLE"),l.player.forceState("BUFFERING"),o=function(){l.player.releaseState(),o=!1}}),s=!0}}).onSetupError(function(e){l.busy=!1;var t=e.message;-1<e.message.indexOf("No suitable")&&(t=L("     mp4. "),w.canPlayMP4()||jwplayer.utils.flashVersion()||(t=L("     {0}","<a href='https://get.adobe.com/ru/flashplayer/'>Adobe Flash Player</a>. "))),l._trigger("error",[t])}))})},resize:function(e,t){var r=this,a=i(e,t);r.player?r.player.resize(a[0],a[1]):r._resize=a},onResize:function(){},onJSC:function(e){this.player.setFullscreen(!0)},destroy:function(){var e,t,r=this;r.destroyed=!0,r.player&&(r.player.pause().stop(),r.busy?((e=ge("#"+r.id))&&((t=ce("div",{},{display:"none",visibility:"hidden",opacity:0,height:"0px"})).appendChild(e),document.body.appendChild(t)),r.on("ready",function(){setTimeout(function(){t.parentNode.removeChild(t),r.player.remove()},0)}),r.player.pause().stop()):r.player.remove(),r.destroyed=!0,r._stub_wrap&&r._stub_wrap.append(r._stub.show()))},getRenderingMode:function(){return player.getRenderingMode()},setQualityVisibly:function(e,t){this.params.external||this.player.setLevelVisibly(e,t)},getQualityLevel:function(){return this.player.getCurrentQuality()},setQualityLevel:function(e){return this.params.external||this.player.setCurrentQuality(e),this},getQualityLevels:function(){var e,t=[],r=this.player.getQualityLevels();if(r)for(e=0;e<r.length;++e)t.push(r[e].label);return t},play:function(){return this.player&&!this.playing()&&this.player.play(),this},pause:function(){return this.player&&this.playing()&&this.player.pause(),this},playing:function(){return this.player&&"PLAYING"==this.player.getState()}});window.vplayer=function(e,t){return e instanceof jQuery&&(e=e[0]),"object"==typeof e&&(e.id||(e.id="VP_"+r++),e=e.id),w.instance(e,t)},(window.VideoPlayer=w).init()});define("footer","init",function(){function s(e){var o=$("#footer");o.find(".footer__link_edit").find(".form-toggle__wrap").toggleClass("form-toggle__wrap_off",!e),o.toggleClass("footer_text-hide",!e)}function i(){if(!o&&0==k.count){if(k.payload){!function(e){var o,t,i,n,a,r=$("#footer"),_=r.find(".footer__links-wrapper"),l=_.hasClass("loaded");Loader.loaded("footer_deps",function(){_.sortableItems(!1)}),$("#footer_more_link").remove(),o=_.find(".footer__link-wrapper"),l&&e.links.length==o.length||(o.remove(),o=$([])),t=o.length,"hide_text"in e&&s(!e.hide_text),"moder_switch_state"in e&&r.find(".footer__link_moder").find(".form-toggle__wrap").toggleClass("form-toggle__wrap_off",!e.moder_switch_state);for(i=e.links.length;0<i--;)n=e.links[i],a=i,0<t?o[a].getAttribute("data-id")==n.id?$(o[a]).toggleClass("footer__link_on",0<n.state).toggleClass("footer__link_off",n.state<0):$(o[a]).replaceWith(m.link(n)):_.prepend(m.link(n));l||_.addClass("loaded"),c?Loader.loaded("footer_deps",function(){_.sortableItems({defaultStyle:!1,autoWidth:!1,autoHeight:!1,moveDir:"both",customPlaceholder:d})}):f("update")}(k.payload);for(var e=0;e<k.callbacks.length;++e)k.callbacks[e]()}k.callbacks=[],k.payload=null}}function r(e,o){++k.count,o&&k.callbacks.push(o),(e=e||{}).Ti=n;var t=Date.now();Spaces.api("neoapi/settings.navi",e,function(e){--k.count,0==e.code&&e.time>=k.time&&(e.time!=k.time||t>k.rtime)&&(k.payload=e,k.rtime=t,k.time=e.time),i()},{onError:function(){--k.count,i()}})}function f(i){$(function(){var e,o,t=$("#footer");c&&$("#footer_settings_link").click(),$("#footer_more_link").remove(),e=t.find(".footer__link_on"),o=$(m.link({state:1,id:-1,link_addr:"#",type_name:"more",full_name:L("")})).attr("id","footer_more_link"),"operamini"==Device.browser&&o.click(function(){}),0<e.length?$(e[Math.min(a-1,e.length-1)])[e.length>=a?"before":"after"](o):$("#footer").find(".footer__links-wrapper").prepend(o),_("boolean"==typeof i?i:p)})}function _(e){var o,t=$("#footer"),i=$("#footer_more_link"),n=t.find(".footer__link_on:not(#footer_more_link)");if(e===undefined&&(e=!i.hasClass("footer__link_active")),p=e)$("#footer_settings").show(),i.addClass("footer__link_active"),n.show();else for(i.removeClass("footer__link_active"),$("#footer_settings").hide(),o=a-1;o<n.length;++o)$(n[o]).hide()}var d,a=10,l="desktop"!=Device.type,o=!1,c=!1,p=!1,n=Date.now(),k={payload:null,count:0,time:0,rtime:0,callbacks:[]},m={link:function(e){var o="home"==e.type_name?'<img src="'+Spaces.params.avatar+'" alt="" />':"",t=e.link_addr.replace(/link_id=\d*/g,"link_id="+Spaces.params.link_id),i='<div class="footer__link-wrapper footer__link_'+(0<e.state?"on":"off")+(e.id<0?" footer__link_more":"")+'" data-id="'+e.id+'"><a href="'+t+'" class="footer__link"'+(e.placeholder?' style="visibility: hidden; opacity: 0"':"")+'><div class="footer__bg"></div><div class="footer__image">'+(o?'<div class="footer__avatar js-my_avatar">'+o+"</div>":'<div class="f__ico f__ico_'+e.type_name+'"></div>')+'</div><div class="footer__name">'+e.full_name+"</div></a></div>";return i}};$(function(){d=$(m.link({state:1,id:-1,link_addr:"#",type_name:"placeholder",full_name:"&nbsp;",placeholder:!0}));var a=$("#navi_footer_wrap");a.on("click",".footer_edit .footer__link_on, .footer_edit .footer__link_off",function(e){e.preventDefault();var o=$(this);r({CK:null,L:o.data("id"),S:o.hasClass("footer__link_on")?0:1},!1),o.toggleClass("footer__link_on").toggleClass("footer__link_off")}).on("click","#footer_more_link",function(e){e.preventDefault(),_()}),"operamini"!=Device.browser&&a.on("click","#footer_settings_link",function(e){e.preventDefault();var o=$(this),t=$("#footer"),i=$("#footer_settings_link"),n=$("#footer_settings_link .footer__name-text");o.data("process")||(o.hasClass("footer__link_active")?(c=!1,t.find(".footer__links-wrapper").sortableItems(!1),o.removeClass("footer__link_active"),t.addClass("footer_read").removeClass("footer_edit"),t.find(".footer__link_moder").show(),t.find(".footer__link_colors, .footer__link_edit").hide(),f(),n.text(L(" "))):(c=!0,i.find(".f__ico_settings").removeClass("f__ico_settings").addClass("f__ico_spinner"),o.data("process",!0),require("footer_deps",function(){r({},function(){o.data("process",!1),i.find(".f__ico_spinner").removeClass("f__ico_spinner").addClass("f__ico_settings"),o.addClass("footer__link_active"),t.removeClass("footer_read").addClass("footer_edit"),l||t.addClass("footer_shake"),$("html, body").scrollTop(a.offset().top),_(!0),n.text(L(" ")),t.find(".footer__link_moder").hide(),t.find(".footer__link_colors, .footer__link_edit").show()})})))}).on("click",".footer__link_edit",function(e){e.preventDefault();var o=!$(this).find(".form-toggle__wrap").hasClass("form-toggle__wrap_off");s(!o),r({CK:null,Ht:o?1:0},!1)}).on("sortableEnd",function(e){o=!1,0!=e.offset&&r({CK:null,L:e.element.data("id"),M:e.offset},!1)}).on("sortableStart",function(){o=!0}),pushstream&&pushstream.addMessageHandler("footer",function(e){e.act==Spaces.LongPollingTypes.REFRESH_WIDGETS&&e.widgets&Spaces.WIDGETS.FOOTER&&e.tab_id!=n&&(e.links?function(e){if(e.links){var o=e._e_tag/1e3;o>=k.time&&(k.payload=e,k.rtime=o,k.time=o),i()}}(e):r({}))}),page_loader.on("shutdown","footer",function(){Spaces.footer.update(!1)},!0),f(!1)}),window.Spaces.footer={toggle:_,update:f}});define("form_toolbar","init",function(){function n(c,o){function l(){var t,e,i,a,o,l,n=Math.max(4,Math.floor(E.innerWidth()/40));if(B!=n){for(t=E.find("table:first"),g.detach(),e=t.find("tr"),a=(i=t.find("td").detach()).length/n,o=0;o<i.length;++o)l=i[o],$(e[Math.floor((1<a?o+1:o)/n)]).append(l);e.toggleClass("hide",!F),$(e[0]).removeClass("hide").append(g.toggleClass("hide",a<=1)),g.find(".js-bb_more").toggleClass("js-clicked",F),B=n}}function t(){if(i){var t=c[0].value.length;i[0].innerHTML=t,i[0].style.color=T<t?"red":""}}function r(t){var e,i,a=!1;"pic"==t&&n()&&E.find(".js-bb_pic").hasClass("js-clicked")?r():(k&&(e=k,"color"!=(i=t)&&"fon"!=i||e.find(".js-bb_colorpicker").colorpicker(!1),a=k.data("tag")==t,k.remove(),m.hide(),j.removeClass("js-clicked"),j=k=null,Spaces.fixHeight(),$("body").off("click.sp_toolbar")),t&&!a&&(j=E.find(".js-bb_"+t).addClass("js-clicked"),k=$(Y(function(t){{if("color"==t||"fon"==t)return R(t);if("code"==t)return V();if("pic"==t)return X({files:"operamini"!=Device.browser&&o.activeAttaches,vote:!1});if(P[t].param)return J({tag:t,value:P[t].shortTag?(e=h||b(c),e?c[0].value.substr(e[0],e[1]):""):"",placeholder:P[t].param})}var e}(t))).data("tag",t),m.append(k).show(),("operamini"==Device.browser||Device.webkit()&&Device.webkit()<=533.1)&&"absolute"==k.css("position")&&k.css("position","static"),"operamini"!=Device.browser&&tick(function(){$("body").on("click.sp_toolbar",function(t){$(t.target).parents(".js-bb_menu").length||r()})}),Loader.loaded("dd_menu")&&Spaces.DdMenu.close(),Spaces.fixHeight(k),function(e,i){if("color"==i||"fon"==i){var t=e.find(".js-bb_colorpicker"),a=t.colorpicker();t.on("colorpicker:select",function(t,e){f("["+i+"="+e.color+"]","[/"+i+"]",""),r()}),e.on("click",".js-bb_color",function(t){t.preventDefault(),a.setColor($(this).data("val"))}).on("click",".js-bb_own_color",function(t){t.preventDefault(),$(this).toggleClass("clicked"),e.find(".js-bb_colorpicker_tab").toggleClass("hide")})}}(k,t)),d())}function n(){var t=k&&k.data("tag");return y||/spoiler|user|comm|pic/.test(t)}function d(){E.find(".js-bb_pic").toggleClass("js-clicked",n())}function s(t){var e=$("body");r(),SmilesMenu.toggle(x,E[0],function(t){v(function(){return t+" "})},function(){t.find(".ico_smile").addClass("ico_smile_blue"),e.off("click.sp_toolbar"),tick(function(){e.on("click.sp_toolbar",function(t){!$(t.target).parents(".smiles_menu").length&&$(t.target).parents("body").length&&SmilesMenu.toggle(x,E[0],!1)})})},function(){e.off("click.sp_toolbar"),t.find(".ico_smile").removeClass("ico_smile_blue")})}function p(t){var e,i,a,o,l,n,s=E.find(".js-bb_hid_attach").data("temp_type",t);tick(function(){r(),s.click()}),y=!0,s.hasClass("js-attach")||(e=s.parents("form"),i=$('<div id="azzzkoe_kostilishe_'+Date.now()+'"></div>'),a=e.find(".js-attach"),o=e.find(".js-attaches").data("max_files"),l=[],i.on("onNewAttach",function(t,e){t.stopPropagation(),t.stopImmediatePropagation(),l.length||tick(function(){_(l),l=[]}),l.push(e.file)}).on("AttachSelectorClose",function(){y=!1,d()}),e.on("onNewAttachBb",function(t,e){_([e.file])}),e.after(i),n=[],a.each(function(){n=n.concat($(this).data("fileTypes"))}),s.addClass("js-attach").data({form:"#"+i.attr("id"),max_files:o,fileTypes:n,exVideo:a.data("exVideo"),comm:a.data("comm"),"public":a.data("public"),attaches:!1,linkDownload:!0,upload:!0,spoiler:"#ddspoiler_"+x,proxyUpload:1<o,fix_position:-10,no_label:!0}),tick(function(){AttachSelector.instance(i).setParent(AttachSelector.instance(e))}))}function u(t){return t.type==Spaces.TYPES.EXTERNAL_VIDEO?{tag:q[t.source_type],val:t.video_id}:{tag:M[t.type],val:t.nid}}function _(n){v(function(){var t,e,i,a=AttachSelector.instance(c),o="",l=!1;for(t=0;t<n.length;++t)i=u(e=n[t]),a.onAttachSelect(e,!0)&&(l=!0),o+="["+i.tag+"="+i.val+"]";return l&&a.saveAttaches(n),o})}function a(t){var e,i,a=P[t];c.attr("disabled")||c.attr("readonly")||("smile"==t?s(E.find(".js-bb_smile")):"pic2"==t?p():"more"==t?(B=0,F=!F,l()):"quote"==t?f("[quote]","[/quote]",w||""):"url"==t?v(function(t){if(t.length)return"[url="+t+"]"+L("")+"[/url]";var e=$("#toolbar_payload").data("clipboard")||"";return e?html_unwrap(e):"[url="+location.protocol+"//"+base_domain()+"]"+L("")+"[/url]"}):a.dd?r(t):a.nobb||(e={color:"green",fon:"LightBlue",gray:"#ccc"}[t],f("["+(i=a.bbTag||t)+(e?"="+e:"")+"]","[/"+i+"]","")))}function e(){$("body, html").off(".sp_toolbar"),$(window).off(".sp_toolbar"),C&&clearInterval(C)}function b(t){var e,i,a,o=0,l=0;if(c[0].selectionStart!==undefined)o=c[0].selectionStart,l=c[0].selectionEnd-c[0].selectionStart;else{if(!document.selection||!c[0].createTextRange)return null;if(t)return null;c[0].focus(),e=c[0].value.length,l=(i=document.selection.createRange()).text.length,(a=c[0].createTextRange()).moveToBookmark(i.getBookmark()),o=-a.moveStart("character",-e)}return[o,l]}function f(a,o,l,n){var s;v(function(t,e){var i=n||t||l;return e&&(s=e[0]+a.length+i.length),a+i+o}),s&&set_caret_pos(c[0],s,s)}function v(t){var e,i,a=h||b(c),o=[c.scrollLeft(),c.scrollTop()];a?(e=t(c[0].value.substr(a[0],a[1]),a),i=a[0]+e.length,c[0].value=c[0].value.substr(0,a[0])+e+c[0].value.substr(a[0]+a[1]),c[0].focus()):(c[0].value+=t(""),i=c[0].value.length),h=null,c[0].focus(),set_caret_pos(c[0],i,i),c.scrollLeft(o[0]).scrollTop(o[1]).trigger("change")}var h,m,i,g,k,j,w,C,y,S,x=c.attr("id")||"tb_"+Date.now(),D=c.parents(".js-toolbar_wrap"),E=D.find(".js-toolbar"),A=D.find(".js-toolbar_inline"),T=c.data("maxlength")||c.attr("maxlength")||0,F=!1,B=0;o=extend({length:!0,inline:!1,toolbar:!0,hide:!1,activeAttaches:!1,inline:!1,disable:{},hideCounter:!1},o),E.length||(E=$('<div class="cf">'),o.toolbar?c.before(E):c.after(E)),("operamini"==Device.browser||o.inline)&&(o.length=!1),S=!c.parents(".text-input__wrap").length&&!o.toolbar,o.toolbar&&E.append(O({hide:o.hide,old:S,disabled:{fon:o.disable.bgcolor}})),o.length&&T&&(i=$(H({id:x,old:S,maxlength:T,hide:o.hideCounter})),S?E.append(i):c.after(i),i=i.find(".js-bb_counter")),o.inline&&A.html(z({allowed:I[o.inline]})).find("a").click(function(t){t.preventDefault(),a($(this).data("tag"))}),E.append(N(x)),m=E.find(".js-bb_menu"),E.find(".js-bb_smile_menu"),g=E.find(".js-bb_more").parent("td"),c.parents("form").find(".js-smile").show().click(function(t){t.preventDefault(),s($(this))}),"operamini"!=Device.browser&&c.parents("form").find(".js-bb_toggle").show().click(function(t){t.preventDefault();var e=E.find("table");e.toggleClass("hide"),$(this).toggleClass("js-clicked")}),E.find("a").click(function(t){t.preventDefault(),a($(this).data("tag"))}),m.on("click",".js-bb_insert_tag",function(t){var e,i,a,o;t.preventDefault(),e=$(this),i=e.data("tag"),a=e.data("val")||E.find(".js-bb_value_input").val(),(o=P[i]).shortTag?v(function(){return o.shortTag.replace("__value__",a||o.def)}):f("["+i+"="+a+"]","[/"+i+"]",""),r()}),m.on("click",".js-bb_attach",function(t){var e,i;t.preventDefault(),e=$(this).data("type"),(i={file:Spaces.TYPES.FILE,picture:Spaces.TYPES.PICTURE,music:Spaces.TYPES.MUSIC,video:Spaces.TYPES.VIDEO})[e]?p(i[e]):"close"==e?r():"vote"==e?alert(" !"):r(e)}),t(),l(),"operamini"!=Device.browser&&(c.on("focus",function(){T&&(C=setInterval(t,300)),h=null}).on("blur",function(){T&&clearInterval(C),h=b(!(C=null)),t()}).on("change",function(){C||t()}),$(window).on("resize.sp_toolbar orientationchange.sp_toolbar",function(){l()}),$(document.documentElement).on("mouseup.sp_toolbar",function(){var t;window.getSelection?t=window.getSelection():document.getSelection?t=document.getSelection():document.selection&&(t=document.selection.createRange().text),t&&(w=$.trim(t))}),o.activeAttaches&&(c.on("onDropAttach",function(t,e){_([e])}),E.parents("form").on("onDeleteAttach",function(t,e){var i,a,o;i=e.file,a=u(i),o=RegExp("\\["+a.tag+"="+a.val+"\\]","gi"),c.val(c.val().replace(o,""))})),c.keydown(function(i){i.altKey&&$.each(P,function(t,e){e.key==i.keyCode&&a(t)})}),require("text_restore",function(){tick(function(){c.hasClass("js-has_saved_text")&&(c.removeClass("js-has_saved_text"),E.prepend(U()))})})),page_loader.push("shutdown",e)}var s,I={chat:{quote:!0}},P={quote:{iconInline:"ico ico_quote",icon:"ico_mail ico_mail_quote",title:L(""),key:81},url:{icon:"ico_mail ico_mail_link",title:L("")},pic:{icon:"ico ico_plus_grey",dd:!0,title:L("")},color:{icon:"ico_mail ico_mail_color",title:L(" "),dd:!0},b:{icon:"ico_mail ico_mail_bold",title:L(" "),key:66},i:{icon:"bb/grey/italics.png",icon:"ico_mail ico_mail_italic",title:L(" "),key:73},u:{icon:"ico_mail ico_mail_underline",title:L(" "),key:85},s:{icon:"ico_mail ico_mail_strike",title:L(" "),key:83},smile:{icon:"ico ico_smile",title:L("")},code:{icon:"ico_mail ico_mail_code",title:L(""),dd:!0},spoiler:{hide:!0,key:72,param:L("  ")},gray:{hide:!0,bbTag:"color",key:71},fon:{icon:"ico_mail ico_mail_background",title:L(" "),dd:!0},more:{icon:"ico ico_more",title:L("")},user:{hide:!0,shortTag:"@__value__ ",param:L("  "),def:Spaces.params.name},comm:{hide:!0,shortTag:"$__value__$ ",def:"support",param:L("  ")}},M=mkhash([[Spaces.TYPES.FILE,"file"],[Spaces.TYPES.MUSIC,"music"],[Spaces.TYPES.PICTURE,"pic"],[Spaces.TYPES.VIDEO,"video"]]),q=mkhash([[Spaces.ExternalVideo.YOUTUBE,"youtube"]]),c=["90CAF9 80DEEA A5D6A7 FFF59D FFCC80 FFAB91 CE93D8".split(" "),"2196F3 00BCD4 4CAF50 FFEB3B FF9800 F44336 9C27B0".split(" "),"1565C0 00838F 2E7D32 F9A825 EF6C00 C62828 6A1B9A".split(" "),"ECF0F1 CFD8DC B0BEC5 97A6B0 546E7A 44565E 3A474C".split(" ")],a={text:L(""),ini:"^","1c":"^",json:"^",sql:"^",javascript:"JavaScript",php:"^",cpp:"C/C++",actionscript:"ActionScript",coffeescript:"CoffeScript",http:"^",cmake:"CMake",avrasm:"AVR Asm",vim:"^",vbnet:"VB.NET","vbscript-html":"VBScript (HTML)",cs:"C#",vbscript:"VBScript",css:"^",xml:"^",x86asm:"X86 ASM",applescript:"AppleScript",typescript:"TypeScript",objectivec:"Objective C"},o="text delphi ini 1c json sql javascript perl swift lisp d nginx php java cpp actionscript lua coffeescript vala http go avrasm vim dos vbnet xml vbscript-html bash cs python diff less erlang matlab vbscript css rust apache prolog markdown x86asm applescript fortran makefile ruby smali typescript cmake objectivec".split(" "),R=function(t){var e,i,a,o="desktop"==Device.type,l=o?"js-bb_color":"js-bb_insert_tag",n='<div class="widgets-group dropdown-menu wbg toolbar__spoiler"><div class="t_center"><table class="table__wrap bb-colorpicker"><tr>';for(n+='<td class="table__cell'+(o?"":" table__cell_last js-bb_colorpicker_tab")+'"><div class="'+(o?"stnd-block":"static-bl")+'">',e=0;e<c.length;++e){for(n+="<div>",i=0;i<c[e].length;++i)n+='<div style="background-color:#'+(a=c[e][i])+'" data-tag="'+t+'" data-val="#'+a+'" class="'+l+' toolbar-color pointer"></div>';n+="</div>"}return n+="</div></td>",n+='<td class="table__cell table__cell_last'+(o?"":" hide js-bb_colorpicker_tab")+'"><div class="'+(o?"stnd-block":"static-bl")+'"><div class="js-bb_colorpicker"></div></div></td>',n+="</tr></table></div>",o||(n+='<div class="links-group links-group_grey t_center"><a href="#" class="list-link js-bb_own_color">'+L("  ")+"</a></div>"),n+="</div>"},V=function(){var t,e,i='<div class="widgets-group dropdown-menu wbg toolbar__spoiler"><div class="static-bl">';for(t=0;t<o.length;++t)e=o[t],e=a[e]?"^"==a[e]?e.toUpperCase():a[e]:e.substr(0,1).toUpperCase()+e.substr(1),i+='<a href="#code-'+t+'" data-tag="code" data-val="'+o[t]+'" class="js-bb_insert_tag">'+e+"</a>",t!=o.length-1&&(i+=", ");return i+="</div></div>"},Y=function(t){return'<div class="spoiler_inject dropdown-menu" skip="1">'+t+"</div>"},U=function(t){return'<div class="nl service-info system-message_service mb10 js-temp_text_parent">'+L(" .")+' <a href="#" class="js-temp_text" data-action="restore">'+L("")+'</a><span class="ico ico_remove right pointer js-temp_text" data-action="delete"></span></div>'},O=function(i){var a=Date.now(),o='<div class="toolbar__wrap"><table class="toolbar table__wrap'+(i.hide?" hide":"")+'"><tr>';return $.each(P,function(t,e){i.disabled[t]||e.hide||(o+='<td class="table__cell"><a href="#l'+a+t+'" data-no_label="1" class="list-link js-bb_'+t+'" title="'+e.title+'" data-tag="'+t+'"><span class="'+e.icon+'"></span></a></td>')}),o+='</tr><tr class="hide"></tr><tr class="hide"></tr><tr class="hide"></tr></table></div>'},z=function(i){Date.now();var a="";return $.each(P,function(t,e){i.allowed[t]&&(a+='<button href="#bb-'+t+'" class="url-btn button" data-tag="'+t+'" title="'+e.title+'"><span class="'+e.iconInline+'"></span></button>')}),a},H=function(t){return t.old?'<span class="right counterBlock"><span class="js-bb_counter">0</span>/'+t.maxlength+"</span>":'<span class="right cntBl'+(t.hide?" hide":"")+'"><span class="js-bb_counter">0</span>/'+t.maxlength+"</span>"},N=function(t){return'<div class="hide"><span class="js-bb_hid_attach"></span></div><div class="js-bb_smile_menu smiles_menu hide"></div><div class="hide spoiler_inject" id="ddspoiler_'+t+'"></div><div class="js-bb_menu" style="position:relative;display:none"></div>'},X=function(t){var o,e={picture:[L(""),"ico_mail ico_mail_picture"],music:[L(""),"ico_mail ico_mail_music"],video:[L(""),"ico_mail ico_mail_video"],file:[L(""),"ico_mail ico_mail_file",!0]},i={vote:[L(""),"ico ico_vote"]},a={user:[L("  "),"ico ico_user"],comm:[L("  "),"ico ico_mode_froffr"],spoiler:[L(""),"ico_mail ico_mail_spoiler"],close:[L(""),"ico ico_remove"]},l={};return t.files&&$.extend(l,e),t.vote&&$.extend(l,i),$.extend(l,a),o='<div class="widgets-group links-group links-group_grey dropdown-menu bb0 toolbar__spoiler">',$.each2(l,function(t,e,i){var a=i.first?" list-link_first":i.last?" list-link_last":"";o+='<a href="#bb-'+t+'" class="list-link js-bb_attach'+a+'" data-type="'+t+'"'+(e[2]?' style="border-bottom-width: 2px"':"")+'><span class="'+e[1]+'"></span> '+e[0]+"</a>"}),o+="</div>"},J=function(t){return'<div class="widgets-group dropdown-menu wbg toolbar__spoiler"><div class="static-bl"><div class="text-input__wrap"><input type="text" class="text-input js-bb_value_input" data-no_paste="1" value="'+html_wrap(t.value)+'" placeholder="'+t.placeholder+'"></div></div><table class="table__wrap"><tr><td class="table__cell links-group links-group_grey table__cell_border" width="50%"><a href="#bb-add" class="list-link list-link-blue bb0 js-bb_insert_tag" data-tag="'+t.tag+'"><span class="ico ico_plus"></span><span class="t">'+L("")+'</span></a></td><td class="table__cell links-group links-group_grey table__cell_last" width="50%"><a href="#bb-close" class="list-link bb0 js-bb_attach" data-type="close"><span class="t">'+L("")+"</span></a></td></tr></table></div>"};window.Toolbar=n,$.extend(n,{expand:function(t,e){var i=t.findClass("js-bb_toggle");i.length&&e!=i.hasClass("js-clicked")&&i.click()}}),s=!1,define("form_toolbar","onRequire",function(){s||(s=!0,Loader.ready(function(){var t,e,i,a,o,l;for(s=!1,t=$("textarea, input"),e=0;e<t.length;++e)i=t[e],(a=""===(l=i.getAttribute("data-toolbar"))?{}:l?light_json(l):undefined)&&((o=$(i)).data("__toolbar__")||o.data("__toolbar__",new n(o,a)))}))})});define("colorpicker","init",function(){function o(e){function t(r,e,t,o){var c=function(r,e,t){var o,c,a=Math.max(r/=255,e/=255,t/=255),i=Math.min(r,e,t),n=a,s=a-i;if(c=0==a?0:s/a,a==i)o=0;else{switch(a){case r:o=(e-t)/s+(e<t?6:0);break;case e:o=(t-r)/s+2;break;case t:o=(r-e)/s+4}o/=6}return[o,c,n]}(r,e,t);a(c[0],c[1],c[2],o)}function a(r,e,t,o){var c,a;v[0].style.top=100*(1-r)+"%",u[0].style.top=100*(1-t)+"%",u[0].style.left=100*e+"%",r!==n&&(c=h(r,1,1),d.css("background","#"+m(c[0])+m(c[1])+m(c[2]))),n=r,s=e,l=t,a=i(),o||f.val(a),p.css("background",a),Spaces.LocalStorage.set("colopicker:last",a)}function i(){var r=h(n,s,l);return"#"+m(r[0])+m(r[1])+m(r[2])}e.empty().append(r.colorpicker());var n,s,l,o=e.find(".colorpicker-spectrum"),d=e.find(".colorpicker-rect"),p=e.find(".colorpicker-color"),u=e.find(".colorpicker-gradient_cursor"),v=e.find(".colorpicker-spectrum_cursor"),f=e.find("input"),c=e.find(".js-cc_paste"),k=this;$.extend(k,{setRGB:t,setColor:function(r){var e=g(r);e&&t(e[0],e[1],e[2])},color:i,destroy:function(){e.removeData(b).empty(),o=d=p=u=v=f=c=null}}),function(){o.draggable({fastEvents:!0,relative:!0,disableContextMenu:!1,forceStart:!0,forceMove:!0,scroll:!0,events:{dragMove:function(r){a(1-Math.min(1,Math.max(r.rpH,0)),s,l)}}}),d.draggable({fastEvents:!0,relative:!0,disableContextMenu:!1,forceStart:!0,forceMove:!0,scroll:!0,events:{dragMove:function(r){a(n,Math.min(1,Math.max(r.rpW,0)),1-Math.min(1,Math.max(r.rpH,0)))}}}),f.on("input",function(){var r=g(f.val());f.toggleClass("text-input_error",!r),r&&t(r[0],r[1],r[2],!0)}),c.click(function(r){r.preventDefault(),e.trigger("colorpicker:select",{color:i()}),console.log(i())});var r=Spaces.LocalStorage.get("colopicker:last");k.setColor(r||"#395387")}()}function m(r){return pad(r.toString(16).toUpperCase(),2)}function g(r){var e,t,o,c=r.match(/([a-f0-9]+)/i);if(!c)return null;if(6==(c=c[1]).length)e=parseInt(c.substr(0,2),16),t=parseInt(c.substr(2,2),16),o=parseInt(c.substr(4,2),16);else{if(3!=c.length)return null;e=parseInt(c[0]+c[0],16),t=parseInt(c[1]+c[1],16),o=parseInt(c[2]+c[2],16)}return[e,t,o]}function h(r,e,t){var o,c,a,i=Math.floor(6*r),n=6*r-i,s=t*(1-e),l=t*(1-n*e),d=t*(1-(1-n)*e);switch(i%6){case 0:o=t,c=d,a=s;break;case 1:o=l,c=t,a=s;break;case 2:o=s,c=t,a=d;break;case 3:o=s,c=l,a=t;break;case 4:o=d,c=s,a=t;break;case 5:o=t,c=s,a=l}return[Math.round(255*o),Math.round(255*c),Math.round(255*a)]}var r={colorpicker:function(){return'<div class="colorpicker"><table><tr><td><div class="colorpicker-rect"><div><div class="colorpicker-gradient_cursor"></div></div></div></td><td><div class="colorpicker-spectrum"><div class="colorpicker-spectrum_cursor"></div></td><td style="max-width: 138px" class="colorpicker-big">'+r.form()+'</td></tr></table><div class="colorpicker-small">'+r.form()+"</div></div>"},form:function(){return'<div class="normal-stnd">'+("desktop"==Device.type?L(" :"):L(" :"))+'</div><div class="colorpicker-row"><div class="colorpicker-color"></div></div><div class="colorpicker-row"><div class="text-input__wrap colorpicker-pad"><input type="text" class="text-input" autocomplete="off" name="color" value="" maxlength="64" /></div></div><div class="colorpicker-row"><div class="btn-main perimeter-border js-cc_paste">'+L("")+"</div></div>"}},b="SSCC"+Date.now();$.fn.colorpicker=function(r){var e,t=this.first();return t.length?(e=t.data(b),!1===r?(e&&e.destroy(),e=null):e||t.data(b,e=new o(t)),e):null}});define("smiles_data","init",function(){window.SpacesSmiles={categories:[["","wacko.gif"],[" - ","angel.gif"],[" - ","martini.gif"],["","chel.gif"],["","facepalm.gif"],["","01_Smile1.gif"],["","zawtoroj.gif"],["","aaa.gif"],["","smart.gif"],["","stesnit2.gif"],["","roza.gif"],["","bita.gif"],["","gitara3.gif"],["","ICQ.gif"],["","alarm.gif"],["","serf.gif"],["","santa.gif"]],list:[[["fan","fokus","gg","gudok","himichka","idiot","idiot2","gyy|idiotka","ik","jason","malyw","nark","olen","pifpaf","pilot","pilotidiot","rusruletka","suicid","suicid2","tormoz","vonyuchka","wacko","wutnik","yad","yazyk","zub","zuby"],["angel","angel2","angel3","cherep","death","demon","gdevil","mertvec","molitva","neangel","skosoj","vampir","vedma","vedma2","vis","viselica"],["alkawi","arbuz","bokaly","butylki","konfeta|est_konfetu","mandarin|est_mandarin","myaso|est_myaso","popkorn2|est_popkorn","koktel","ledenec","martini","mnogoPiva","morozhenoe","napitok","oguryum","pivo","pivo2","pivo3","pizza","popcorn","povar","rybu","tort","tost","vilka_nozh","vino","viwnja","viwnja2","wampanskoe","woko"],["Rulezzz","alien","alien2","babushka","baskov","bmed","boss","buba","chebur","chel","comando","comando1","comando2","ded","dedushka","dev","dev2","dj","evrej","ghost","gitler","kanabis","kloun","kloun2","koldun","kolyaska","korol","korol2","korol3","kurit","larisu","letaet","mafiya","mag","man2|man","man3","ment","miwutka","nakone","neo","ninja","nitki","novrus","pacak","pioner","pirat","pirat2","piska","podarok","pogran","poryadok","princesa","princesa2","priwel","puh","punk","rap","rus","rus2","rybak","sestra","shrek","skrjaga","slon","sluzhba","sluzhba2","soldat","superman","tommy","tormoz","triniti","ukr","umnik","umnik2","usa","zona"],["apl","bezpaniki","cenzura","cool2","cool3","cool4","darov","draznilka","facepalm","figa2","hi","hlopaet","horow","molchu","molodec","molodtci","molodtci2","molodtci3","molodtci4","nea","nedovolna","nenado","nene","neochem","neya","neznaet","ok","ploho2","poet","poklon","pora","preved","privet","privet2","privet3","pryatki","raduetsja","reverans","sumas","sumas2","victory","yes","zhopa"],[")|01_Smile1","@=)|02_smile2","-D|03_biggrin","))|03_lol","@;-)|04_wink","-/|05_skeptik","@o.O|06_blink","(|07_sad","@8-)|08_cool","-p|09_bebe","@8-O|10_shok","-o|11_ohmy","'-(|12_plak","'O|12_plaksa","@>:[|13_angry","@>:O|14_mat","-?|15_blush","!:|17_shout","-.|18_unsure","vsemprivet|19_Privet","poka|20_Poka","roza|24_roza","-*|25_kiss","skalka|26_skalka","pivo|27_pivo","devil|28_devil","dash|29_dash","druzhba|30_druzhba","kur|31_kur","kofe|33_cofe","martini|34_martini","idiot|35_idiot","fingal|36_fingal","zlodej|37_zlodej","uzhas|38_Uzhas","druzhba3","figa","poka2|poka","super","chay|tea","?:|vopros"],["alkogolik","bolen","boleyu","budilnik","dozhd","hrap","hrenovo|hrenovo2","kofein","pil","pila","schastje|pismo_schastja","ploho","rascheska","spit","spit2","zamerz","zasyp","zawtoroj","zevaet","zvezdy"],["aaa","afiget","afiget2","ah","ah2","balbes","bis","blabla","bur2","cool","dash1","dash2","dash3","dash4","dik","dovolen","dovolen2","dovolna","druzhba","druzhba2","dum","dum2|dumaet","fak","figase","fing","fu","fuu","glaza","gnev","gordo","haha","help","hm","hnyk","idea","ispug","isterika","jazyk","jeh","kras|krasn","kubok","lol","lol2","mat","mda","mdja","neveryu","nevozm","nifiga","novichek","nyam","or","pardon","pardon2","pasiba","plak","plaksa","plaksa2","plushit","podmig","podmig2","poh","prelest","rzhu","sad","sarkastik","sarkastik2","sluni","smeh","smeh2","smewim","sorri","svist","tanz","ukaz","umora","upal","ura","ura2","vopros","wutka","yahoo","yeh","zharko"],["zubch2|chistit","chit2","chit3","dergaet","duw","edu","fotograf","gotovit|govorit","hudozh","igra","igra2","karty","khozyayka","kompolom","kormit","kovyr","kovyr2","kovyr3","kubik","kuku","kuku2","kur","lak","lechitsja","lechu","marafet","megafon","microfon","mob","muha","nepovezlo","night","piosmok","puzyr","pylesos","rasta","remont","drova|rubit_drova","smart","vdal|smotrit_vdal","sortir","sortir2","spicy","telefon","vochkah","wepchem","zerkalo","zerkalo2","zubch"],["2serdca","Ilove","banany","broke","chmak","chmok","chmok2","chmok3","condom","daryserd","feministka","flirt","flirt2","gadaet","inlove","inlove1","inlove2","inlove3","kiss","kiss2","kiss3","kiss4","kruzhit","lapuwka","lesbi","mail2","mama","miwka","myheart","nolove","nravitsya","obnimki","obozhayu","pink","serdce","serenada","sex","sex2","sex3","stesnit","stesnit2","strela","stydno","svadba","svadba2","tanec","vkusna","vlob","|vozdp","vruku","zaigryvaet"],["cvetok1","cvetok2","cvetok3","cvetok4","romawki","roza","roza1","roza2","roza3","roza4","roza5"],["2pistoleta","2pistoleta2","asasin","atata","bita","bomba","box","draka","flag","flag2","granatomet","gun","gun2","karate","lowadka","luchnik","luchnik2","molotkom","nakazan","nozh","orc","palach","paladin","pogolove","popope","posh","rugan","russoldat","star","tomat","varvar","vglaz","vglaz2","vglaz3","zdayus"],["bajan","baraban","dance","dance2","disko","disko2","disko3","dj","garmon","gitara","gitara2","gitara3","gitara4","gitara6","harp","muzon","punk2","rojal","skripka","stereo","truba"],["Faq","ICQ","lovesp|LoveSp","Moder1","Moder2","Moder3","OOps","Shutup","Sorry","welcome|Welcome","actoy","ban","ban2","bye","flood","google","hello","kleva","klever","owibochka","perv","pivanet","russkiy|russkij2","super2","tLol","tkiss","translit","vsempr","vt","glavnij|ya_admin","yy","zamechanie"],["alarm","banan","mail|mailman","mog","mozilla","opera","pravila","siski","siski2","solnce","sun","teleskop","vanna","vantuz","vgosti","zima","zvezda"],["aikido","basket","beg","best","bobslej","bodibuild|bodibild","boks","cska","dinamo","fanat","fanaty","ganteli","ganteli2","loko","lyzhi","mjach","nhl","olimp","parus","plavaet","russia1","russia2","rybalka2","surf|serf","sharf","sharf2","spartak","tennis","tennis2","trening","velo2","vodolaz","wtanga","zenit"],["2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","happy2|birthday","dedmoroz|ded_moroz","dedmoroz2|ded_moroz2","dedmoroz3|ded_moroz3","dedmoroz4|ded_moroz4","dedsnegur|ded_snegur","elka","elka2","elka3","elka4","happy","hlopushka","ng","salut","salut2","salut3","santa","santa2","santa3","snegur","snezh","snezhok","snezhok2","snezhok3","vmeshke","wamp","wamp2"]],[["ysure11|yeahsure","reaction11|sreaction","slowpke11|slowpoke","pedobear11|pedobear","omsk11|omsk","ololo11|ololo","ohstopit11|ohstopit","godwhy11|ohgodwhy","notokay11|notokay","notodohere11|nothingtodohere","yoba|noone","newstear11|newsguytear","news11|newsguy","milk11|milk","lied11|lied","imwatch11|imwatchingu","harp11|harp","grin11|grin","gangnam11|gangnam","fucku11|fucku","freddie11|freddie","fap11|fap","devtroll11|deviltroll","danctroll11|dancingtroll","ctroll11|crazytroll","conflic11|conflicting","concent11|concentratedsw","compdude11|compdude","cereal11|cereal","bored11|bored","badpoker11|badpoker","axe11|axe","awesome11|awesome","amazed11|amazed","why11","tffBlonde11|thefuckFemaleBlonde11","tffemale11|thefuckFemale11","hahahah11","gaspcat11","atthings11|allthethings11","yuno11","what11","veryangry11","thumbup11","thinks11","tfeel11|thatFeel11","stare11","spman11|spiderpman11","smile11","rpuke11|rainbowPuke11","ohgod11|ohGod11","ffuu11","evil11","drunk11","deskflip11","cry11","cspitting11|cerealSpitting11","bad11","angry11","truestory11|truestory","alone11|alone","goodjob11|goodjob","rocknroll11|rocknroll","whatyoutalk11|whatyoutalk","okay11|okay","trollfacewoman11|trollfacewoman","accepted11|accepted","notbad11|notbad","pokerface11|pokerface","ifyouknow11|ifyouknow","fuckyeah11|fuckyeah","love11|love","lol11|lol","pftch11|pftch","forevelalone11|forevelalone","facepalm11|facepalm","kiddingme11|kiddingme","no11|no","facesfemale11|facesfemale","areyouserious11|areyouserious","cageyoudontsay11|cageyoudontsay","thumbsup11|thumbsup","happyface11|happyface","trollface11|trollface","yaoming11|yaoming","youdontsay11|youdontsay","determined11|determined","please11|please","megusta11|megusta"],["cupid22|kos_cupid","devil22|kos_anger","horror22|kos_affright","wonder22|kos_surprise","work22|kos_busy","tired22|kos_tired","facepalm22|kos_facepalm","sorry22|kos_sorry","lol22|kos_lol","no22|kos_no","bye22|kos_bye","rock22|kos_rock","shy22|kos_confused","flowers22|kos_flowers","thanks22|kos_thanks","play22|kos_play","angel22|kos_angel","inlove22|kos_love","cool22|kos_awesome","laugh22|kos_laugh","yes22|kos_yes","hi22|kos_hi","spacer22|kos_spaces"],["bstears33|blonde_sweet_tears","brsuper33|blonde_rage_super","brshaking33|blonde_rage_shaking","brmad233|blonde_rage_mad2","bquite33|blonde_quite","bwnhands33|blonde_why_no_hands","btroll33|blonde_troll","btsad33|blonde_troll_sad","bsmile33|blonde_smile","brtongue33|blonde_red_tongue","brquiet33|blonde_rage_quiet","brmad33|blonde_rage_mad","brgpssd33|blonde_rage_getting_pissed","bpface33|blonde_pokerface","bpfft33|blonde_pfft","bokay33|blonde_okay","bmgusta33|blonde_me_gusta","blol33|blonde_lol","bhmmm33|blonde_hmmm","bfyeah33|blonde_fuck_yeah","bfchtb33|blonde_fuck_that_bitch","bfalone33|blonde_forever_alone","betears33|blonde_excited_tears","bewbte33|blonde_ewbte","bdude33|blonde_dude","bdetermined33|blonde_determined","bdazed33|blonde_dazed","bcrying33|blonde_crying","bconcentrated33|blonde_concentrated","bbsmile33|blonde_big_smile"],["cyzanyat44|cosm_yur_zanyat","cyyessir44|cosm_yur_yes-sir","cyuhaha44|cosm_yur_uhaha","cysvoboden44|cosm_yur_svoboden","cysuperman44|cosm_yur_super-man","cystop44|cosm_yur_stop","cysleepy44|cosm_yur_sleepy","cyskuchno44|cosm_yur_skuchno","cyskuchayu44|cosm_yur_skuchayu","cysexy44|cosm_yur_sexy","cyplachu44|cosm_yur_plachu","cyomnomnom44|cosm_yur_omnomnom","cyok44|cosm_yur_ok","cyobnimi44|cosm_yur_obnimi","cyobidelsya44|cosm_yur_obidelsya","cynonono44|cosm_yur_nonono","cyneznayu44|cosm_yur_ne-znayu","cynet44|cosm_yur_net","cymolchy44|cosm_yur_molchy","cylovely44|cosm_yur_lovely","cyklass44|cosm_yur_klass","cyhungry44|cosm_yur_hungry","cyhmmm44|cosm_yur_hmmm","cybye44|cosm_yur_bye","cyhello44|cosm_yur_hello","cyheiyou44|cosm_yur_hei-you","cyfacepalm44|cosm_yur_facepalm","cyda44|cosm_yur_da","cybeee44|cosm_yur_beee"],["cblacklol","cfyeah","cpokerface","csmile","cithought","chehehe","cmoney","cmalice","clol"]]],st_categories:[[null,"01_Smile1.gif"],["","megusta_min.png"],["","kosm_ico.gif"],["Ragefaces Female","st/t/blonde.gif"],[" ","st/t/cytumb.gif"],[" ","st/t/csmile_small.gif"]]}});define("smiles_menu","init",function(){function r(){addClass(d,"hide"),d.innerHTML="",u&&u(),u=o=d=null}function s(s){var e,i,a,l,t,n=this.href.split("#");if(!(n.length<2)){if(s&&s.preventDefault&&s.preventDefault(),i=(e=n[1].split("="))[0],a=e[1],l=ge(".smiles_menu-body",d)[0],"sm-cat"==i)l.innerHTML=g.smileCat(a,"smiles");else if("sm-tab"==i)l.innerHTML=+a?g.smileCat(a,"stickers"):g.smilesCat();else{if("sm-exit"==i)return void r();"smiles"!=i&&"stickers"!=i||(a=a.split("-"),t=SpacesSmiles.list["smiles"==i?0:1][a[0]][a[1]].split("|"),o(c(t).name),tick(r))}return m(),!1}}function m(){!function(s,e){for(var i=0;i<s.length;++i)s[i].onclick=e}(d.getElementsByTagName("a"),s)}function c(s){var e,i=s[0];return i=0<=i.indexOf("@")?i.substr(1):":"+i,e=1==s.length?":"==i.charAt(0)?i.substr(1):i:s[1],{name:i,src:e}}var d,f,o,u,g={menu:function(s){var e,i,a=SpacesSmiles.st_categories,l="",t='<a href="#sm-exit" id="sm_exit_'+s+'"><span class="ico ico_remove close"></span></a>';if(1<a.length){for(l+='<div class="smiles_menu-header">',e=0;e<a.length;++e)l+='<a href="#sm-tab='+e+'" title="'+((i=a[e])[0]||L(""))+'"><img src="'+ICONS_BASEURL+i[1]+'" alt="" /></a>';l+=t+"</div>"}else l+=t;return l+='<div class="smiles_menu-body">'+g.smilesCat()+"</div>"},smilesCat:function(){var s,e,i=SpacesSmiles.categories,a="";for(a+='<div class="smiles_menu-categories lh_160">',s=0;s<i.length;++s)a+='<a href="#sm-cat='+s+'">'+(e=i[s])[0]+' <img src="'+ICONS_BASEURL+e[1]+'" alt="" class="middle" /></a>';return a+="</div>"},smileCat:function(s,e){var i,a,l,t,n="";if("stickers"==e){for(--s,i=SpacesSmiles.list[1][s],n+='<div class="stickers_list t_center">',(a=f[s])&&(n+="<div>"+L("    .")+'<br /> <a class="inl_bl" style="padding: 5px" href="'+a+'">'+L("  12 ")+"</a></div>"),l=0;l<i.length;++l)t=c(i[l].split("|")),n+='<a href="#'+e+"="+s+"-"+l+'"><img src="'+ICONS_BASEURL+"st/t/"+t.src+'.gif" smile="'+t.name+'" /></a> ';a&&(n+='<div><a class="inl_bl" style="padding:5px" href="'+a+'">'+L(" &raquo;")+"</a></div>"),n+="</div>"}else{for(i=SpacesSmiles.list[0][s],n+='<div class="smiles_list">',l=0;l<i.length;++l)t=c(i[l].split("|")),n+='<a href="#'+e+"="+s+"-"+l+'"><img src="'+ICONS_BASEURL+t.src+'.gif" smile="'+t.name+'" /> </a> ';n+='</div><div class="stnd_padd smiles_menu-back"><a href="#sm-tab=0"><img src="'+ICONS_BASEURL+'ico/arrow-back.png" alt="" class="m" />&nbsp;<span class="m"> '+L("   ")+"</span></a></div>"}return n}};window.SmilesMenu={toggle:function(s,e,i,a,l){var t,n;(d=ge("#sm_"+s))||(d=ce("div",{id:"sm_"+s,className:"smiles_menu hide"}),e.appendChild(d)),t=hasClass(d,"hide"),i&&t?((n=ge("#toolbar_payload"))&&(f=light_json(n.getAttribute("data-stickers")||"[]")),o=i,u=l,removeClass(d,"hide"),d.innerHTML=g.menu(s),m(),a&&a()):(r(),o=d=null)}}});define("attach_selector","init",function(){"use strict";var d,i,p,r,u,h,n,_,f,l,m,o,c,e,v,s,g,S;"operamini"!=Device.browser&&(d={},i=[Spaces.TYPES.PICTURE,Spaces.TYPES.MUSIC,Spaces.TYPES.VIDEO,Spaces.TYPES.FILE],d[Spaces.TYPES.FILE]={name:L(""),title:L(""),title2:L(""),icon:"ico_mail ico_mail_file",type:Spaces.TYPES.FILE,sex:1},d[Spaces.TYPES.VIDEO]={name:L(""),title:L(""),title2:L(""),icon:"ico_mail ico_mail_video",type:Spaces.TYPES.VIDEO,sex:0},d[Spaces.TYPES.MUSIC]={name:L(""),title:L(""),title2:L(""),icon:"ico_mail ico_mail_music",type:Spaces.TYPES.MUSIC,sex:1},d[Spaces.TYPES.PICTURE]={name:L(""),title:L(""),title2:L(""),icon:"ico_mail ico_mail_picture",type:Spaces.TYPES.PICTURE,sex:0},p={0:"comm",1:"user"},/^http(s?):\/\/|#.*?$/gi,r={},u=1e4,n=0,l=f=!(_={typeSelect:function(t){var e,a,s='<div class="links-group links-group_grey">';for(e=0;e<i.length;++e)a=d[i[e]],t.types&&$.inArray(+a.type,t.types)<0||(s+='<a href="#" class="list-link js-select_file" data-type="'+a.type+'"><span class="'+a.icon+'"></span> '+a.name+"</a>");return s+='<a href="#" class="list-link js-dd_menu_close"><span class="ico ico_remove"></span> '+L("")+"</a></div>"},quickSelector:function(t){return'<div class="links-group links-group_grey hide" data-view="action" data-empty="1"></div>'+(t.upload?'<div class="upload-dnd_msg js-attach_dnd"><div class="js-dnd_msg"></div></div>':"")+'<div class="hide" data-view="upload_progress"><div class="static-bl js-qsel_link_upload"><div class="grey pad_b_a"> ...</div>'+_.spinner3()+'</div></div><div class="hide" style="background: #FFF; color: #323232;" data-view="upload"><div class="js-qsel_upload_file"></div><div class="js-qsel_upload_widget_wrap"><div class="js-qsel_upload_widget"></div></div></div><div class="links-group links-group_grey hide" data-view="main"><table class="table__wrap'+(t.sources?"":" hide")+'"><tr><td class="table__cell links-group links-group_grey table__cell_last" width="50%"><a href="#" class="list-link upper_case b js-attach_source" data-source="comm">'+L("")+'</a></td><td class="table__cell links-group links-group_grey table_cell_border" width="50%"><a href="#" class="list-link js-attach_source upper_case b" data-source="user">'+L(" ")+'</a></td></tr></table><div class="js-qsel_main"><div class="b-title b-title_first b-title_in-window'+(t.showSlider?"":" hide")+'">'+d[t.type].title+' <span class="js-qsel_cnt cnt hide">0</span><a href="#" class="link-imp right js-qsel_all"><span class="js-qsel_all_spinner hide ico f__ico_spinner2"></span> '+L("")+' <span class="ico ico_arrow"></span></a></div><div class="js-qsel_carousel'+(t.showSlider?"":" hide")+'"></div><div class="js-qsel_error" style="color: red"></div><div class="links-group links-group_grey"><div class="js-qsel_upload_err stnd-block error__msg content-bl__sep hide"></div>'+(t.upload?'<span class="list-link list-link_first js-qsel_upload_btn disabled"><span class="js-content"><span class="ico ico_upload js-upload_btn_ico hide"></span> <span class="ico f__ico_spinner2 js-upload_btn_spinner"></span> '+(d[t.type].sex?L(" "):L(" "))+"</span></span>":"")+(t.linkDownload?'<div class="static-bl js-qsel_link_upload"><label class="label text">'+L("  :")+'</label><table class="table__wrap table__wrap-layout"><tr><td style="width: 100%" class="table__cell"><div class="text-input__wrap"><input type="text" class="text-input js-qsel_link_input" data-no_paste="1" value="" placeholder="'+L(" ")+'" /></div></td><td class="table__cell padd_left"><button disabled="disabled" type="submit" class="btn btn_input js-qsel_download_url_btn" name="qsel_select_btn">'+L("")+"</button></td></tr></table></div>":"")+'<div class="qsel-cust_btn"></div>'+(t.attaches?'<table class="table__wrap"><tr class="js-upload_state-uploading" style="display: table-row;"><td class="table__cell links-group links-group_grey table__cell_border" width="50%"><a href="#" class="list-link list-link-blue js-qsel_select_btn disabled"><span class="ico ico_plus"></span> <span class="t">'+t.attachBtnName+'</span></a></td><td class="table__cell links-group links-group_grey table__cell_last" width="50%"><a href="#" class="list-link js-dd_menu_close" id="upload_cancel_btn"><span class="ico ico_remove"></span> <span class="t">'+L("")+"</span></a></td></tr></table>":'<a href="#" class="list-link list-link_last js-dd_menu_close"><span class="ico ico_remove"></span> '+L("")+"</a>")+"</div></div></div>"},spinner:function(){return _.message({text:'<span class="ico f__ico_spinner2"></span> '+L("...")})},spinner2:function(t){return'<div class="js-tmp_spinner list-link-darkblue stnd_padd content-bl__sep"><span class="ico f__ico_spinner2 m"></span> <span class="m">'+t+"</span></div>"},spinner3:function(){return'<div class="progress-item js-tmp_pg_spinner"><div class="progress-item__runner progress-item__runner_anim"></div></div>'},dndPlace:function(){return'<div class="upload-dnd_msg"><div class="js-dnd_msg"></div></div>'},message:function(t){return'<div class="content-bl content-bl_first content-bl__sep">'+t.text+"</div>"},error:function(t){return _.message({text:'<span style="color: red">'+t.text+"</span>"})+(t.no_button?"":'<button class="menu_back btn-main js-qsel_back" data-back_view="'+(t.back||"main")+'"><span class="ico ico_remove"></span> '+L("")+"</button>")},attach:function(t){return t.show_preview?'<div class="tiled_item js-attach_item tiled_item-128 tiled_fixed" id="'+t.nid+"_"+t.type+'"><div class="tiled_inner t_center relative"><div class="tiled-preview"></div></div></div>':'<div class="stnd_padd oh js-attach_item attaches_item" id="'+t.nid+"_"+t.type+'"><div class="stnd-block inh-size transp_bg stnd-block_outer-mrg"><span class="ico f__ico_spinner2"></span></div></div>'},musicList:function(t){var e,a,s='<div class="links-group links-group_grey">';for(e=0;e<t.files.length;++e)s+='<a href="'+(a=t.files[e]).preview.URL+'" class="list-link list-link_select_item js-qsel_select_music" data-nid="'+a.nid+'" data-type="'+a.type+'" data-name="'+a.artist+" - "+a.title+'"><span class="ico ico_photo_select"></span><div class="no_word_break"><span class="ico ico_music"></span> <b>'+a.artist+"</b> - "+a.title+"</div></a>";return s+="</div>"},uploadProgressWrap:function(t){return'<div class="stnd_padd light_border_bottom grey pointer js-qsel_upload_progress_wrap"></div>'},disabledUploadError:function(){return L("    .")+"<br />"+L("   ,   {0}  .",'<a href="#" class="js-attach_source" data-source="user">'+L(" ")+"</a> ")}}),o={},c={},g=!(v=[]),S=Class({Static:{init:function(){var i=this;$("#main").on("click",".js-attach_delete",function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var e=$(this),a=i.instance(e),s=S.parseId(e.data("id"));a.deleteAttach(s.nid,s.type)}).on("click",".js-attach",function(t){i.setup(this)}).on("click",".js-postpone",function(t){t.preventDefault();var e=$(this),a=e.parents("form"),s=a.find(".js-postpone_state");a.find(".js-postpone_form").toggleClass("hide"),e.find(".js-ico").toggleClass("ico_history ico_history_black"),s.val(+s.val()?0:1)}),i._initDND()},parseId:function(t){var e=t.match(/(\d+)_(\d+)/);return{nid:+e[1],type:+e[2],id:t}},parseFile:function(t){return $.extend(this.parseId(t.attr("id")),t.data())},_initUploader:function(){var a,s,e=this;g||(g=!0,a=function(t){t.state.limit<2&&(t.view("main",!0),t.view("upload").find(".js-qsel_upload_file").empty(),t.view("upload").find(".js-qsel_upload_widget_wrap").show())},s=[],FileUploader.init({buttonClass:{hover:"strong_clicked",active:"strong_clicked_active"},autoSubmit:!0,noDragClass:!0,removeAfterUpload:!0,multiple:!0,onSubmit:function(t){var e,a;l=!0,(e=o[t.id]).state.limit<2&&(e.state.noAutoSelect||e.sliderSelect(),f=!0,e.view("upload",!0)),a={},e.state.dir!==undefined?a.dir=e.state.dir:(a.Att=1,e.state.privateAttaches&&(a.Ss=1)),e.state.commId&&"comm"==m&&(a.Comm=e.state.commId),e.state.talkId&&(a.Talk=e.state.talkId),FileUploader.setPostData(a)},onShowNative:function(){S.active().view("upload",!0)},onFileUpload:function(t,e){l=f=!1;var a=t.data,s=o[e.id];s.onAttachSelect(a,!0,!!c[e.id])&&s.saveAttaches([a]),s.state.limit<2&&s.menu.close()},onError:function(t){l=f=!1;var e=S.active();e&&e.showError(t)},onFileError:function(t,e){var a=S.active();a&&a.state.limit<2&&a.showError(e)},onHideError:function(){},onReset:function(t){l=f=!1,t&&a(e)},onNewFileAdd:function(t){var e,a=S.active();return a.state.proxyUpload?(t.file.file._spaces={type:a.current_type,bb:!0},s.push(t.file.file),!1):!!a.state.upload&&(a.state.uploadError?(a.showError(a.state.uploadError),!1):((e=t.file.file._spaces)&&e.bb&&(c[t.file.id]=!0),void(1<(o[t.file.id]=a).state.limit?(a.onAttachUpload(t.file.id,t.widget),t.file.error&&tick(function(){a.menu.close()})):(a.view("upload").find(".js-qsel_upload_widget_wrap").hide(),a.view("upload").find(".js-qsel_upload_file").empty().append(_.uploadProgressWrap()),a.view("upload").find(".js-qsel_upload_progress_wrap").append(t.widget)))))},onFilesChunkEnd:function(t){var e=S.active();if(e.state.proxyUpload)return e.menu.close(),void tick(function(){e.parent.form.trigger("files",{files:s}),s=[]});e.state.noAutoSelect||e.sliderSelect(),e.checkAttList()},onAfterAutoSubmit:function(){var t=S.active();1<t.state.limit&&t.menu.close()},onRemoveFile:function(t){var e=o[t.id];e.checkAttList(),a(e),tick(function(){e.checkComplete()})},onGetTotal:function(t){var e=S.active();t.total=e.getTotal()}}))},_initDND:function(){var s=function(t,e){t.find(".upload-dnd_msg").toggleClass("upload-dnd_msg_active",e).find(".js-dnd_msg").text(e?L("  ,   ."):L("  ,     ."));$(".upload-dnd_msg .js-dnd_msg").each(function(){var t,e,a=$(this),s=$(window),i=s.scrollTop(),n=s.innerHeight(),l=a.parent(),o=l.offset(),c=l.height();c&&(o.top<i||o.top+c>i+n)?(t=Math.max(i,o.top),e=Math.min(o.top+c,i+n),a.css("top",(e-t)/2+Math.max(0,i-o.top)+"px")):a.css("top","50%")})};pushstream&&pushstream.on("message","media_urls",function(t){if(t.act==Spaces.LongPollingTypes.LOADED_FILE&&h){var e=((Date.now()-h.time)/1e3).toFixed(2);0==t.code&&t.data?(console.log("[getImage] "+h.url+" - OK ("+e+"s)"),h.callback(t)):(console.log("[getImage] "+h.url+" - server error ("+e+"s): "+Spaces.apiError(t)),h.callback(!1,!1,Spaces.apiError(t)))}}),page_loader.on("formsubmit","media_urls",function(t){var e=$(t.form),a=$(t.form.submit_btn),s=AttachSelector.instance(a),i=function(){e.find("textarea").removeAttr("disabled").each(function(){var t=$(this);t.val(s.stripUrls(t.val()))})};if(s)return!e.data("disabled")&&(AttachSelector.isBusy()?(e.data("disabled",!0),e.find("textarea").attr("disabled","disabled"),AttachSelector.onDone(function(){e.removeData("disabled"),i(),a.click()}),!1):void i())},{persistOnRequest:!0}),$("#main").on("dragGlobalStart",function(){var t,e,a=S.active();if(a)a.upload_inited&&((t=a.menu.content()).addClass("upload-dnd_msg_show"),s(t,!1));else for(e=0;e<v.length;++e)(a=v[e])&&((t=a.state.form).addClass("upload-dnd_msg_show"),s(t,!1))}).on("dragGlobalEnd",function(){var t,e=S.active();if(e)e.upload_inited&&e.menu.content().removeClass("upload-dnd_msg_show");else for(t=0;t<v.length;++t)(e=v[t])&&e.state.form.removeClass("upload-dnd_msg_show")}).on("fileDragStart",".js-attach_dnd",function(){!0,s($(this),!0)}).on("fileDragEnd",".js-attach_dnd",function(){!1,s($(this),!1)}).on("pasteurl",".js-attach_dnd",function(t,e){var a=S.instance($(this));a&&a.loadImages(e.urls)}).on("files",".js-attach_dnd",function(t,e){var a,s,i,n,l,o;if(t.stopPropagation(),t.stopImmediatePropagation(),a=S.active())FileUploader.addFiles(e.files);else{for(a=S.instance($(this)),s={"image/pjpeg":Spaces.TYPES.PICTURE,"image/jpeg":Spaces.TYPES.PICTURE,"image/jpg":Spaces.TYPES.PICTURE,"image/gif":a.typeAllowed(Spaces.TYPES.FILE)?Spaces.TYPES.FILE:Spaces.TYPES.PICTURE,"image/png":Spaces.TYPES.PICTURE,"audio/mp3":Spaces.TYPES.MUSIC},i={},n=0;n<e.files.length;++n){if(l=e.files[n],o=Spaces.TYPES.FILE,l.name?o=Spaces.getFileType(l.name.split(".").slice(-1)):l.type&&(o=s[l.type.toLowerCase()]||Spaces.TYPES.FILE),l._spaces&&(o=l._spaces.type),!a.typeAllowed(o))return;i[o]||(i[o]=[]),i[o].push(l)}a&&(1<a.state.limit&&a.showProgress(!0),$.each(i,function(t,e){0<e.length&&(a.state.limit<2?(a.menu.open(),a.quickSelector(t,!0,function(){FileUploader.addFiles(e)},!0)):a.setupUploader(t,!1,function(){S.active(a),a.showProgress(!1),FileUploader.addFiles(e),S.active(null)}))}))}})},active:function(t){return t!==undefined&&(e=t),e},instance:function(t){return((t=$(t)).hasClass("js-attaches_form")?t:t.parents(".js-attaches_form")).data("AttachSelector")},destroy:function(){for(var t=0;t<v.length;++t)v[t].destroy();g=l=f=!(v=[]),n=0,o={},c={},e=null},delayedInit:function(){var a=this;s||(s=setTimeout(function(){$(function(){var t,e=$(".js-attach");for(t=0;t<e.length;++t)a.setup(e[t]);s=null})},0))},setup:function(t){var e=$(t);return e.data("AttachSelector")||e.data("AttachSelector",new S(e)),e.data("AttachSelector")}},Constructor:function(t){var e,a,s,i=this,n=t.data("form")?$(t.data("form")):t.parents("form"),l=t.data("list")?$(t.data("list")):n.hasClass("js-attaches")?n:n.find(".js-attaches"),o=$.extend({upload:!0},t.data(),l.data());n.hasClass("js-attaches_form")&&!t.data("allowAlias")||(v.push(i),i.new_attaches=[],i.default_selected=[],n.addClass("js-attaches_form").data("AttachSelector",i),o.fallback||(o.fallback=t.prop("href")),e=n.find(".js-attach"),a=[],e.length||(e=t),e.each(function(){$.each($(this).data("fileTypes"),function(t,e){$.inArray(+e,a)<0&&a.push(+e)})}),i.state={id:"",link:t,form:n,avatar:o.avatar,talkId:o.talk,commId:o.comm,exVideo:o.exVideo,onlyUpload:!!o.only_upload,onlyComm:o.comm&&o.only_comm,dir:o.dir,file_type:o.file_type,buttons:o.buttons,privateAttaches:!o["public"],allowedTypes:a,linkDownload:o.linkDownload,attaches:o.attaches===undefined||!!o.attaches,attachesList:l,proxyUpload:o.proxyUpload,fallbackUrl:o.fallback,upload:o.upload,spoiler:o.spoiler?"#"==o.spoiler[0]?$(o.spoiler):n.find(o.spoiler).first():"",noAutoSelect:o.noAutoSelect,oid:o.oid,ot:o.ot,pid:o.pid,limit:o.max_files||Spaces.LIMIT.ATTACHES},i.state.mode="picker",(i.state.attachesList.length||i.state.proxyUpload)&&(i.state.mode="attaches"),i.state.attaches&&(i.state.linkDownload=!0),i.state.flat=!0,i.state.spoiler&&i.state.spoiler.length?i.state.flat=!i.state.spoiler.data("wrap"):i.state.spoiler=!1,i.state.proxyUpload||(s=$(_.dndPlace()),i.state.form.addClass("js-attach_dnd").filesMonitor().prepend(s)),i.link=e,i.form=n,i.list=l,i.list.length&&"desktop"==Device.type&&i._initDragDrop(),i._setup())},_setup:function(){var t,s=this,i=new Spaces.DdMenu({flat:s.state.flat,data:{scroll:!0,spoiler:s.state.spoiler,toggle_same:!0}});s.link.each(function(){i.link($(this).data("no_label",!!s.state.spoiler))}),i.element().on("dd_menu_open",function(){if(i.opener().data("locked"))return!1}).on("dd_menu_toggle",function(t,e){var a=e.link.data("fileTypes");if(!e.sameLink&&a&&1==a.length)return i.close(),e.link.click(),!1}).on("dd_menu_opened",function(){var t,e,a=i.opener();m=s.state.onlyComm?"comm":Spaces.LocalStorage.get("attach_selector_source","comm"),(e=(t=a.data("fileTypes"))&&1==t.length&&t[0]||a.data("temp_type")||s.state.file_type)?(a.removeData("temp_type"),s.quickSelector(e)):(i.content().empty().append(_.typeSelect({types:s.state.allowedTypes})),Spaces.DdMenu.fixSize()),S.active(s)}).on("dd_menu_close",function(t){f?t.preventDefault():(0<s.new_attaches.length&&s.saveAttaches(s.new_attaches),s.free(),Spaces.fixHeight(),S.active(null),s.state.form&&s.state.form.trigger("AttachSelectorClose"))}).on("click",".js-select_file",function(t){t.preventDefault(),t.stopPropagation(),s.quickSelector($(this).data("type"),!0)}).on("click",".js-qsel_upload_btn",function(t){var e,a;if(t.stopImmediatePropagation(),s.state.uploadError&&(t.preventDefault(),t.stopPropagation(),s.showError(s.state.uploadError)),FilesUploader.needStaticUpload()){if(s.state.fallbackUrl instanceof $)return s.state.fallbackUrl.one("click",function(t){t.stopPropagation(),t.stopImmediatePropagation()}).click(),!1;if(s.state.fallbackUrl)return location.assign(s.state.fallbackUrl),!1;if(e=s.link,/^input|button$/i.test(e[0].tagName)||(e=e.find('button, input[type="submit"]').first()),a=e.parents("form"),e.length&&a.length)return Spaces.DdMenu.close(),s.link.data("disabled",!0),setTimeout(function(){a.on("submit._att_select",function(t){t.stopPropagation(),t.stopImmediatePropagation()}),a.addClass("no_ajax"),a.data("preventSubmit",!0),e.trigger("click",{ignoreEvent:!0}),tick(function(){a.data("preventSubmit",!1),a.off("submit._att_select")})},0),!1;s.showQSelError(L("   .   <a href='/soo/support'>Support</a>"))}}).on("click",".js-attach_source",function(t){t.preventDefault(),t.stopPropagation(),m=$(this).data("source"),Spaces.LocalStorage.set("attach_selector_source",m),s.free(),s.quickSelector(s.current_type)}).on("click",".js-qsel_back",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).data("back_view");"exit"==e?i.close():s.view(e,!0)}).on("click",".js-qsel_download_url_btn",function(t){t.preventDefault(),t.stopPropagation(),$(this).attr("disabled")||s.loadUrl()}).on("click",".js-qsel_select_btn",function(t){t.preventDefault(),t.stopPropagation(),$(this).hasClass("disabled")||(s.sliderSelect(),i.close())}).on("click",".js-qsel_select_music",function(t){var e;return t.preventDefault(),t.stopPropagation(),e=Spaces.core.extractFile($(this)),s.state.limit<2?s.checkParentLimit()?s.onAttachSelect(e)&&i.close():s.markMusic(e.nid,!1):(s.markMusic(e.nid)?(s.deleteAttach(e.nid,e.type),s.showQSelError("")):s.getAvail()<0&&(s.markMusic(e.nid,!1),s.limitError()),s._showSelectBtn()),!1}).on("click",".js-qsel_all",function(t){var e,a;if(t.preventDefault(),t.stopPropagation(),1<s.state.limit){if((e=s.getAvail())<=0)return void s.limitError();s.sliderSelect()}else if(!s.checkParentLimit())return;$(this),s.view("main").find(".js-qsel_all_spinner").removeClass("hide"),a={},"mail"==s.state.avatar?a.Talk_logo=1:"comm"==s.state.avatar?a.Comm_logo=1:"user"==s.state.avatar?a.User_photo=1:"picker"==s.state.avatar&&(a.Ad_photo=1),require("files_selector",function(){FilesSelector.open({attaches:!0,commId:s.state.commId,talkId:s.state.talkId,commSection:"comm"==m||s.state.onlyComm?0:1,hideTabs:s.state.onlyComm,type:s.current_type,maxFiles:e,apiData:a,onFileMultiSelect:function(t){for(var e=0;e<t.length;++e)s.onAttachSelect(Spaces.core.fixFile(t[e]));s.saveAttaches(s.new_attaches),s.new_attaches=[]},onExit:function(){i.close()}})})}).on("input change paste keydown",".js-qsel_link_input",function(t){tick(function(){s._showSelectBtn()})}),(t=s.state.spoiler)&&(t.after(i.element().detach().addClass(t.attr("class"))),t.remove()),s.menu=i},showProgress:function(t){this.state.attachesList.find(".js-tmp_pg_spinner").remove(),t&&this.state.attachesList.prepend(_.spinner3()),this.checkAttList()},setSection:function(t){this.menu.content().find(".list-link.js-attach_source.clicked").removeClass("clicked"),this.menu.content().find('.list-link.js-attach_source[data-source="'+t+'"]').addClass("clicked"),m=t},loadImages:function(t,n){var e,a,s,i,l,o=this,c=function(t){n&&o.showError(t)};if(o)if(pushstream.avail())if(h)c(L("     ."));else{if("attaches"!=o.state.mode||o.getAvail()){for(e=RegExp("(\\.|^)("+location.hostname.replace(/(\.)/g,"\\$1")+")(\\.?)$","i"),a=0;a<t.length;++a)if(s=t[a],e.test(s.domain))c(L("C  ."));else if(n||!1!==r[s.url]){h={url:s.url,time:Date.now()};break}return!!h&&(h.photo="picker"==o.state.mode,h.callback=function(t,e,a){var s,i=h;h=null,n?f=!1:o.showProgress(!1),s=t.data?Spaces.core.fixFile(t.data):t,i.timeout&&clearTimeout(i.timeout),s&&!s.blocked?(o.state.privateAttaches&&(s._private_attach=!0),r[i.url]=s,o.onAttachSelect(s,!0)&&o.saveAttaches([s]),o.menu.close()):(c(a||L("    .")),t&&console.log("[getImage] "+i.url+" - "+(s&&s.blocked?"file blocked":"invalid upload answer")),e||(r[i.url]=!1),o.checkComplete())},!(i=r[h.url])||i._private_attach&&!o.state.privateAttaches?(n?(f=!0,o.view("upload_progress",!0)):o.showProgress(!0),l={link:h.url,Ss:o.state.dir===undefined&&o.state.privateAttaches,CK:null},h.photo&&(l.Type=Spaces.TYPES.PICTURE),o.state.commId?l.Comm=o.state.commId:o.state.talkId&&(l.Talk=o.state.talkId),Spaces.api("files.getImage",l,function(t){h&&(0!=t.code?(console.log("[getImage] "+h.url+" - error"),c(Spaces.apiError(t)),h.callback(!1)):(h.time=Date.now(),t.data?(console.log("[getImage] "+h.url+" - OK (exists)"),h.callback(t)):(console.log("[getImage] "+h.url+" - queued"),h.timeout=setTimeout(function(){h.callback(!1)},u))))},{retry:3,onError:function(t){h.callback(!1,!0),console.log("[getImage] "+h.url+" - net error"),c(t)}})):h.callback(i),!0)}c(L("   .    {0}. ",numeral(o.state.limit,[L("$n "),L("$n "),L("$n ")])))}else c(L(" .   ."))},stripUrls:function(t){var e,a=this,s=a.getAttaches(),i=r[$.trim(t)]||r["http://"+$.trim(t)];if(i){if(!a.state.privateAttaches&&i._private_attach)return t;for(e=0;e<s.length;++e)if(s[e].nid==i.nid&&s[e].type==i.type)return""}return t},quickSelector:function(n,t,e,l){var a,o=this,c=o.menu.content().empty(),r=$(_.quickSelector({type:n,showSlider:!o.state.onlyUpload,upload:o.state.upload,attachBtnName:o.state.proxyUpload?L(""):L(""),sources:o.state.commId&&!o.state.onlyComm,attaches:"attaches"==o.state.mode,linkDownload:o.state.linkDownload&&(n==Spaces.TYPES.PICTURE||n==Spaces.TYPES.VIDEO)}));r.find(".js-qsel_link_input").keypress(function(t){t.keyCode!=Spaces.KEYS.ENTER&&t.keyCode!=Spaces.KEYS.MAC_ENTER||(t.preventDefault(),r.find(".js-qsel_select_btn").click())}),o.setUploadErr(null),o.state.buttons&&r.find(".qsel-cust_btn").replaceWith($(o.state.buttons).children().clone()),c.addClass("js-attach_dnd").append(r),l||o.view("main",!0),o.current_type=n,o.setSection(m),Spaces.DdMenu.fixSize(),Loader.loaded("attach_selector_deps")||o.setLoadling(!0),a=function(){var i,a,s;l||o.setLoadling(!1),o.slider=null,o.state.onlyUpload||(n==Spaces.TYPES.MUSIC?(o.slider=null,r.find(".js-qsel_carousel").html(_.spinner()),(i={Type:Spaces.TYPES.MUSIC,Lt:Spaces.FILES_LIST.FILES_ALL,O:0,L:4}).user=Spaces.params.name,o.state.commId?(i.Comm=o.state.commId,i.Default="comm"==m&&t,i.Section="comm"==m?0:1):o.state.talkId&&(i.Talk=o.state.talkId),Spaces.api("neoapi/files.getFiles",i,function(t){var e,a,s;if(o.setUploadErr(t.uploadError),0==t.code){if("Section"in t&&(t.Section==i.Section||o.state.onlyComm||o.setSection(p[t.Section])),r.find(".js-qsel_carousel").replaceWith(_.musicList({files:t.widgets})),r.find(".js-qsel_cnt").text(t.count).removeClass("hide"),e=o.getAttaches(!0)[n])for(a=0;a<e.length;++a)o.markMusic(e[a].nid);Spaces.DdMenu.fixSize()}else s=Spaces.apiError(t),t.code==Codes.FILES.ERR_DIR_ACCESS_DENIED&&"comm"==m&&(s=_.disabledUploadError()),r.find(".js-qsel_main").html(_.error({text:s,back:"exit"}))})):((i={Type:n,Psize:Spaces.PREVIEW.SIZE_81_80,Lt:Spaces.FILES_LIST.FILES_ALL,Mode:n==Spaces.TYPES.FILE?Spaces.RENDER_MODE.CAROUSEL:Spaces.RENDER_MODE.PREVIEW}).user=Spaces.params.name,o.state.commId?(i.Default="comm"==m&&t,i.Comm=o.state.commId,i.Section="comm"==m?0:1):o.state.talkId&&(i.Talk=o.state.talkId),a=!1,s=r.find(".js-qsel_carousel").carousel({select:!0,hasMore:!0,firstLoad:!0,gallery:!1,multiple:1<o.state.limit,limit:30,apiMethod:"neoapi/files.getFiles",metric:"attach_selector",apiData:i}).on("apiResult",function(t){o.setUploadErr(t.uploadError),"Section"in t&&(t.Section==i.Section||o.state.onlyComm||o.setSection(p[t.Section]))}).on("loadError",function(t){var e=t.message||L("  .");if("api"==t.type&&t.res.code==Codes.FILES.ERR_DIR_ACCESS_DENIED){if(o.state.onlyComm)return o.menu.content().find(".js-qsel_all").hide(),s.resetItems(),s.insert($("<div>"+Spaces.apiError(t.res)+"</div>")),void s.update();"comm"==m&&(e=_.disabledUploadError())}r.find(".js-qsel_main").html(_.error({text:e,back:"exit"}))}).on("photosLoadChunk",function(){var t,e;if(s){if(s.totalItems()||(s.insert($("<div>"+L("     {0}. ",d[n].title2)+"</div>")),s.update()),r.find(".js-qsel_cnt").text(s.totalItems()).removeClass("hide"),t=o.getAttaches(!0)[n])for(e=0;e<t.length;++e)s.markSelected(t[e].nid);a||(a=!0,Spaces.DdMenu.fixSize())}}).on("firstPhotosLoad",function(){tick(function(){Spaces.DdMenu.fixSize()})}).on("selectFile",function(t,e){var a;if(s&&e.nid)return o.state.limit<2?o.checkParentLimit()?o.onAttachSelect(e)&&o.menu.close():s.toggleSelected(e.nid,!1):(a=!s.isSelected(e.nid),o._showSelectBtn(),a?(o.deleteAttach(e.nid,e.type),o.showQSelError("")):o.getAvail()<0&&(s.toggleSelected(e.nid,!1),o.limitError()),Spaces.DdMenu.fixSize()),!1}),o.slider=s,Spaces.DdMenu.fixSize())),o.state.form.trigger("AttachSelectorOpen",{ui:c}),setTimeout(function(){Spaces.DdMenu.fixSize(),e&&e()},0)},o.setupUploader(n,l?null:a,l?a:null)},setupUploader:function(l,t,o){var c=this,e=function(t){var e,a,s,i,n=new Url(t.url);c.state.dir!==undefined?n.query.dir=c.state.dir:(n.query.Att=1,c.state.privateAttaches&&(n.query.Ss=1)),c.state.commId&&"comm"==m&&(n.query.Comm=c.state.commId),c.state.talkId&&(n.query.Talk=c.state.talkId),e=c.view("main"),a=c.view("upload"),e&&((s=e.find(".js-qsel_upload_btn")).find(".js-upload_btn_ico").removeClass("hide"),s.find(".js-upload_btn_spinner").addClass("hide"),s.removeClass("disabled")),FilesUploader.needStaticUpload()||(i=t.maxFileWeightByDuration,FileUploader.setup({name:"myFile",action:n.url(),multiple:!0,denyUpload:t.FileExtWithRateRestrictionsForUpload,inlineFileWidget:c.state.limit<2,maxFiles:c.state.limit,maxSize:1024*t.maxSize*1024,maxShortVideoSize:i?1024*i.Weight*1024:0,maxShortVideoDuration:i?i.Duration:0,uploadDrag:c.menu.content(),selectButton:!!e&&s,uploadWidget:!!a&&a.find(".js-qsel_upload_widget"),buttonClass:{hover:"strong_clicked",active:"strong_clicked_active"},type:l,mode:FileUploader.MODES.BUTTON}),c.upload_inited=!0),o&&o()};c.upload_inited=!1,require("attach_selector_deps",function(){S._initUploader(),t&&t(),Spaces.api("neoapi/files.getUploadInfo",{Type:l},function(t){0==t.code&&e(t)},{cache:!0,cacheTime:1200,retry:20})})},onAttachUpload:function(t,e){var a,s=this;s.state.attaches&&((a=s.list.find(".js-attaches__upload")).length||s.list.prepend(a=$('<div class="js-attaches__upload">')),a.append(e))},onAttachSelect:function(t,e,a){var s,i,n=this,l=new $.Event("onNewAttach");return n.state.form.trigger(l,{file:t}),!l.isDefaultPrevented()&&(a&&n.state.form.trigger("onNewAttachBb",{file:t}),ge("#"+t.nid+"_"+t.type)?n.state.limit<2:(n.state.limit<2&&(n.deleteAll(),n.new_attaches=[]),n.state.attaches&&(s=n.list.find(".js-attaches__tile"),i=n.list.find(".js-attaches__plain"),s.length||n.list.append(s=$('<div class="js-attaches__tile attaches__wrap_tile">')),i.length||n.list.append(i=$('<div class="js-attaches__plain">')),t.show_preview?s.append(_.attach(t)):i.append(_.attach(t)),s.toggle(0<s.find(".js-attach_item:first").length),i.toggle(0<i.find(".js-attach_item:first").length)),e||n.new_attaches.push(t),n.checkAttList(),!0))},typeAllowed:function(t){return!this.state.allowedTypes||0<=$.inArray(+t,this.state.allowedTypes)},setUploadErr:function(t){var e=this.view("main");this.state.uploadError=t,e&&t&&(e.find(".js-qsel_upload_err").removeClass("hide").html(t),e.find(".js-qsel_upload_btn, .js-qsel_link_upload").addClass("hide"))},showError:function(t){var e=this.view("action",!0);return e?e.html(_.error({text:t})):Spaces.showError(t)},showQSelError:function(t){var e=this,a=e.view("main",!0).find(".js-qsel_error").html(t?_.error({text:t,no_button:!0}):"");return Spaces.DdMenu.fixSize(),a},setLoadling:function(t){var e=this;e.view("action")&&(t?(e.loading_last_view=e.last_view_name,e.view("action",!0).append(_.spinner())):e.view(e.loading_last_view,!0))},sliderSelect:function(){var t,e=this,a=e.getSelected();for(t=0;t<a.length;++t)e.onAttachSelect(Spaces.core.extractFile(a[t]))},saveAttaches:function(a){var e,t,s=this;a.length&&(e=function(t){if(s.state.attaches&&--n,s.checkComplete(),t)s.renderAttach(t.tiles,t.list);else for(var e=0;e<a.length;++e)s.deleteAttach(a[e].nid,a[e].type,!0)},s.state.attaches&&++n,s.form.trigger("onNewAttaches",{attaches:a,callback:function(t){e(t)}}),s.checkComplete(),s.state.ot&&(t={Oid:s.state.oid,Pid:s.state.pid,Ot:s.state.ot,Comm:s.state.commId,CK:null,atT:AttachSelector.getAttaches(s.state.form,!0)},Spaces.api("neoapi/attach.add",t,function(t){0!=t.code?(Spaces.showApiError(t),e(!1)):e(t.new_attaches)},{onError:function(t){Spaces.showError(t),e(!1)}})))},renderAttach:function(t,e){$.each($.extend(e,t),function(t,e){$("#"+t).replaceWith(e)}),$.isEmptyObject(t)||require("gallery",function(){GALLERY.addPhoto()}),this.checkAttList()},checkComplete:function(){AttachSelector.isBusy()||this.form.trigger("onAttachesComplete")},deleteAttach:function(t,e,a){var s,i,n=this,l=$("#"+t+"_"+e);0<l.length&&((s=S.parseFile(l)).noapi=!!a,l.remove(),n.state.form.trigger("onDeleteAttach",{file:s}),n.state.ot&&!a&&(i={Oid:n.state.oid,Pid:n.state.pid,Ot:n.state.ot,Comm:n.state.commId,CK:null,File_id:t,Ft:e},Spaces.api("neoapi/attach.delete",i,function(t){0!=t.code&&Spaces.showApiError(t)})),n.checkAttList(),require("gallery",function(){GALLERY.addPhoto()}))},deleteAll:function(){var t,e=this,a=e.getAttaches();for(t=0;t<a.length;++t)e.deleteAttach(a[t].nid,a[t].type)},markMusic:function(t,e){var a,s=this,i=s.view("main").find('[data-nid="'+t+'"]').find(".ico_photo_selected, .ico_photo_select");return s.state.limit<2&&s.view("main").find(".ico_photo_selected").removeClass("ico_photo_selected").addClass("ico_photo_select"),a=i.hasClass("ico_photo_select"),(e!==undefined?e:a)?(i.removeClass("ico_photo_select"),i.addClass("ico_photo_selected")):(i.removeClass("ico_photo_selected"),i.addClass("ico_photo_select")),!a},getSelected:function(){var t,e=this;return e.slider?e.slider.getSelected():e.view("main")?(t=[],(e=this).view("main").find(".ico_photo_selected").each(function(){t.push($(this).parent())}),t):[]},setParent:function(t){this.parent=t},getAvail:function(){return this.state.limit-this.getTotal()},getTmpCnt:function(){return this.list.find(".js-attaches__upload").children().length},getTotal:function(){var t,e,a,s,i,n,l,o=this;if(o.parent&&!o.parent.getAvail())return o.state.limit;for(t=o.getAttaches(),e=o.getSelected(),a=o.getTmpCnt(),s={},i=t.length+a,n=0;n<t.length;++n)s[t[n].nid+":"+t[n].type]=1;for(n=0;n<e.length;++n)s[(l=Spaces.core.extractFile(e[n])).nid+":"+l.type]||++i;return i},getAttaches:function(a){var t,e,s=this,i=a?{}:[];if(s.state.attaches)return s.list.find(".js-attach_item").each(function(){var t=$(this),e=S.parseFile(t);e.el=t,a?(i[e.type]||(i[e.type]=[]),i[e.type].push(e)):i.push(e)}),i;for(t=0;t<s.default_selected.length;++t)e=s.default_selected[t],a?(i[e.type]||(i[e.type]=[]),i[e.type].push(e)):i.push(e);return i},checkAttList:function(){var t,e,a,s,i=this,n=0<i.list.find(".js-attach_item:first").length||0<i.list.find(".js-attaches__upload").children().length,l=0<i.list.find(".js-tmp_pg_spinner").length;i.list.toggle(n||l),i.form.find(".js-attaches_show").toggleClass("hide",!l&&!n),e=0<(t=i.list.find(".js-attaches__tile")).children().length,s=0<(a=i.list.find(".js-attaches__plain")).children().length,t.toggle(e),a.toggle(s),i.form.trigger("onAdultAttach",{hasAdult:0<i.list.find('[itemprop="requiredMinAge"]').length})},selectDefault:function(t,e){var a=this;a.state&&(a.slider?a.slider.markSelected(t):a.markMusic(t),a.state.limit<2&&(a.default_selected=[]),a.default_selected.push({nid:t,type:e,id:t+"_"+e}))},view:function(t,e){var a,s,i,n,l,o,c=this;if(t===undefined)return c.last_view_name;if(!c.views_cache||$.isEmptyObject(c.views_cache))for(c.views_cache={},a=c.menu.content().find("[data-view]"),s=0;s<a.length;++s)i=$(a[s]),c.views_cache[i.data("view")]=i;if(t===c.last_view_name||!e)return c.views_cache[t];for(l in c.views_cache)o=c.views_cache[l],l===t?(n=o).show():(l===c.last_view_name&&o.data("empty")&&o.empty(),o.hide());return c.last_view_name=t,tick(function(){Spaces.DdMenu.fixSize()}),n},lock:function(t){this.menu.close(),this.state.link.data("locked",t)},_showSelectBtn:function(){var t,e,a,s,i,n=this,l=n.view("main");l&&(t=l.find(".js-qsel_select_btn"),e=l.find(".js-qsel_download_url_btn"),a=l.find(".js-qsel_link_input"),s=0<$.trim(a.val()).length,i=Spaces.checkUrl(a.val()),t.toggleClass("disabled",1<n.state.limit&&!n.getSelected().length),s&&i?e.removeAttr("disabled"):e.attr("disabled","disabled"),a.toggleClass("text-input_error text-input_error_bg",s&&!i),Spaces.DdMenu.fixSize())},loadUrl:function(){return this.loadImages(Spaces.extractUrls(this.view("main").find(".js-qsel_link_input").val()),!0)},limitError:function(t){t=t||this.state.limit,this.showQSelError(L("   .    {0}. ",numeral(t,[L("$n "),L("$n "),L("$n ")])))},checkParentLimit:function(){return!this.parent||(!!this.parent.getAvail()||(this.limitError(this.parent.state.limit),!1))},close:function(){this.menu.close()},free:function(){var t=this;t.menu&&t.menu.content().empty(),t.slider&&(t.slider=null),t.new_attaches=[],t.default_selected=[],t.views_cache=t.last_view_name=null,f=!1},destroy:function(){this.free(),this.menu=null},ok:function(){return!!this.menu},_initDragDrop:function(){var s,e,i,a,n,l,o,c=this,r=!1,d=$('<div style="display: inline-block">&nbsp;</div>'),p=$("<div>").css({position:"absolute",cursor:"pointer",background:"rgba(255, 255, 255, 0)",top:0,bottom:0,left:0,right:0,zIndex:999999999}),u=function(){o=c.state.form.find("textarea").findByPos(a),n[0].style.opacity=o?1:.5};c.list.draggable({realtime:!0,fastEvents:!0,disableContextMenu:!1,forceStart:!0,scroll:!0,events:{dragStart:function(t){(n=c.list.find(".js-attach_item").findByPos({x:t.x,y:t.y}))&&(s=n.prop("style").cssText,r=!1,i=setInterval(u,250),l={x:t.x-n.offset().left,y:t.y-n.offset().top,w:n.width(),h:n.height()})},dragMove:function(t){n&&(r||(e=n.position(),d.outerWidth(n.outerWidth()).outerHeight(n.outerHeight()),n.after(d),c.list.after(p),n.css({position:"absolute",left:0,top:0,right:0,bottom:0,userSelect:"none",width:n.width(),height:n.height(),zIndex:999999999,cursor:"pointer",opacity:.5}),r=!0),$.support.nativeAnim?n.transform({translate:[e.left+t.dX,e.top+t.dY]}):(n[0].style.left=e.left+t.dX+"px",n[0].style.top=e.top+t.dY+"px"),a={x:t.x-l.x,y:t.y-l.y,w:l.w,h:l.h})},dragEnd:function(t){var e,a;n&&(i&&clearInterval(i),i=null,r&&(d.detach(),p.detach(),$.support.nativeAnim&&n.transform(),n.prop("style").cssText=s,t.trueTouch||((e=n).one("click._prevent_click",function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()}),tick(function(){e.off("._prevent_click")})),o&&(a=S.parseFile(n),o.trigger("onDropAttach",a)),o=n=null))}}})}}),window.AttachSelector={resetAttaches:function(t){$(t).find(".js-attaches").empty().hide()},getAttaches:function(t,a){var s=[];return(t=$(t)).find(".js-attach_item").each(function(){var t=$(this),e=S.parseFile(t);a?s.push(e.nid+"_"+e.type):(e.el=t,s.push(e))}),s},select:function(t,e){var a=S.active();a&&a.selectDefault(t,e)},resetSelected:function(t,e){self.default_selected=[]},instance:function(t,e){return S.instance(t)},isBusy:function(){return l||h||0<n},isOpened:function(){return!!S.active()},onDone:function(t){this.isBusy()?$("#main").one("onAttachesComplete",function(){t()}):t()},close:function(){var t=S.active();t&&t.close()}},define("attach_selector","onRequire",function(){S.delayedInit()}),define("attach_selector","onRequest",function(){$(function(){S.init(),page_loader.onShutdown("attach_selector",function(){S.destroy()})})}))});define("form_tools","init",function(){var m,p,c,e,d=2e3,l=6,h=3,w="operamobile"==Device.browser&&Device.v<=12;"operamini"!=Device.browser&&"mobile"!=Device.type&&(m=!1,c=0,e={init:function(){var c,u,e,a,n,o,f,s;m=!1,c=this,e=$("body"),$(window),e.on("click","select",function(e){var t=$(this);Spaces.view.setInputError(t,!1)}).on("focus","textarea, input:text, input:password",function(e){var t=$(this);m=!0,w&&t.hasClass("js-resize_ta")&&t.attr("rows",t.data("maxRows")||l),t.data("saveError")||Spaces.view.setInputError(t,!1),c.saveTextareaText(t),p=Date.now()}).on("blur","textarea, input:text",function(e){var t=$(this);m=!1,w&&t.attr("rows",t.data("minRows")||h),c.saveTextareaText(t),u&&clearTimeout(u)}).on("click",".js-temp_text",function(e){e.preventDefault();var t=$(this),a=t.parents().find("textarea:first"),n="saved_text:"+(a.data("text_id")+":"+SPACES_PARAMS.nid)+":tmp";"delete"!=t.data("action")&&a.val(Spaces.LocalStorage.get(n)),Spaces.LocalStorage.remove(n),c.saveTextareaText(a),t.parents(".js-temp_text_parent").remove()}).on("submit","form",function(e){var t,a=$(this),n=Spaces.view.getFormSubmitter(a),o=c.checkForm(a);return!1!==o&&n&&"cfms"==n.attr("name")&&(t=a.find("textarea"),page_loader.one("shutdown",function(){setTimeout(function(){t.each(function(){c.saveTextareaText($(this),!0)})},1e3)})),o}),a=function(e,t){e.parent().find("input:password, input:text").prop("type",t?"text":"password"),e.data("showPasword",t).prop("title",t?L(" "):L(" ")).toggleClass("disabled",!t)},"desktop"==Device.type?e.on("mousedown",".js-input_show_password",function(e){var t=$(this);a(t,!0),$("body").on("mouseup.oneRequest",function(){a(t,!1)})}):e.on("click",".js-input_show_password",function(e){e.preventDefault();var t=$(this);a(t,!t.data("showPasword"))}),define("form_tools","onRequest",function(){m=!1}),w||(define("form_tools","onRequest",function(){e.find("form.js-no_enter_submit").on("keypress","input:text",function(e){e.keyCode!=Spaces.KEYS.ENTER&&e.keyCode!=Spaces.KEYS.MAC_ENTER||e.preventDefault()})}),o=function(e){var t=$(e),a=!1;t.data("twice")?((t=t.parents(".js-input_error_wrap:first").find("input:password"))[0].value.length&&t[1].value.length&&t[0].value!=t[1].value&&(a=L("  .")),v=t[0].value):v=t.val(),v.match(/[ -]/i)?a=L("       ."):v.length>t.data("maxlength")&&(a=L("  .    - {0}.",numeral(t.data("maxlength"),[L("$n "),L("$n "),L("$n ")]))),Spaces.view.setInputError(t.data("saveError",!!a),a),n=!1},e.on("input keypress paste change blur","input:password",function(e){var t=this;n||(n=setTimeout(function(){o(t)},50))}),e.on("input keypress paste change","textarea, input:text",function(e){var t,a,n,o,s,r=this,i=$(r);i.hasClass("js-resize_ta")&&(r.style,t=parseInt(i.css("line-height")),a=parseInt(i.css("paddingTop"))+parseInt(i.css("paddingBottom")),t||(t=i.data("line_height"))||(t=i.fontMetrics().h,i.data("line_height",t)),n=i.data("maxRows")||l,o=i.data("minRows")||h,r.rows,r.rows=o,s=Math.ceil(r.scrollHeight-a)/t,r.rows=Math.max(Math.min(s,n),o),i.parent().toggleClass("js-ta_scrolled",n<s)),(Date.now()-p>d||!m)&&(c.saveTextareaText(i,!1,!0),m&&(u&&clearTimeout(u),u=setTimeout(function(){u=!1,c.saveTextareaText(i)},d+100)),p=Date.now())})),"desktop"==Device.type&&(s=function(e,t){var a,n,o,s,r,i,c,u,p,d=e.which||e.keyCode||e.charCode,l=m||"INPUT"==e.target.tagName||"TEXTAREA"==e.target.tagName,v=document.activeElement;!v||"INPUT"!=v.tagName&&"TEXTAREA"!=v.tagName||(l=!0),l||!(40<d)||e.ctrlKey||e.metaKey||165<d&&d<184||112<=d&&d<=123||(a=$(".js-autofocus")).length&&(n=$(window).scrollTop(),o=$(window).innerWidth(),s=a.offset().top,r=a.outerHeight(),(n<=s&&s<=n+o||n<=s+r&&s+r<=n+o)&&(a.focus(),Spaces.DdMenu&&(i=Spaces.DdMenu.current())&&!$.contains(i,a)&&Spaces.DdMenu.close(i.attr("id")),!0===t&&(c=a[0],u=String.fromCharCode(d),c.selectionStart!==undefined?(p=c.selectionStart,c.value=c.value.substr(0,p)+u+c.value.substr(p+(c.selectionEnd-p)),set_caret_pos(c,p+1,p+1)):c.value+=u))),f=d},$(document).on("opera"==Device.browser&&Device.v<=12?"keypress":"keydown",s),"firefox"==Device.browser&&$(document).on("keypress",function(e){var t=e.which||e.keyCode||e.charCode;!f&&t&&s(e,!0)}))},saveTextareaText:function(e,t,a){var n,o,s,r=e.data("text_id");if((t||!(Date.now()-c<500))&&(t||!e.data("disabled")&&!e.data("readonly"))&&(e.trigger("text_save",{typing:!!a}),r&&!w)){r+=":"+SPACES_PARAMS.nid;try{n=JSON.parse(Spaces.LocalStorage.get("saved_texts"))}catch(i){n={}}if(!(r in n||t))for(o=[],$.each(n,function(e,t){o.push([e,t])}),o.sort(function(e,t){return t[1]-e[1]}),s=4;s<o.length;++s)Spaces.LocalStorage.remove("saved_text:"+o[s][0]),Spaces.LocalStorage.remove("saved_text:"+o[s][0]+":tmp"),delete n[o[s][0]];!t&&e[0].value.length?(n[r]=Date.now(),Spaces.LocalStorage.set("saved_text:"+r,e[0].value)):(Spaces.LocalStorage.remove("saved_text:"+r),Spaces.LocalStorage.remove("saved_text:"+r+":tmp"),delete n[r]),Spaces.LocalStorage.set("saved_texts",JSON.stringify(n))}},checkForm:function(e){var o=0,t=$(e.prop("submit_btn")||[]);if("cfms"==t.prop("name")||t.data("main_submit"))return e.find(".text-input").each(function(){var e,t=$(this),a=t.attr("maxlength")||t.data("maxlength"),n=t.attr("required")||t.data("required");t.data("validate")&&(a?a<(e=html_wrap(t[0].value).length)&&(Spaces.view.setInputError(t,L("     {0} ( {1})",numeral(a,[L("$n "),L("$n "),L("$n ")]),numeral(e,[L("$n "),L("$n "),L("$n ")]))),++o):n&&!$.trim(t[0].value).length?(Spaces.view.setInputError(t,L("   .")),++o):Spaces.view.setInputError(t,!1))}),!o}},$(function(){e.init()}))});define("form","init",function(){$(function(){var g,u=$("body");u.on("focus blur",".js-input_with_suffix",function(e){$(this).parent().find(".js-input_suffix").toggleClass("hide","focus"==e.type||"focusin"==e.type)}).on("focus blur",".text-input-wrapper_inline",function(e){e.target&&("INPUT"==e.target.nodeName&&"submit"==e.target.type||"BUTTON"==e.target.nodeName)||$(this).toggleClass("focus","focus"==e.type||"focusin"==e.type)}).on("click",".js-checkbox",function(e){var t,a,o,n;$(e.target).parents("a").length||(e.preventDefault(),e.stopPropagation(),a=(t=$(this)).find("input[type=checkbox]").get(0),$(a).attr("disabled")||(o=$.Event("change"),$(a).trigger(o),o.isDefaultPrevented()||(a.checked=!t.hasClass("form-checkbox_checked"),t.toggleClass("form-checkbox_checked"),t.data("chb_group")&&(n=a.checked,$("#"+t.data("chb_group")).find(".js-checkbox").each(function(){var e=$(this);e.find("input[type=checkbox]").get(0);e.toggleClass("form-checkbox_checked",n)})),$(a).trigger($.Event("changed")))))}),"operamini"!=Device.browser&&u.on("change",".js-select",function(){var e=$(this),t=e.find("option:selected"),a=t.text(),o=e.parent();t.hasClass("select_default")?(o.addClass("select_custom_noactive"),a=e.data("default")):o.removeClass("select_custom_noactive"),e.parent().find(".select__label").html(a),Spaces.view.setInputError(e,!1)}),u.on("click",".js-radio",function(e){var t,a,o,n,s,i,c,r,l,d,f;"operamini"!=Device.browser&&e.preventDefault(),e.stopPropagation(),o=(a=(t=$(this)).find("input[type=radio]")).attr("name"),n=t.data("label_id"),s=t.data("noclose"),i=t.data("change_ico"),c=t.data("checked_class")||"form-checkbox_checked",a.get(0).checked=!0,a.trigger("change"),$(".js-radio-"+o).each(function(){var e=$(this);e.removeClass(e.data("checked_class")||"form-checkbox_checked")}),t.addClass(c),i&&(r=t.find("span.ico").data("current_ico"),$("#"+i).get(0).className="ico "+r),n&&1!=s&&(d=(l=$("#label_"+o)).find(".js-ico"),(f=l.find(".js-text")).length||d.length?(f.html(t.find(".js-text").html()),d.prop("className",t.find(".js-ico").prop("className")),console.log("label_ico",d)):$("#"+n+" .drop-down-label_text").text(t.text()),u.trigger("click"))}),u.on("click",".js-toggle",function(e){e.preventDefault(),e.stopPropagation();var t=$(this),a=t.data("mess_id"),o=t.parents(".label-toggle");o.data("disabled")||(t.hasClass("form-toggle__wrap_off")?(t.find("label.form-toggle-1 input").get(0).checked=!0,o.addClass("label-toggle_on"),a&&$("#"+a).hide()):(t.find("label.form-toggle-0 input").get(0).checked=!0,o.removeClass("label-toggle_on"),a&&$("#"+a).show()),t.toggleClass("form-toggle__wrap_off"))}),u.on("click",".js-horiz_mode",function(e){e.preventDefault(),e.stopPropagation();var t=$(this),a=t.find("input[type=radio]"),o=a.attr("name");a.trigger("change"),a.get(0).checked=!0,t.parents(".js-input_error_wrap").removeClass("error__item").find(".js-input_error").addClass("hide"),$(".js-horiz_mode-"+o).removeClass("clicked"),t.addClass("clicked")}),g={dating:{method:"neoapi/anketa.datingEdit",data:{CK:null},param:"Dating",onResult:function(e,t){e.premod&&e.code==Codes.COMMON.ERR_UNKNOWN_ERROR&&(e.code=0)}},ghost:{method:"neoapi/services.switchGhost",data:{CK:null},param:"On",updateState:function(e){var t=$(".js-switcher_ghost");t.toggleClass("on",!e).html(e?t.data("value_off"):t.data("value_on")),Spaces.DdMenu.close()},onResult:function(e,t){e.code==Codes.SERVICES.ERR_GHOST_UNCHANGED&&(e.code=0)}}},u.on("click",".js-switcher",function(e){var o,t,a,n,s,i,c,r,l,d,f,u,h,p;e.preventDefault(),e.stopPropagation(),o=$(this),t=o.find(".form-toggle__wrap"),a=o.data(),n=$("#"+a.spinner),s="state"in a?!a.state:!o.hasClass("light"==a.mode?"on":"label-toggle_on"),i=!s,a.disabled||a.busy||(c={},$.each(a,function(e,t){0==e.indexOf("msg_")&&(c[e.replace(/^msg_/,"")]=$("#"+t))}),l=function(e){"light"!=a.mode&&r(!!e&&"failed",e)},d={showMessage:r=function(e,t){$.each(c,function(){this.hide()}),c[e]||(e=s?"enabled":"disabled");var a=c[e];a&&(t&&a.html(t),a.show()),o.toggleClass("js-has_mess",!(!a||!a.length))},showError:l},a.type?f=g[a.type]:a.apiMethod&&(f={method:a.apiMethod,data:a.apiData,param:a.param}),u=function(e){s=e,a.state=e,a["class"]?(o.find(".js-switcher_on").toggleClass("hide",!s),o.find(".js-switcher_off").toggleClass("hide",s)):"light"==a.mode?(o.html(s?a.value_on:a.value_off),o.toggleClass("on",!!s)):(o.toggleClass("label-toggle_on",s),t.toggleClass("form-toggle__wrap_off",!s),l(!1)),f&&f.updateState&&f.updateState.call(d,e)},f?((h=$.extend({},f.data))[f.param]=f.invert?!s:!!s,p=function(e){a.busy=e,n.toggleClass("hide",!e)},u(s),p(!0),Spaces.api(f.method,h,function(e){p(!1),f.onResult&&f.onResult.call(d,e,!!s),0!=e.code?(u(i),c.failed?l(Spaces.apiError(e)):Spaces.showApiError(e)):f.callback&&f.callback()},{onError:function(e){p(!1),l(e),n.addClass("hide")}})):u(s))}).on("click",".js-addremove",function(e){var t=$(this),a=t.find("input:first")[0],o=!t.hasClass("form-checkbox_checked"),n=new $.Event("addremove");t.trigger(n,{state:o,name:a.name,value:a.value}),n.isDefaultPrevented()&&(e.preventDefault(),e.stopPropagation(),t.toggleClass("form-checkbox_checked",o),t.data("checked",o))}),u.on("change",".js-years_selector",function(e){var t,a,o=$(this),n=4,s=1,i=3,c=2,r="",l="";o.hasClass("js-year_from")?(r=o.val(),l=o.parent().find(".js-year_to").val()):(r=o.parent().find(".js-year_from").val(),l=o.val()),r&&l&&0<l&&0<r&&l<r&&(a="",(t=o.data("type"))==n?a=L("        "):t==s?a=L("        "):t==i?a=L("        "):t==c&&(a=L("        ")),Spaces.showError(a))}),u.on("click",".js-submit-btn",function(e){var t=$(this);t.find(".ico").get(0).className="ico f__ico_spinner2";t.addClass("clicked")}).on("click",".js-reset_value",function(e){e.preventDefault(),e.stopPropagation(),$(this).visible(!1);var t=$(this).parents(".js-parent");window.Spaces.resetForm(t)}),"operamini"!=Device.browser&&u.on("focus",".js-text-input",function(e){$(this).parent().addClass("input_focused")}).on("blur",".js-text-input",function(e){$(this).parent().removeClass("input_focused")})}),define("form","onRequest",function(){var c,a,o=!1;$(".ac-settings_inline_bottom_fix").each(function(){var e=$(this);e.removeClass("ac-settings_inline_bottom_fix"),e.find(".text-input__wrap").append(e.find(".drop-down-list_inner"))}),c=function(e){var t,a,o=e.find(".js-radio"),n={};for(t=0;t<o.length;++t)n[a=o[t].getAttribute("data-label_id")]||(n[a]=[]),n[a].push(o[t]);return n},window.Spaces.resetForm=function(e){var t,a;for(a in e.find('select, input[type="text"]').val("").trigger("resetValues"),e.find(".js-objsel").each(function(){$(this).objectSelector().reset()}),e.find(".js-geosel").each(function(){$(this).geoSelector().reset()}),t=c(e))$(t[a][0]).click()},a=function(e,t){var a,o,n,s,i=c(e);for(a in i)if(!$(i[a][0]).hasClass("form-checkbox_checked"))return!0;if(!t&&(o=!1,e.find(".js-geosel").each(function(){var e=$(this).geoSelector();if(o=!e.isEmpty())return!1}),o))return!0;for(n=e.find('input[type="text"]'),s=0;s<n.length;++s)if(n[s].className.indexOf("js-geosel_input")<0&&""!==n[s].value)return!0;return!1},$(function(){"operamini"!=Device.browser&&$("#main").on("mousedown touchstart",function(){o=!0}).on("mouseup touchcancel touchend",function(){o=!1}).on("focus",".text-input",function(e){$(this).parents(".form__item").find(".js-acl").hide()}).on("blur",".text-input",function(e){var t=$(this),a=function(){t.parents(".form__item").find(".js-acl").show()};o?$("body").one("mouseup touchcancel touchend",a):setTimeout(a,"touch"==Device.type?250:0)}).on("focus blur change",".js-parent select, .js-parent input, .js-parent textarea",function(e){var t=$(this).parents(".js-parent");setTimeout(function(){var e=t.find(".js-reset_value");e.toggle(a(t,e.data("ignore_city")))},0)}).on("valuechanged",".js-parent",function(e){var t=$(this);setTimeout(function(){var e=t.find(".js-reset_value");e.toggle(a(t,e.data("ignore_city")))},0)})})})});define("search_form","init",function(){var e=".js-search__input",c=".js-search__btn_clear",s=".js-search__submit",n={init:function(){var i=this;Device.android()&&Device.android()<2.3||$("#main").on("focus",e,function(n){var t=$(this);t.data("noToggleSubmit")||i.changeButtons(t,!0)}).on("blur change",e,function(n){var t=$(this);t.data("noToggleSubmit")||setTimeout(function(){t.is(":focus")||i.changeButtons(t,!1)},200)}).on("click",c,function(n){var t=$(this);!t.data("noToggleSubmit")&&i.clear(t)&&(n.preventDefault(),n.stopPropagation(),t.trigger("clearSearchForm"))})},changeButtons:function(n,t){var i=this,e=i.findParent(n),a=e.find(c),o=e.find(s),r=!$.trim(n.val()).length||t;a.toggleClass("hide",r),o.toggleClass("hide",!r)},clear:function(n){var t=this.findParent(n).find(e);if(!t.is(":focus"))return t.val("").trigger("input"),this.changeButtons(t,!1),!0},findParent:function(n){for(;n&&n.length;){if(n.find(e).length&&n.find(s).length)return n;n=n.parent()}}};define("search_form","onRequest",function(){n.init()})});define("search_suggests","init",function(){var o,r=300,c={users:{method:"/selector/?onlyFriends=1&ajaxUsers={query}",paramType:"GET",length:2,render:"usersApiResult",noApi:!0},search:{method:"neoapi/search.getSuggestions",param:"q",results:"result",length:1},mail_contacts:{method:"neoapi/users.search",param:"q",results:"users",length:3,data:{M:1},render:"usersApiResult"},blog_channels:{method:"neoapi/blogs.findChannel",param:"name",results:"channels",length:1,data:{CK:null},render:"blogChannels"},interests:{method:"neoapi/anketa.dictSuggestions",param:"q",results:"suggestions",length:1,bindParams:{T:"dict_type"},render:"usersTagObject",opts:{tags:!0,no_submit:!0,no_select:!0}},groups:{method:"neoapi/user_groups.selector_autocomplete",param:"sq",results:"found",length:1,bindParams:{pp:"pp"},onSelect:function(e,t){return{contact:t.found[e],removable:t.removables[e],param:t.params[e]}}}},p={suggest:function(e,t){return'<div class="suggest__item'+(t?" hide":"")+'" data-value="'+e+'">'+e+"</div>"},usersApiResult:function(e){return p.suggest(e.name)},usersTagObject:function(e){return'<div class="suggest__item" data-value="'+e.value+'">'+e.value+' <span class="right grey">'+e.popularity+"</span></div>"},blogChannels:function(e){return'<div class="suggest__item" data-value="'+e.name+'">'+e.name+"</div>"}},e={init:function(){var g=this;$("#main").on("focus",".search_suggest",function(e){var t,s,a=$(this),n=a.parents(".suggest_parent"),i=$.extend(n.data(),a.data()),u=i.type||"search",l=c[u];if(l.opts&&(i=$.extend(l.opts,i)),g.free(),(o={id:Date.now(),input:a,type:u,list:i.list?$(i.list):n.find(".suggest__list"),autoSelect:!i.no_select,autoSubmit:!i.no_submit,tags:i.tags,apiData:{},cfg:l}).timer=setInterval(function(){g.getSuggests()},r),t=l.bindParams)for(s in t)t[s]in i&&(o.apiData[s]=i[t[s]]);o.last_value=g.getQuery(a.val())}).on("blur",".search_suggest",function(e){if(o){var t=o.id;setTimeout(function(){o&&o.id==t&&g.free()},300)}}).on("mouseenter",".suggest__item",function(){g.highlightItem($(this),!1)}).on("mouseleave",".suggest__item",function(){g.highlightItem(!1,!1)}).on("click",".suggest__item",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();var t=$(this);g.selectItem(t,!0),g.hideSuggests()}).on("keydown",".search_suggest",function(e){if(o){var t=e.keyCode,s=t==Spaces.KEYS.ENTER||t==Spaces.KEYS.MAC_ENTER;t==Spaces.KEYS.RIGHT?o.autoSelect||g.selectActive():t==Spaces.KEYS.UP||t==Spaces.KEYS.DOWN?(e.preventDefault(),g.noSuggests()&&(o.last_value="",g.getSuggests()),g.moveSelectedItem(t==Spaces.KEYS.UP?-1:1)):(s||t==Spaces.KEYS.ESC)&&(s&&(e.preventDefault(),e.stopPropagation(),o.autoSelect?g.submitForm():g.selectActive()),g.hideSuggests())}}),page_loader.push("shutdown",function(){g.free()})},noSuggests:function(){return!o.list.hasClass("suggest__list_on")&&!o.last_req_id},highlightItem:function(e,t){o.list.find(".suggest__item_active").removeClass("suggest__item_active"),e&&(e.addClass("suggest__item_active"),t&&this.selectItem(e,!1,!0))},selectActive:function(e,t,s){o.list.find(".suggest__item_active").click()},selectItem:function(e,t,s){var a,n,i,u=this;o.input.data("suggest_index",e.index()),s&&!o.autoSelect||(a=$.trim(e.data("value")),o.tags?((i=(n=$.trim(o.input.val())).split(",")).pop(),i.push(a),n=i.map(function(e){return $.trim(e)}).join(", "),o.input.val(n)):o.input.val(e.text()),o.last_value=u.getQuery(o.input.val())),t&&u.submitForm()},getQuery:function(e){var t;return o.tags&&(e=(t=e.split(","))[t.length-1]),$.trim(e)},hideSuggests:function(){o.list.empty().removeClass("suggest__list_on"),Spaces.fixHeight(),this._restoreTriangles(),this.cancelRequest()},_restoreTriangles:function(){o.triangles&&($.each(o.triangles,function(){this.removeClass("triangle-hide")}),delete o.triangles)},submitForm:function(){var e,t,s,a;o.autoSubmit&&(t=(e=o.input.parents("form")).find('input[name="cfms"]'),"touch"==Device.type?t.length?t.delay(500).click():e.delay(500).submit():t.length?t.click():e.submit()),a=(s=o.input.data("suggest_index"))!==undefined?o.cfg.onSelect&&o.cfg.onSelect(s,o.last_api_result)||o.last_result[s]:undefined,o.input.trigger("suggestSelect",a),o.input.trigger("suggestSelect:"+o.type,a)},moveSelectedItem:function(e){var t,s,a=this,n=o.list,i=n.find(".suggest__item"),u=n.find(".suggest__item_active");u.length?(s=u.index(),s=0<e?s+1<i.length?s+1:0:0<=s-1?s-1:i.length-1,t=$(i[s])):t=0<e?o.tags?i.first():i.first().next():i.last(),t[0]!=u[0]&&a.highlightItem($(t),!0)},getSuggests:function(){var e,t,r=this,s=r.getQuery(o.input.val());o.last_value!==s&&((o.last_value=s).length>=o.cfg.length?(e={},t=o.cfg.method,o.cfg.param?e[o.cfg.param]=s:t=t.replace(/\{query\}/g,encodeURIComponent(s)),r.cancelRequest(),e=$.extend(e,o.cfg.data,o.apiData),o.last_req_id=Spaces.api(t,e,function(e){var t,s,a,n,i,u,l,g;if(o&&(o.cfg.noApi||0==e.code)){for(t=e,s=o.cfg.render?p[o.cfg.render]:null,o.cfg.results&&(t=e[o.cfg.results]),a=o.tags?"":p.suggest(html_wrap(o.input.val()),!0),n=0;n<t.length;++n)a+=s?s(t[n]):p.suggest(t[n]);if(0<t.length?(o.list.html(a).addClass("suggest__list_on"),Spaces.fixHeight(o.list)):r.hideSuggests(),(i=o.list.parents(".dropdown-menu__wrap")).length)for(r._restoreTriangles(),u=Spaces.DdMenu.findOpeners(i.attr("id")),n=0;n<u.length;++n)(l=$(u[n])).hasClass("triangle-show_top")&&(g=o.list.offset().top+o.list.outerHeight(),l.offset().top<=g&&(l.hasClass("triangle-hide")||(o.triangles||(o.triangles=[]),o.triangles.push(l),l.addClass("triangle-hide"))));o.last_api_result=e,o.last_result=t}})):r.hideSuggests())},cancelRequest:function(){o&&o.last_req_id&&(Spaces.cancelApi(o.last_req_id),o.last_req_id=null)},free:function(){o&&(clearInterval(o.timer),this.cancelRequest(),o.input.removeData("suggest_index"),o.list.removeClass("suggest__list_on").empty(),o=null)}};define("search_suggests","onRequest",function(){e.init()})});define("toggle_content","init",function(){$("body").on("click",".js-toggle_title",function(t){t.preventDefault(),t.stopPropagation();var n=$(this).parent().parent().toggleClass("js-toggle_content_hide");n.find(".js-is_hidden").val(n.hasClass("js-toggle_content_hide")?1:0)}).on("click",".toggle-list__btn",function(t){$(this).parents(".toggle-list__wrap").toggleClass("toggle-list__wrap_show")}).on("click",".disclosure-link",function(t){t.preventDefault(),t.stopPropagation(),$(this).parents(".disclosure-content").toggleClass("open")})});define("load_full","init",function(){var s=function(){return'<span class=""js-spinner><span class="ico ico_spinner"></span> </span>'};define("load_full","onRequest",function(){$("#main").action("topic_expand",function(e){var n,i,a,s,r;e.preventDefault(),i=(n=$(this)).data(),a=$("#subject_"+i.id),s=a.find(".js-load_full_spinner"),r=function(){s.addClass("hide"),Spaces.redirect(n.prop("href"))},s.removeClass("hide"),Spaces.api("neoapi/diary.getFullSubject",{Id:i.id,CK:null,Link_id:i.link_id,page:i.page,Visit:i.visit},function(e){0==e.code?(a.fastHtml(e.full_subject),require("gallery",function(){GALLERY.addPhoto()})):(console.error(Spaces.apiError(e)),r())},{onError:r})}).action("sections_get",function(e){var n,i,a;e.preventDefault(),n=$(this),(i=n.data()).busy||(n.find(".js-spinner").remove(),n.prepend(s()),a=function(){n.find(".js-spinner").remove(),Spaces.redirect(n.prop("href")),i.busy=!1},i.busy=!0,Spaces.api("anketa.getSections",{User:i.user_id,CK:null,Link_id:Spaces.params.link_id},function(e){i.busy=!1,0==e.code?(n.parents(".js-anketa_expand_wrap").remove(),$("#anketa_extended").fastHtml(e.sections.join(""))):(console.error(Spaces.apiError(e)),a())},{onError:a}))})})});define("view_tracker","init",function(){function e(){clearTimeout(r),clearTimeout(t),a=0,i=!1,t=r=c=null,window.removeEventListener?window.removeEventListener("scroll",n,!1):d.off(".view_tracker")}function n(){if(c.length){var e=window.pageYOffset||(document.documentElement||document.body||{}).scrollTop,n=Math.max(window.innerHeight,(document.documentElement||{}).clientHeight||0);a=Math.max(a,e+n),r||(r=setTimeout(o,1500))}}function o(){var e,n,o,t=[],i=$(document).height();for(r=!1,e=[],n=0;n<c.length;++n)(o=c[n]).scroll<=a/i?(o.tracked=!0,e.push(o.id)):t.push(o);e.length&&Spaces.api("neoapi/diary.addTopicView",{CK:null,Visit:o.lenta?1:0,IdS:e},function(e){0!=e.code&&console.error("addTopicView: "+Spaces.apiError(e))},{onError:function(e){console.error("addTopicView: "+e)}}),c=t}var t,r,c,a=0,i=!1,d=$(window);define("view_tracker","onRequire",function(){t||(t=tick(function(){t=!1,c=[],$(".js-view_tracker").each(function(){var e=$(this),n=e.data();n.tracked||(n.scroll=(e.offset().top+e.height()+10)/$(document).height(),c.push(n))}),i||(window.addEventListener?window.addEventListener("scroll",n,!1):d.on("scroll.view_tracker",n),page_loader.on("shutdown","view_tracker",e),n(),i=!0)}))})});define("geo_selector","init",function(){var o,e,_=1,r=2,d=3,u=4,p=1,y=2,c=5,g=function(e){return'<div class="js-geosel_item s-city__item s-chb '+(e.hidden?" hide ":"")+(e.selected?" clicked s-city__item_light ":" s-city__item_city ")+'" data-type="city" data-name="'+e.name+'" data-country_name="'+e.country_name+'" data-country_id="'+e.country_id+'" data-id="'+e.id+'" >'+(e.short_name?'<img src="'+ICONS_BASEURL+"/flags/"+e.short_name+'p.png" alt="" class="s-city__country-flag" />':"")+'<div class="s-city__item-content"><div class="s-city__item-title">'+(e.selected&&e.country_name?e.name+", "+e.country_name:e.name)+'</div></div><div class="s-city__item-region">'+(e.region_name||"")+(e.area_name&&e.region_name?", ":"")+(e.area_name||"")+"</div></div>"},m=function(e){return'<div class="js-geosel_item s-city__item s-chb '+(e.hidden?" hide ":"")+(e.selected?" clicked s-city__item_light ":" s-city__item_city ")+'" data-type="region" data-name="'+e.name+'" data-country_name="'+e.country_name+'" data-country_id="'+e.country_id+'" data-id="'+e.id+'" >'+(e.short_name?'<img src="'+ICONS_BASEURL+"/flags/"+e.short_name+'p.png" alt="" class="s-city__country-flag" />':"")+'<div class="s-city__item-title">'+(e.selected&&e.country_name?e.name+", "+e.country_name:e.name)+"</div></div>"},h=function(e){return'<div class="js-geosel_item s-city__item s-chb '+(e.hidden?" hide ":"")+(e.selected?" clicked s-city__item_light ":" s-city__item_city ")+'" data-type="country" data-name="'+e.name+'" data-short_name="'+e.short_name+'" data-id="'+e.id+'" >'+(e.short_name?'<img src="'+ICONS_BASEURL+"/flags/"+e.short_name+'p.png" alt="" class="s-city__country-flag" />':"")+'<div class="s-city__item-title">'+e.name+"</div></div>"},l=function(e){return'<div class="s-city__stnd s-city__item_light oh"><table class="table__wrap table__wrap-layout"><tr><td class="table__cell table__cell_large-ico"><span class="ico ico_compass ico_large left"></span></td><td><div class="oh">'+e+"</div></td></tr></table></div>"},f=function(e){var t=e.page<e.total?"js-geosel_pagenav_link":"s-city__pagination-btn_disabled",i=1<e.page?"js-geosel_pagenav_link":"s-city__pagination-btn_disabled",n='<div class="s-city__pagination js-geosel_pagenav"><table class="table__wrap"><tr><td class="table__cell s-city__pagination-btn s-city__pagination-btn_prev '+i+' relative" data-p="'+(e.page-1)+'"><span class="js-ico ico ico_arr3"></span> <span class="s-city__pagination-btn_label">'+L("")+'</span></td><td class="table__cell s-city__pagination-btn js-geosel_pagenav_cnt">'+L("{0}  {1}",e.page,e.total)+'</td><td class="table__cell table__cell_last s-city__pagination-btn s-city__pagination-btn_next '+t+' relative" data-p="'+(e.page+1)+'"><span class="s-city__pagination-btn_label">'+L("")+'</span> <span class="js-ico ico ico_arr"></td></tr></table></div>';return n},t=function(){return'<span class="ico ico_spinner"></span>'},i=Class({Constructor:function(e){var i,n=this;n.wrap=e,n.opts=e.data(),n.input=e.find(".js-geosel_input"),n.inputWrap=e.find(".js-usearch_parent"),n.result=e.find(".js-geosel_result"),n.offers=e.find(".js-geosel_offers"),n.current=e.find(".js-geosel_current"),n.empty=e.find('.js-geosel_item[data-id="0"]'),n.label=e.find(".js-geosel_label"),n.country_id=e.find(".js-geosel_country_id"),n.city_id=e.find(".js-geosel_city_id"),n.region_id=e.find(".js-geosel_region_id"),n.wrap.on("click",".js-geosel_item",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).data();n.select(t,!0)}).on("click",".js-geosel_pagenav_link",function(e){e.preventDefault(),e.stopPropagation(),$(this).parents(".js-geosel_pagenav").find(".js-geosel_pagenav_cnt").html(t()),n.search_offset=c*($(this).data("p")-1),n.usearch.refreshSearch()}).itemsSelector({selector:".js-geosel_item:visible",activeClass:"s-city__item_hovered",keydownArea:n.input,external:!0}),n.opts.render==p&&n.input.on("blur",function(){var t=Spaces.DdMenu.currentId();tick(function(){if(document.activeElement){var e=$(document.activeElement);if(e.parents("#city_fw__form"+n.opts.uniq).length||!e.parents("body").length)return;Spaces.DdMenu.close(t)}})}),i=n.input.val().length<1,n.usearch=e.find(".js-usearch_parent").usearch({length:1,allowEmpty:!0,enter:!0,skipDefault:!0,onInput:function(e){var t=e.value.length<1;i!=t&&(n.opts.render==y?(n.empty.toggle(n.allowEmpty()&&t),n.offers.toggle(t),n.current.toggle(t),n.result.toggle(!t)):t&&(n.allowEmpty()&&n.empty.show(),n.offers.show(),n.current.show(),n.result.hide()),t&&n.result.html(""),Spaces.DdMenu.fixSize(),i=t)},doSearch:function(e){n.stop_search?e.onSuccess():(e.refresh||(n.search_offset=0),n.search(e.query,e.onSuccess))}}),e.on("dd_menu_open",function(){n.stop_search=!1,n.allowEmpty()||n.empty.hide(),n.original_value=n.input.val(),n.opts.render==p&&(n.skip_search=!0,n.inputWrap.addClass("search__results-show")),$(".js-geo_sel_warn").hide()}).on("dd_menu_closed",function(){n.stop_search=!0,n.allowEmpty()&&n.empty.show(),n.offers.show(),n.current.show(),n.result.hide().html(""),n.original_value&&n.input.val(n.original_value).trigger("input"),n.opts.render==p&&n.inputWrap.removeClass("search__results-show"),$(".js-geo_sel_warn").show()}).on("clearSearchForm",function(){n.opts.render==p&&n.reset()}),n.isEmpty()||n.wrap.data("manual",!0),$("#city_fw__form"+n.opts.uniq).data("disabled",!1)},select:function(e,t){var i,n,a,s,o,r,c,l=this;if("city"==e.type&&l.opts.city==d&&(e=$.extend({},e,{type:"country",id:e.country_id,name:e.country_name})),e.type in l.opts&&l.opts[e.type]==d)l.reset();else{for(l.stop_search=!0,i=e.name,n="ico_place",l.empty.removeClass("clicked"),l.opts.render==y&&l.input.val("").trigger("input"),a=[+l.country_id.val(),+l.city_id.val(),+l.region_id.val()],"empty"==e.type?(l.opts.region!=d&&l.opts.country!=d||l.country_id.val(0),l.city_id.val(0),l.region_id.val(0),l.opts.render==p&&l.input.val("").trigger("input"),l.empty.addClass("clicked"),l.current.find("[data-id]").removeClass("clicked"),n=l.opts.geoFilter?"ico_ac_all_grey":"ico_place"):"country"==e.type?(l.country_id.val(e.id),l.city_id.val(0),l.region_id.val(0),l.current.html(h({id:e.id,name:e.name,selected:1})),l.opts.render==p&&l.input.val(i).trigger("input")):"city"==e.type?(l.country_id.val(e.country_id),l.city_id.val(e.id),l.region_id.val(0),l.current.html(g({id:e.id,name:e.name,country_id:e.country_id,country_name:e.country_name,selected:1})),i=e.country_name?e.name+", "+e.country_name:e.name,l.opts.render==p&&l.input.val(i).trigger("input")):"region"==e.type&&(l.country_id.val(e.country_id),l.city_id.val(0),l.region_id.val(e.id),l.current.html(m({id:e.id,name:e.name,country_id:e.country_id,country_name:e.country_name,selected:1})),i=e.country_name?e.name+", "+e.country_name:e.name,l.opts.render==p&&l.input.val(i).trigger("input")),l.label.find(".js-ico").removeClass("ico_place ico_ac_all_grey").addClass(n),l.label.find(".js-btn_val").text(i),s=l.current.find("[data-id]"),l.offers.children().each(function(){var e=$(this);e.toggle(!(e.data("id")==s.data("id")&&e.data("country_id")==s.data("country_id")))}),l.original_value=!1,t&&(Spaces.DdMenu.close(),l.input.blur(),l.wrap.data("manual",!0)),o=[+l.country_id.val(),+l.city_id.val(),+l.region_id.val()],r={selector:l,id:l.opts.uniq,city:+l.city_id.val(),region:+l.region_id.val(),country:+l.country_id.val(),manual:!!l.wrap.data("manual"),type:e.type,raw:e,valid:!0,changed:!1},c=0;c<a.length;++c)o[c]!=a[c]&&(r.changed=!0);l.opts.city!=_||r.city||(r.valid=!1),l.opts.country!=_&&l.opts.country!=u||r.country||(r.valid=!1),l.opts.region!=_||r.region||(r.valid=!1),l.wrap.trigger("geoSelected",r)}},search:function(e,a){var t,s=this,i=e.split(", ")[0],n={O:s.search_offset,L:c,q:i};s.opts.weather&&(n.W=1),s.opts.region!=d?(t="neoapi/services.searchRegion",n.=s.country_id.val()):s.opts.city==d?t="neoapi/services.searchCountry":s.opts.city==r?(t="neoapi/services.searchCity",s.opts.country!=u&&(n.M=1)):t="neoapi/services.searchCity",i.length<1?a():(Spaces.cancelApi(o),o=Spaces.api(t,n,function(e){var t,i,n;if(a(),0==e.code)if(s.opts.render==p&&(s.empty.hide(),s.offers.hide(),s.current.hide(),s.result.show()),"count"in e||!e.regions||(e.count=e.regions.length),e.count){if(t="",e.countries)for(i=0;i<e.countries.length;++i)t+=h(e.countries[i]);if(e.regions)for(i=0;i<e.regions.length;++i)t+=m(e.regions[i]);if(e.cities)for(i=0;i<e.cities.length;++i)t+=g(e.cities[i]);e.count>c&&(s.opts.city!=d||s.opts.region!=d)&&(t+=f({page:s.search_offset/c+1,total:Math.ceil(e.count/c)})),s.result.html(t)}else n=s.opts.region!=d?L("      .   ."):s.opts.city==r?L("      . ,        ."):s.opts.city==d?L("      .   ."):L("      . ,  ."),s.result.html(l(n));Spaces.DdMenu.fixSize()},{onError:function(){a()}}))},reset:function(){this.empty.click()},isEmpty:function(){return this.empty.hasClass("clicked")},isManual:function(){return!!this.wrap.data("manual")},value:function(){return{city:+this.city_id.val(),region:+this.region_id.val(),country:+this.country_id.val()}},allowEmpty:function(){var e=this;return e.isEmpty()||e.opts.render==p||e.opts.country!=_&&e.opts.city!=_&&e.opts.region!=_}});$.fn.geoSelector=function(){var e=this.data();if(this.length)return e.geosel||(e.geosel=new i(this)),e.geosel},define("geo_selector","onRequire",function(){e||(e=tick(function(){e=!1,$(function(){$(".js-geosel").each(function(){$(this).geoSelector()})})}))})});define("city_redirect","onRequest",function(){$(function(){$("#main").on("geoSelected",function(e,r){var t,n,i=$("#city_redirect");i.length&&r.valid&&(t=new Url(i.data("url")),(n=i.data()).cityKey&&(t.query[n.cityKey]=r.city),n.regionKey&&(t.query[n.regionKey]=r.region),n.countryKey&&(t.query[n.countryKey]=r.country),Spaces.redirect(t.url()))})})});define("video_slides","init",function(){function a(){if(!g&&j)try{g=new window.IntersectionObserver(t,{root:null,rootMargin:"0px",threshold:0})}catch(e){}}function s(){!g&&p.length&&(n(),_||(window.addEventListener?(window.addEventListener("scroll",i,!1),window.addEventListener("resize",i,!1)):window.attachEvent&&(window.attachEvent("onscroll",i),window.attachEvent("onresize",i)),_=!0))}function d(){var e,t,n,i,o,r=Date.now();if(a(),"operamini"!=Device.browser)for(t=0,n=(e=$(".js-vslides")).length;t<n;++t){if(10<=Date.now()-r)return void tick(d);!function(e){var t=e.parentNode;e.className=e.className.replace(/js-vslides/,""),t.onmouseover=function(){c($(e))},t.onmouseleave=function(){l()}}(e[t])}for(t=0,n=(i=$(".js-img_defer")).length;t<n;++t){if(10<=Date.now()-r)return void tick(d);(o=i[t]).className=o.className.replace(/js-img_defer/,""),g?g.observe(o):y?p.push({image:o,rect:o.getBoundingClientRect()}):o.src=o.getAttribute("data-src")}s(),m=!1}function t(e){var t,n,i,o;for(t=0,n=e.length;t<n;++t)if(0<(i=e[t]).intersectionRatio&&("IMG"==i.target.tagName?i.target.src=i.target.getAttribute("data-src"):(o=$(i.target)).fastHtml(o.data("html")),g.unobserve))try{g.unobserve(i.target)}catch(r){}}function c(t){o&&o[0]==t[0]||(l(),t.data("orig_src")||(t.data("orig_src",t.prop("src")),t.data("slider_id",w++)),f=t.data("last_slide")||0,function(i,e){var o,t,n,r,a=i.data("slides"),s=i.data("slider_id"),d=i.data("state"),c=i.parent().find(".js-video_spinner");if(d==E)return e&&e();if(h[s]=e,!d){for(t=function(){var e,t,n=this;if(n.onload){if(n.onerror=n.onload=null,!n.width){for(e=[],t=0;t<a.length;++t)a[t]!=n.src&&e.push(n.src);a=e,i.data("slides",a)}++o>=a.length&&(i.data("state",E),h[s]&&h[s](),h[s]=null)}},n=o=0;n<a.length;++n)(r=new Image).src=a[n],r.onerror=r.onload=t;i.data("state",b)}c.length||i.after(I.spinner())}(o=t,function(){t.data("orig_style",t.attr("style")).css({width:t.width()+"px",height:t.height()+"px"}),t.parent().find(".js-video_spinner").remove();var e=function(){var e=t.data("slides");t.prop("src",e[f]).data("last_slide",f),++f>=e.length&&(f=0)};e(),r=setInterval(e,800)}))}function l(){o&&(h[o.data("slider_id")]=null,o.parent().find(".js-video_spinner").remove(),o.prop("src",o.data("orig_src")).attr("style",o.data("orig_style")),r&&clearInterval(r),o=r=null)}function e(){var e,t,n,i,o,r,a,s,d;for(v=!1,e=window.pageYOffset||(document.documentElement||document.body||{}).scrollTop,t=Math.max(window.innerHeight,(document.documentElement||{}).clientHeight||0),n=[],i=0,o=p.length;i<o;++i)a=(r=p[i]).rect.top,s=r.rect.bottom,e<=a&&a<=e+t||e<=s&&s<=e+t?"IMG"==r.image.tagName?r.image.src=r.image.getAttribute("data-src"):(d=$(r.image)).fastHtml(d.data("html")):n.push(r);(p=n).length||u()}function i(){n()}function n(){v||(v=setTimeout(e,50))}function u(){if(_&&(window.removeEventListener?(window.removeEventListener("scroll",i),window.removeEventListener("resize",i)):window.attachEvent&&(window.detachEvent("onscroll",i),window.detachEvent("onresize",i)),_=!1),g){if(g.unobserve)for(var e=0,t=p.length;e<t;++e)try{g.unobserve(p[e].image)}catch(n){}if(g.disconnect)try{g.disconnect()}catch(n){}g=null}p=[]}var o,r,f,v,g,m=!1,h={},w=0,p=[],_=!1,b=1,E=2,y="operamini"!=Device.browser&&"function"==typeof document.body.getBoundingClientRect,j="operamini"!=Device.browser&&window.IntersectionObserver&&!cookie.get("__s_no_iobs"),I={spinner:function(){return'<div class="tiled_item-spinner js-video_spinner"></div>'}};Spaces.offscreen=function(e,t){var n=$(e);0<page_loader.getRequestId()?n.fastHtml(t):(a(),g?(n.data("html",t),g.observe(n[0])):y?(n.data("html",t),p.push({image:n[0],rect:n[0].getBoundingClientRect()})):n.fastHtml(t),s())},define("video_slides","onRequire",function(){m||($(function(){tick(d)}),m=!0)}),define("video_slides","onRequest",function(){page_loader.push("shutdown",function(){l(),h={},u()})})});

Loader._(["jquery","jquery_utils","pushstream","sound","spaces.pushstream","cookie","proj/config","android/api","spacesLib","clock","ajaxify","notifications","tools","device","comments_deffered","online_status","sidebar","checkall","likes","files_monitor","min_height","dd_menu","gallery","anim","draggable","video_player","footer","form_toolbar","colorpicker","smiles_data","lite/smiles_menu","widgets/attach_selector","form_tools","form_controls","search_form","search_suggests","toggle_content","load_full","view_tracker","geo_selector","city_redirect","video_slides"]);
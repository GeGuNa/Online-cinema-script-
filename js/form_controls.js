define("form","init",function(){$(function(){var g,u=$("body");u.on("focus blur",".js-input_with_suffix",function(e){$(this).parent().find(".js-input_suffix").toggleClass("hide","focus"==e.type||"focusin"==e.type)}).on("focus blur",".text-input-wrapper_inline",function(e){e.target&&("INPUT"==e.target.nodeName&&"submit"==e.target.type||"BUTTON"==e.target.nodeName)||$(this).toggleClass("focus","focus"==e.type||"focusin"==e.type)}).on("click",".js-checkbox",function(e){var t,a,o,n;$(e.target).parents("a").length||(e.preventDefault(),e.stopPropagation(),a=(t=$(this)).find("input[type=checkbox]").get(0),$(a).attr("disabled")||(o=$.Event("change"),$(a).trigger(o),o.isDefaultPrevented()||(a.checked=!t.hasClass("form-checkbox_checked"),t.toggleClass("form-checkbox_checked"),t.data("chb_group")&&(n=a.checked,$("#"+t.data("chb_group")).find(".js-checkbox").each(function(){var e=$(this);e.find("input[type=checkbox]").get(0);e.toggleClass("form-checkbox_checked",n)})),$(a).trigger($.Event("changed")))))}),"operamini"!=Device.browser&&u.on("change",".js-select",function(){var e=$(this),t=e.find("option:selected"),a=t.text(),o=e.parent();t.hasClass("select_default")?(o.addClass("select_custom_noactive"),a=e.data("default")):o.removeClass("select_custom_noactive"),e.parent().find(".select__label").html(a),Spaces.view.setInputError(e,!1)}),u.on("click",".js-radio",function(e){var t,a,o,n,s,i,c,r,l,d,f;"operamini"!=Device.browser&&e.preventDefault(),e.stopPropagation(),o=(a=(t=$(this)).find("input[type=radio]")).attr("name"),n=t.data("label_id"),s=t.data("noclose"),i=t.data("change_ico"),c=t.data("checked_class")||"form-checkbox_checked",a.get(0).checked=!0,a.trigger("change"),$(".js-radio-"+o).each(function(){var e=$(this);e.removeClass(e.data("checked_class")||"form-checkbox_checked")}),t.addClass(c),i&&(r=t.find("span.ico").data("current_ico"),$("#"+i).get(0).className="ico "+r),n&&1!=s&&(d=(l=$("#label_"+o)).find(".js-ico"),(f=l.find(".js-text")).length||d.length?(f.html(t.find(".js-text").html()),d.prop("className",t.find(".js-ico").prop("className")),console.log("label_ico",d)):$("#"+n+" .drop-down-label_text").text(t.text()),u.trigger("click"))}),u.on("click",".js-toggle",function(e){e.preventDefault(),e.stopPropagation();var t=$(this),a=t.data("mess_id"),o=t.parents(".label-toggle");o.data("disabled")||(t.hasClass("form-toggle__wrap_off")?(t.find("label.form-toggle-1 input").get(0).checked=!0,o.addClass("label-toggle_on"),a&&$("#"+a).hide()):(t.find("label.form-toggle-0 input").get(0).checked=!0,o.removeClass("label-toggle_on"),a&&$("#"+a).show()),t.toggleClass("form-toggle__wrap_off"))}),u.on("click",".js-horiz_mode",function(e){e.preventDefault(),e.stopPropagation();var t=$(this),a=t.find("input[type=radio]"),o=a.attr("name");a.trigger("change"),a.get(0).checked=!0,t.parents(".js-input_error_wrap").removeClass("error__item").find(".js-input_error").addClass("hide"),$(".js-horiz_mode-"+o).removeClass("clicked"),t.addClass("clicked")}),g={dating:{method:"neoapi/anketa.datingEdit",data:{CK:null},param:"Dating",onResult:function(e,t){e.premod&&e.code==Codes.COMMON.ERR_UNKNOWN_ERROR&&(e.code=0)}},ghost:{method:"neoapi/services.switchGhost",data:{CK:null},param:"On",updateState:function(e){var t=$(".js-switcher_ghost");t.toggleClass("on",!e).html(e?t.data("value_off"):t.data("value_on")),Spaces.DdMenu.close()},onResult:function(e,t){e.code==Codes.SERVICES.ERR_GHOST_UNCHANGED&&(e.code=0)}}},u.on("click",".js-switcher",function(e){var o,t,a,n,s,i,c,r,l,d,f,u,h,p;e.preventDefault(),e.stopPropagation(),o=$(this),t=o.find(".form-toggle__wrap"),a=o.data(),n=$("#"+a.spinner),s="state"in a?!a.state:!o.hasClass("light"==a.mode?"on":"label-toggle_on"),i=!s,a.disabled||a.busy||(c={},$.each(a,function(e,t){0==e.indexOf("msg_")&&(c[e.replace(/^msg_/,"")]=$("#"+t))}),l=function(e){"light"!=a.mode&&r(!!e&&"failed",e)},d={showMessage:r=function(e,t){$.each(c,function(){this.hide()}),c[e]||(e=s?"enabled":"disabled");var a=c[e];a&&(t&&a.html(t),a.show()),o.toggleClass("js-has_mess",!(!a||!a.length))},showError:l},a.type?f=g[a.type]:a.apiMethod&&(f={method:a.apiMethod,data:a.apiData,param:a.param}),u=function(e){s=e,a.state=e,a["class"]?(o.find(".js-switcher_on").toggleClass("hide",!s),o.find(".js-switcher_off").toggleClass("hide",s)):"light"==a.mode?(o.html(s?a.value_on:a.value_off),o.toggleClass("on",!!s)):(o.toggleClass("label-toggle_on",s),t.toggleClass("form-toggle__wrap_off",!s),l(!1)),f&&f.updateState&&f.updateState.call(d,e)},f?((h=$.extend({},f.data))[f.param]=f.invert?!s:!!s,p=function(e){a.busy=e,n.toggleClass("hide",!e)},u(s),p(!0),Spaces.api(f.method,h,function(e){p(!1),f.onResult&&f.onResult.call(d,e,!!s),0!=e.code?(u(i),c.failed?l(Spaces.apiError(e)):Spaces.showApiError(e)):f.callback&&f.callback()},{onError:function(e){p(!1),l(e),n.addClass("hide")}})):u(s))}).on("click",".js-addremove",function(e){var t=$(this),a=t.find("input:first")[0],o=!t.hasClass("form-checkbox_checked"),n=new $.Event("addremove");t.trigger(n,{state:o,name:a.name,value:a.value}),n.isDefaultPrevented()&&(e.preventDefault(),e.stopPropagation(),t.toggleClass("form-checkbox_checked",o),t.data("checked",o))}),u.on("change",".js-years_selector",function(e){var t,a,o=$(this),n=4,s=1,i=3,c=2,r="",l="";o.hasClass("js-year_from")?(r=o.val(),l=o.parent().find(".js-year_to").val()):(r=o.parent().find(".js-year_from").val(),l=o.val()),r&&l&&0<l&&0<r&&l<r&&(a="",(t=o.data("type"))==n?a=L("Год окончания работы не может быть меньше года начала"):t==s?a=L("Год окончания обучения не может быть меньше года начала"):t==i?a=L("Год окончания службы не может быть меньше года начала"):t==c&&(a=L("Год окончания обучения не может быть меньше года начала")),Spaces.showError(a))}),u.on("click",".js-submit-btn",function(e){var t=$(this);t.find(".ico").get(0).className="ico f__ico_spinner2";t.addClass("clicked")}).on("click",".js-reset_value",function(e){e.preventDefault(),e.stopPropagation(),$(this).visible(!1);var t=$(this).parents(".js-parent");window.Spaces.resetForm(t)}),"operamini"!=Device.browser&&u.on("focus",".js-text-input",function(e){$(this).parent().addClass("input_focused")}).on("blur",".js-text-input",function(e){$(this).parent().removeClass("input_focused")})}),define("form","onRequest",function(){var c,a,o=!1;$(".ac-settings_inline_bottom_fix").each(function(){var e=$(this);e.removeClass("ac-settings_inline_bottom_fix"),e.find(".text-input__wrap").append(e.find(".drop-down-list_inner"))}),c=function(e){var t,a,o=e.find(".js-radio"),n={};for(t=0;t<o.length;++t)n[a=o[t].getAttribute("data-label_id")]||(n[a]=[]),n[a].push(o[t]);return n},window.Spaces.resetForm=function(e){var t,a;for(a in e.find('select, input[type="text"]').val("").trigger("resetValues"),e.find(".js-objsel").each(function(){$(this).objectSelector().reset()}),e.find(".js-geosel").each(function(){$(this).geoSelector().reset()}),t=c(e))$(t[a][0]).click()},a=function(e,t){var a,o,n,s,i=c(e);for(a in i)if(!$(i[a][0]).hasClass("form-checkbox_checked"))return!0;if(!t&&(o=!1,e.find(".js-geosel").each(function(){var e=$(this).geoSelector();if(o=!e.isEmpty())return!1}),o))return!0;for(n=e.find('input[type="text"]'),s=0;s<n.length;++s)if(n[s].className.indexOf("js-geosel_input")<0&&""!==n[s].value)return!0;return!1},$(function(){"operamini"!=Device.browser&&$("#main").on("mousedown touchstart",function(){o=!0}).on("mouseup touchcancel touchend",function(){o=!1}).on("focus",".text-input",function(e){$(this).parents(".form__item").find(".js-acl").hide()}).on("blur",".text-input",function(e){var t=$(this),a=function(){t.parents(".form__item").find(".js-acl").show()};o?$("body").one("mouseup touchcancel touchend",a):setTimeout(a,"touch"==Device.type?250:0)}).on("focus blur change",".js-parent select, .js-parent input, .js-parent textarea",function(e){var t=$(this).parents(".js-parent");setTimeout(function(){var e=t.find(".js-reset_value");e.toggle(a(t,e.data("ignore_city")))},0)}).on("valuechanged",".js-parent",function(e){var t=$(this);setTimeout(function(){var e=t.find(".js-reset_value");e.toggle(a(t,e.data("ignore_city")))},0)})})})});
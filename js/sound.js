define("sound","init",function(){function i(e){if(e){var n=e.match(/[\d]+/g);return+(n[0]+"."+n[1])}return 0}function A(){var e,n=0;if(navigator.plugins&&navigator.plugins.length)n=i((e=navigator.plugins["Shockwave Flash"])&&e.description);else if(navigator.mimeTypes&&navigator.mimeTypes.length)n=i((e=navigator.mimeTypes["application/x-shockwave-flash"])&&e.enabledPlugin&&e.enabledPlugin.description);else try{n=i(new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version"))}catch(t){}return 9<=n}function P(t,e,i){if(t.addEventListener)return each(e,function(e,n){i?t.addEventListener(n,e,!1):t.removeEventListener(n,e)}),i?function(){P(t,e,!1)}:void 0}var _,D,E={},x=0,F=0,O=0,e=navigator.userAgent,I=/(ipad|iphone|ipod)/i.test(e),R=/android\s2\.3/i.test(e),n=e.match(/safari/i)&&!e.match(/chrome/i),U=!n&&!e.match(/silk/i)&&e.match(/OS X 10_6_([3-7])/i),t=function(t){function i(){return!y||D==p}function e(){var t,i,e;if(d(),++O,p||m||(y=h),c){if(!p&&y&&(_=c,D=p),i=function(e){w?(x=0,s.duration!=c.duration&&(e||.3<c.duration)&&(s.duration=c.duration,u("durationChange")),s.currentTime!=c.currentTime&&(s.currentTime=c.currentTime,u("timeUpdate"))):c.duration&&"firefox"==Device.browser&&"desktop"!=Device.type&&t()},P(c,l={play:function(){w&&(s.playing=!0,u("play"))},pause:function(){w&&(s.playing=!1,u("pause"))},canplay:t=function(e){if(!w){n(!1);try{c.currentTime=s.currentTime||(m?0:.01)}catch(e){}c.volume=k/100,c.muted=!1,m&&c.flashSync(),a(s.playing)}},canplaythrough:t,loadeddata:i,loadedmetadata:i,durationchange:i,timeupdate:i,progress:function(e){if(i(),e.loaded&&e.total&&e.loaded==e.total&&t(),0<c.buffered.length){var n=c.buffered.end(c.buffered.length-1);s.duration=c.duration,s.buffered=n/c.duration,u("buffer",{pct:s.buffered})}},ended:function(){i(!0),w&&(s.ended=!0,u("ended"))},error:function(e){var n,t,i;if(w&&Math.abs(s.duration-s.currentTime)<1&&0<s.duration)return s.ended=!0,void u("ended");t=["",n=L("Ошибка загрузки"),n,L("Ошибка декодирования"),"Invalid source"],i=e&&e.target&&c.error?"#"+c.error.code+":"+(t[c.error.code]||n):m&&e||n,T||(T=!0,console.error("AUDIO ERROR ["+x+"]: "+i+" "+c.src),x<=4?(w=!1,setTimeout(function(){var e=s.playing;s.load(f),a(e)},500*x),++x):u("error",i))}},!0),m?P(c,{flashInit:function(){u("ready")}},!0):u("ready"),b=!0,g.length)for(e=0;e<g.length;++e)s.ready(g[e])}else u("unsupported")}function a(e){if(e&&function(){if(y&&D!=p){var e=s.currentTime,n=E[D];n&&n._unbind(),D=p,P(c,l,!0),r(f),s.setPosition(e)}}(),w){if(c.paused==e)try{e?c.play():c.pause()}catch(n){console.error(n)}}else S||o(),s.playing!=!!e&&u(e?"play":"pause");s.playing=!!e}function r(e){return f=e,n(!(S=T=!1)),c.src=e,c.autobuffer="auto",c.preload="auto",t.autoLoad&&o(),s}function o(){c.load(),S=!0,u("loadStart")}function u(e,n){e="on"+e.substr(0,1).toUpperCase()+e.substr(1);try{t[e]&&t[e].call(s,n)}catch(n){console.error(n)}}function n(e){e||w||u("loadEnd"),(w=!e)||d()}function d(){s.ended=s.playing=!1,s.buffered=s.duration=s.currentTime=0}var c,f,l,s=this,p=F++,h=!("desktop"==Device.type||I||R),y=!1,m=!1,g=[],v=!1,b=!1,T=!1,w=!1,S=!1,k=100;E[p]=s,extend(s,{load:function(e){return i()?r(e):f=e,s},isSingle:function(){return y},play:function(){return a(!0),s},pause:function(){return a(!1),s},stop:function(){return s.setPosition(0),a(!1),m&&c.flashSync(),s},destroy:function(){v||(i()&&P(c,l,!1),y&&1!=O||(m?c.flashDestory():(c.muted=!0,c.pause(),c.src="about:blank"),delete E[p],_=D=undefined),c=t=l=null,--O,v=!0)},setVolume:function(e){k=e,i()&&(c.volume=k/100,m&&c.flashSync())},setPosition:function(e){try{i()&&(c.currentTime=e,m&&c.flashSync()),s.currentTime=e}catch(n){}},_unbind:function(){P(c,l,!1),s.playing&&u("pause"),a(!1),u("buffer",{pct:s.buffered=0}),w=!1},ready:function(e){b?e&&e.call(s,s):g.push(e)}}),t=extend({autoLoad:!1},t),!(c=_||function(){var e;if(U&&!A()||!document.cookie.match(/audio_force_flash=1/)||!A()){try{e=window.Audio?new Audio:ce("audio")}catch(n){e=window.Audio?new Audio(null):ce("audio")}e&&e.canPlayType&&e.canPlayType("audio/mpeg").replace(/no/,"")||(e=!1)}return e}())&&A()?require("sound_flash",function(){c=new FlashAudio({autoLoad:t.autoLoad}),m=!0,e()}):e()};window.SpacesSound=t});
define("debugger","init",function(){function _init(){var html,method="",data="{ }";window.localStorage&&(method=window.localStorage.api_debug_method||"",data=window.localStorage.api_debug_data||"{ }"),html='<div><form action="#" method="POST" id="api_debug"><input type="text" value="'+html_wrap(method)+'" placeholder="Метод" name="method" style="width: 90%" /><input type="submit" value="OK" name="ok" /><br /><input type="text" value="" placeholder="urlencoded query" name="query" style="width: 90%" /><input type="submit" value="JSON" name="JSON" data-json="1" /><br /><div><textarea id="api_debug-js_data">'+html_wrap(data)+'</textarea></div></form><div id="api_debug-result_info"></div><code id="api_debug-result"></code></div>',method=text=null,$("#api_debug-place").html(html).on("click","[data-editor]",function(e){e.preventDefault()}).on("submit","#api_debug",function(e){var el,value,result,result_info,start_time;if(e.preventDefault(),el=this,el.submit_btn&&el.submit_btn.getAttribute("data-json"))return editor.doc.setValue(JSON.stringify(Url.parseQuery(el.query.value),null,"\t")),void(window.localStorage&&(window.localStorage.api_debug_method=el.method.value,window.localStorage.api_debug_data=editor.doc.getValue()));result=ge("#api_debug-result"),result_info=ge("#api_debug-result_info"),window.localStorage&&(window.localStorage.api_debug_method=el.method.value,window.localStorage.api_debug_data=editor.doc.getValue());try{value=eval("("+editor.doc.getValue()+")")}catch(e){return result_info.style.backgroundColor="pink",void(result_info.innerHTML="Ошибка разбора JSON:<pre>"+html_wrap(""+e)+"</pre>")}value&&null===value.CK&&(value.CK=Spaces.CK()),el.query.value=Url.buildQuery(value,"&",""),result_info.style.backgroundColor="",result.className="",result.innerHTML="",result_info.innerHTML="Выполняется запрос...",start_time=Date.now(),Spaces.api(el.method.value,value,function(e){var t,a=Date.now()-start_time;hljs.configure({useBR:!1}),(t=ge("#api_debug-result")).innerHTML=html_wrap(JSON.stringify(e,null,"\t")).replace(/\n/g,"<br />"),t.className="code_tag lang-js",hljs.highlightBlock(ge("#api_debug-result")),result_info.style.backgroundColor=0==e.code?"lightGreen":"pink",result_info.innerHTML="<b>Код:</b> "+e.$code+" (время: "+a+"ms)<br /><b>Ошибка:</b> "+html_wrap(Spaces.services.processingCodes(e))+"<br />"},{onError:function(e){var t=Date.now()-start_time;result_info.style.backgroundColor="pink",result_info.innerHTML=(e||"Ошибка запроса")+" (время: "+t+"ms)"},disableChecks:!0})}),editor=CodeMirror.fromTextArea(ge("#api_debug-js_data"),{lineNumbers:!0,mode:"text/javascript"}),editor.setSize(null,"10em")}var editor;$(function(){$("#api_debug-button").click(function(e){var t=$("#warninings_link, #stat_link, #functions_stat, #check_point_stat"),a=$(this),i=$("#api_debug-place");e.preventDefault(),a.prop("opened")?(a.prop("opened",!1),t.show(),i.hide()):(a.prop("opened",!0),t.hide(),i.show(),editor?editor.refresh():_init())})})});
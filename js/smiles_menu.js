define("smiles_menu","init",function(){function r(){addClass(d,"hide"),d.innerHTML="",u&&u(),u=o=d=null}function s(s){var e,i,a,l,t,n=this.href.split("#");if(!(n.length<2)){if(s&&s.preventDefault&&s.preventDefault(),i=(e=n[1].split("="))[0],a=e[1],l=ge(".smiles_menu-body",d)[0],"sm-cat"==i)l.innerHTML=g.smileCat(a,"smiles");else if("sm-tab"==i)l.innerHTML=+a?g.smileCat(a,"stickers"):g.smilesCat();else{if("sm-exit"==i)return void r();"smiles"!=i&&"stickers"!=i||(a=a.split("-"),t=SpacesSmiles.list["smiles"==i?0:1][a[0]][a[1]].split("|"),o(c(t).name),tick(r))}return m(),!1}}function m(){!function(s,e){for(var i=0;i<s.length;++i)s[i].onclick=e}(d.getElementsByTagName("a"),s)}function c(s){var e,i=s[0];return i=0<=i.indexOf("@")?i.substr(1):":"+i,e=1==s.length?":"==i.charAt(0)?i.substr(1):i:s[1],{name:i,src:e}}var d,f,o,u,g={menu:function(s){var e,i,a=SpacesSmiles.st_categories,l="",t='<a href="#sm-exit" id="sm_exit_'+s+'"><span class="ico ico_remove close"></span></a>';if(1<a.length){for(l+='<div class="smiles_menu-header">',e=0;e<a.length;++e)l+='<a href="#sm-tab='+e+'" title="'+((i=a[e])[0]||L("Смайлы"))+'"><img src="'+ICONS_BASEURL+i[1]+'" alt="" /></a>';l+=t+"</div>"}else l+=t;return l+='<div class="smiles_menu-body">'+g.smilesCat()+"</div>"},smilesCat:function(){var s,e,i=SpacesSmiles.categories,a="";for(a+='<div class="smiles_menu-categories lh_160">',s=0;s<i.length;++s)a+='<a href="#sm-cat='+s+'">'+(e=i[s])[0]+' <img src="'+ICONS_BASEURL+e[1]+'" alt="" class="middle" /></a>';return a+="</div>"},smileCat:function(s,e){var i,a,l,t,n="";if("stickers"==e){for(--s,i=SpacesSmiles.list[1][s],n+='<div class="stickers_list t_center">',(a=f[s])&&(n+="<div>"+L("Этот набор стикеров пока недоступен.")+'<br /> <a class="inl_bl" style="padding: 5px" href="'+a+'">'+L("Купить за 12 монет")+"</a></div>"),l=0;l<i.length;++l)t=c(i[l].split("|")),n+='<a href="#'+e+"="+s+"-"+l+'"><img src="'+ICONS_BASEURL+"st/t/"+t.src+'.gif" smile="'+t.name+'" /></a> ';a&&(n+='<div><a class="inl_bl" style="padding:5px" href="'+a+'">'+L("Подробнее &raquo;")+"</a></div>"),n+="</div>"}else{for(i=SpacesSmiles.list[0][s],n+='<div class="smiles_list">',l=0;l<i.length;++l)t=c(i[l].split("|")),n+='<a href="#'+e+"="+s+"-"+l+'"><img src="'+ICONS_BASEURL+t.src+'.gif" smile="'+t.name+'" /> </a> ';n+='</div><div class="stnd_padd smiles_menu-back"><a href="#sm-tab=0"><img src="'+ICONS_BASEURL+'ico/arrow-back.png" alt="" class="m" />&nbsp;<span class="m"> '+L("Вернуться к выбору категорий")+"</span></a></div>"}return n}};window.SmilesMenu={toggle:function(s,e,i,a,l){var t,n;(d=ge("#sm_"+s))||(d=ce("div",{id:"sm_"+s,className:"smiles_menu hide"}),e.appendChild(d)),t=hasClass(d,"hide"),i&&t?((n=ge("#toolbar_payload"))&&(f=light_json(n.getAttribute("data-stickers")||"[]")),o=i,u=l,removeClass(d,"hide"),d.innerHTML=g.menu(s),m(),a&&a()):(r(),o=d=null)}}});